<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to Modern Fortran: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/cp/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicons/cp/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicons/cp/favicon-16x16.png">
<link rel="manifest" href="../favicons/cp/site.webmanifest">
<link rel="mask-icon" href="../favicons/cp/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav carpentries"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="cp-logo" alt="Lesson Description" src="../assets/images/carpentries-logo.svg">
</div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>


      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav carpentries" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="../assets/images/carpentries-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduction to Modern Fortran
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduction to Modern Fortran
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to Modern Fortran
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress carpentries">
    <div class="progress-bar carpentries" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-connecting.html">1. Connecting to ARCHER2 and transferring data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-hello-world.html">2. Hello World</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="011-break.html">3. Break</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="02-variables.html">4. Variables</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="03-if-statements.html">5. Logical and conditionals, character variables</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="031-lunch.html">6. Lunch</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="04-do-statements.html">7. Loops and loop control</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="05-arrays.html">8. Array declarations</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="06-array-expressions.html">9. Array expressions and assignments</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="061-break.html">10. Break</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="07-exercise.html">11. Mini exercise: a choice of two</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="08-modules.html">12. Modules and compilation of modules</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="09-functions-subroutines.html">13. Functions and subroutines</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="10-dummy-array-arguments.html">14. More on array dummy arguments</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="101-break.html">15. Break</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush17">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading17">
        <a href="11-characters-strings.html">16. More on characters and strings</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush18">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading18">
        <a href="12-read-write.html">17. Formats and edit descriptors</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush19">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading19">
        <a href="121-lunch.html">18. Lunch</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush20">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading20">
        <a href="13-IO.html">19. Operations on external files</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush21">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading21">
        <a href="14-namelists.html">20. Using namelists</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush22">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading22">
        <a href="141-break.html">21. Break</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush23">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading23">
        <a href="15-exercise.html">22. Exercises</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush24">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading24">
        <a href="16-data-structures.html">23. Structures: derived types</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush25">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading25">
        <a href="17-pointers.html">24. Pointers and targets</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush26">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading26">
        <a href="18-further-functions.html">25. Procedures again: interfaces</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush27">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading27">
        <a href="181-break.html">26. Break</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush28">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading28">
        <a href="19-intrinsic-functions.html">27. Miscellaneous</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush29">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading29">
        <a href="191-lunch.html">28. Lunch</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush30">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading30">
        <a href="20-conclusions.html">29. Other things you may see</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush31">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading31">
        <a href="21-conjugate-gradient.html">30. Exercises: conjugate gradient and matrices</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush32">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading32">
        <a href="211-break.html">31. Break</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush33">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading33">
        <a href="22-exercises.html">32. Exercises</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00-connecting"><p>Content from <a href="00-connecting.html">Connecting to ARCHER2 and transferring data</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/00-connecting.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What can I expect from this course?</li>
<li>How will the course work and how will I get help?</li>
<li>How can I give feedback to improve the course?</li>
<li>How can I access ARCHER2 interactively?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how this course works, how I can get help and how I can
give feedback.</li>
<li>Understand how to connect to ARCHER2.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<hr class="half-width">
<p>Attendees of this course will get access to the ARCHER2 HPC facility.
You will have the ability to request an account and to log in to ARCHER2
before the course begins. If you are not able to log in, you can come to
this pre-session where the instructors will help make sure you can login
to ARCHER2.</p>
</section><section><h2 class="section-heading" id="connecting-using-ssh">Connecting using SSH<a class="anchor" aria-label="anchor" href="#connecting-using-ssh"></a>
</h2>
<hr class="half-width">
<p>The ARCHER2 login address is</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">login.archer2.ac.uk</span></span></code></pre>
</div>
<p>Access to ARCHER2 is via SSH using <strong>both</strong> a time-based
one time password (TOTP) and a passphrase-protected SSH key pair.</p>
</section><section><h2 class="section-heading" id="passwords-and-password-policy">Passwords and password policy<a class="anchor" aria-label="anchor" href="#passwords-and-password-policy"></a>
</h2>
<hr class="half-width">
<p>When you first get an ARCHER2 account, you will get a single-use
password from the SAFE which you will be asked to change to a password
of your choice. Your chosen password must have the required complexity
as specified in the <a href="https://www.archer2.ac.uk/about/policies/passwords_usernames.html" class="external-link">ARCHER2
Password Policy</a>.</p>
<p>The password policy has been chosen to allow users to use both
complex, shorter passwords and long, but comparatively simple passwords.
For example, passwords in the style of both <code>LA10!£lsty</code> and
<code>horsebatterystaple</code> would be supported.</p>
</section><section><h2 class="section-heading" id="ssh-keys">SSH keys<a class="anchor" aria-label="anchor" href="#ssh-keys"></a>
</h2>
<hr class="half-width">
<p>As well as password access, users are required to add the public part
of an SSH key pair to access ARCHER2. The public part of the key pair is
associated with your account using the SAFE web interface. See the
ARCHER2 User and Best Practice Guide for information on how to create
SSH key pairs and associate them with your account:</p>
<ul>
<li>[Connecting to ARCHER2][archer2-connecting].</li>
</ul></section><section><h2 class="section-heading" id="totpmfa">TOTP/MFA<a class="anchor" aria-label="anchor" href="#totpmfa"></a>
</h2>
<hr class="half-width">
<p>ARCHER2 accounts are now required to use timed one-time passwords
(TOTP), as part of a multi-factor authorisation (MFA) system.
Instructions on how to add MFA authentication to a machine account on
SAFE can be found [here][safe-machine-mfa].</p>
</section><section><h2 class="section-heading" id="data-transfer-services-scp-rsync-globus-online">Data transfer services: scp, rsync, Globus Online<a class="anchor" aria-label="anchor" href="#data-transfer-services-scp-rsync-globus-online"></a>
</h2>
<hr class="half-width">
<p>ARCHER2 supports a number of different data transfer mechanisms. The
one you choose depends on the amount and structure of the data you want
to transfer and where you want to transfer the data to. The two main
options are:</p>
<ul>
<li>
<code>scp</code>: The standard way to transfer small to medium
amounts of data off ARCHER2 to any other location.</li>
<li>
<code>rsync</code>: Used if you need to keep small to medium
datasets synchronised between two different locations</li>
</ul>
<p>More information on data transfer mechanisms can be found in the
ARCHER2 User and Best Practice Guide:</p>
<ul>
<li>[Data management and transfer][archer2-data].</li>
</ul></section><section><h2 class="section-heading" id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<hr class="half-width">
<p>For details of how to log into an ARCHER2 account, see <a href="https://docs.archer2.ac.uk/quick-start/quickstart-users/" class="external-link uri">https://docs.archer2.ac.uk/quick-start/quickstart-users/</a></p>
<p>Check out the git repository to your laptop or ARCHER2 account.</p>
<pre><code>$ git clone https://github.com/EPCCed/2025-05-19-MO-Fortran-intro.git
$ cd 2025-05-19-MO-Fortran-intro</code></pre>
<p>Within the repository, the code we will use is located in the
<code>exercises</code> directory. The default Fortran compiler on
ARCHER2 is the Cray Fortran compiler invoked using <code>ftn</code>. For
example,</p>
<pre><code>$ cd exercises/01-hello-world
$ ftn example1.f90</code></pre>
<p>should generate an executable with the default name
<code>a.out</code>. If you are working on another machine, you should
invoke the correct compiler e.g. <code>gfortran</code>.</p>
<p>Each section of the course is associated with a different directory,
each of which contains a number of example programs and exercise
templates. Answers to exercises generally re-appear as templates to
later exercises. Miscellaneous solutions to some of the larger problems
also appear in <code>solutions</code> subdirectories.</p>
<p>Not all the examples compile. Some have deliberate errors which will
be discussed as part of the course.</p>
</section><section><h2 class="section-heading" id="course-structure-and-method">Course structure and method<a class="anchor" aria-label="anchor" href="#course-structure-and-method"></a>
</h2>
<hr class="half-width">
<p>Rather than having separate lectures and practical sessions, this
course is taught following [The Carpentries methodology][c-site], where
we all work together through material learning key skills and
information throughout the course. Typically, this follows the method of
the instructor demonstrating and then the attendees doing along with the
instructor. There are some larger exercises we will start working on at
the end of day one.</p>
<p>There are many helpers available to assist you and to answer any
questions you may have as we work through the material together. You
should also feel free to ask questions of the instructor whenever you
like. The instructor will also provide many opportunities to pause and
ask questions.</p>
<!---
We will also make use of a shared collaborative document - the *etherpad*.
You will find a link to this collaborative document on the course page.
We will use it for a number of different purposes, for example,
it may be used during exercises and instructors and helpers may put useful information,
or links in the etherpad that help or expand on the material being taught.
If you have useful information to share with the class then please do add it to the etherpad.
At the end of the course, we take a copy of the information in the etherpad,
remove any personally-identifiable information,
and post this on the course archive page so you should always be able to come back and find any information you found useful.
-->
<!--
## Feedback

Feedback is integral to how we approach training both during and after the
course. In particular, we use informal and structured feedback activities during
the course to ensure we tailor the pace and content appropriately for the
attendees, and feedback after the course to help us improve our training for the
future.

If you are not comfortable with the pace/content then you can use the reaction
function of the collaborate session.

At the lunch break (and end of days for multi-day courses) we will also run a
quick feedback activity to gauge how the course is matching onto attendees
requirements. Instructors and helpers will review this feedback over lunch and
provide a summary of what we found at the start of the next session and,
potentially, how the upcoming materiel/schedule will be changed to address the
feedback.

Finally, you will be provided with the opportunity to provide feedback on the
course after it has finished. We welcome all this feedback, both good and bad,
as this information in key to allow us to continually improve the training we
offer.
-->
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>We should all understand and follow the <a href="https://www.archer2.ac.uk/about/policies/code-of-conduct.html" class="external-link">ARCHER2
Code of Conduct</a> to ensure this course is conducted in the best
teaching environment.</li>
<li>ARCHER2’s login address is <code>login.archer2.ac.uk</code>.</li>
<li>You have to change the default text password the first time you log
in</li>
<li>MFA is mandatory in ARCHER2</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-01-hello-world"><p>Content from <a href="01-hello-world.html">Hello World</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/01-hello-world.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the structure of a Fortran program?</li>
<li>How do I print output from the program to the terminal?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Write, compile and run a simple Fortran program.</li>
<li>Understand how to use the <code>print</code> and <code>write</code>
statements.`</li>
<li>Load the <code>iso_fortran_env</code> module with a <code>use</code>
statement.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="first-example">First example<a class="anchor" aria-label="anchor" href="#first-example"></a>
</h2>
<hr class="half-width">
<p>A very simple program might be:</p>
<pre><code>program example1

  ! An example program prints "Hello World" to the screen

  print * , "Hello World"

end program example1</code></pre>
<p>Formally, a Fortran program consists of one or more lines made up of
Fortran <em>statements</em>. Line breaks are significant (e.g., there
are no semi-colons <code>;</code> required here).</p>
<p>Comments are introduced with an exclamation mark <code>!</code>, and
may trail other statements.</p>
<p>The <code>program</code> statement is roughly doing the equivalent
job of <code>main()</code> in C/C++. However, note there is not (and
must not be) a return statement.</p>
<div class="section level3">
<h3 id="exercise-1-minute">Exercise (1 minute)<a class="anchor" aria-label="anchor" href="#exercise-1-minute"></a>
</h3>
<div id="compile-your-first-program" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="compile-your-first-program" class="callout-inner">
<h3 class="callout-title">Compile your first program</h3>
<div class="callout-content">
<p>Check now you can compile and run the first example program <a href="../files/exercises/01-hello-world/example1.f90">example1.f90</a>.
What output do you get when you run it?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Compile and run the program on ARCHER2 as follows:</p>
<pre class="source"><code>ftn example1.f90
./a.out</code></pre>
<p>which will give the following output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> Hello world</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="formal-description">Formal description<a class="anchor" aria-label="anchor" href="#formal-description"></a>
</h3>
<pre><code>  [ program [program-name] ]
     [ specification-part ]
     [ executable-part ]
  [ contains
     internal-subprogram-part ]
  end [program-name]</code></pre>
<p>Optional components are represented with square brackets
<code>[...]</code>. It follows that the shortest standard-conforming
program will be (see <a href="../files/exercises/01-hello-world/example2.f90">example2.f90</a>):</p>
<pre><code><span><span class="va">end</span></span></code></pre>
<p>If the <code>program-name</code> is present, it must be at both the
beginning and the end, and must be the same in both places.</p>
<p>We will return to the <code>contains</code> statement in the context
of modules.</p>
</div>
</section><section><h2 class="section-heading" id="print-statement">
<code>print</code> statement<a class="anchor" aria-label="anchor" href="#print-statement"></a>
</h2>
<hr class="half-width">
<p>In general</p>
<pre><code>  print format [ , output-item-list ]</code></pre>
<p>where the <code>format</code> is a format specifier (discussed later)
and the <code>output-item-list</code> is a comma-separated list of
values/variables to be printed to the standard output.</p>
<p>If the format is a <code>*</code> (a so-called free-format) the
implementation is allowed to apply a default format for a given type of
item.</p>
</section><section><h2 class="section-heading" id="alternative">Alternative<a class="anchor" aria-label="anchor" href="#alternative"></a>
</h2>
<hr class="half-width">
<p>Consider the following program (available as <a href="../files/exercises/01-hello-world/example3.f90">example3.f90</a>):</p>
<pre><code>program example3

  use iso_fortran_env, only : output_unit

  write (output_unit, *) "Hello ", "world"

end program example3</code></pre>
<p>This example shows a more general way to provide some output. Here we
are also going to employ the <code>use</code> statement to import a
symbol from the (intrinsic) module <code>iso_fortran_env</code>. The
symbol is <code>output_unit</code> which identifies the default standard
output (cf. <code>stdout</code>).</p>
<div class="section level3">
<h3 id="use-statement">
<code>use</code> statement<a class="anchor" aria-label="anchor" href="#use-statement"></a>
</h3>
<p>Formally,</p>
<pre><code>  use [[ , module-nature] ::] module-name [ , only : [only-list]]</code></pre>
<p>If <code>module-nature</code> is present, it must be either
<code>intrinsic</code> or <code>non_intrinsic</code>. The implementation
must provide certain intrinsic modules such
<code>iso_fortran_env</code>. You can write modules of your own, as we
will see later on.</p>
<p>There is no formal namespace mechanism in Fortran (cf. C++), so
restrictions on which symbols are visible can be made via an optional
<code>only-list</code>. If there is no <code>only-list</code> then all
the public symbols from <code>module-name</code> will be visible.</p>
</div>
<div class="section level3">
<h3 id="write-statement">
<code>write</code> statement<a class="anchor" aria-label="anchor" href="#write-statement"></a>
</h3>
<p>Formally,</p>
<pre><code><span>  <span class="fu">write</span> <span class="op">(</span><span class="va">io</span><span class="op">-</span><span class="va">control</span><span class="op">-</span><span class="va">spec</span><span class="op">-</span><span class="va">list</span><span class="op">)</span> <span class="op">[</span><span class="va">output</span><span class="op">-</span><span class="va">item</span><span class="op">-</span><span class="va">list</span><span class="op">]</span></span></code></pre>
<p>where the <code>output-item-list</code> is a comma separated list of
items to be output. The <code>io-control-spec-list</code> has a large
number of potential arguments (again comma separated). For formatted
output, these must include at least a unit number and a format:</p>
<pre><code>  write ([unit = ] io-unit, [fmt = ] format) [output-item-list]</code></pre>
<p>where the <code>io-unit</code> is a valid integer unit number, and
the <code>format</code> is a format-specifier (as for
<code>print</code>).</p>
<p>Examples are</p>
<pre><code>  write (unit = output_unit, fmt = *)
  write (output_unit, *)
  write (*, *)</code></pre>
<p>C programmers looking for a new-line like symbol will notice that
none has appeared so far. The default situation is that both
<code>print</code> and <code>write</code> generate a new-line
automatically. The <code>*</code> symbol in the context of
<code>io-unit</code> is a default output unit (usually the screen).</p>
<p>We will return to the <code>write</code> statement and
format-specifiers in more detail in the context of i/o to external
files.</p>
</div>
</section><section><h2 class="section-heading" id="some-comments-on-style">Some comments on style<a class="anchor" aria-label="anchor" href="#some-comments-on-style"></a>
</h2>
<hr class="half-width">
<p>Modern Fortran is not case sensitive. Older versions required
capitals, a style which has persisted to the present day in some places.
So you may see things such as</p>
<pre><code>PROGRAM example1

  PRINT *, "Hello World"

END PROGRAM example1</code></pre>
<p>As modern etiquette tends to regard capitals as shouting, this can
cause some tension.</p>
<p>The compiler will accept mixed case. An additional tool would be
required to enforce a particular style.</p>
<p>This course will prefer an all lower-case style.</p>
<div class="section level3">
<h3 id="exercise-2-minutes">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes"></a>
</h3>
<div id="check-symbol-values" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="check-symbol-values" class="callout-inner">
<h3 class="callout-title">Check symbol values</h3>
<div class="callout-content">
<p>Write a program which prints out the actual values of the symbols
<code>output_unit</code>, <code>error_unit</code>, and
<code>input_unit</code> (all from <code>iso_fortran_env</code>) to the
screen.</p>
<p>If you haven’t used the <code>only</code> clause in your
<code>use iso_fortran_env</code>, add it now. What happens to the
results if you miss out one of the symbols referenced from the
<code>only</code> clause? This behaviour will be explained in the
following section.</p>
<p>Bonus: check the values using both the Cray and GCC compilers. On
ARCHER2 both are invoked with the <code>ftn</code> compiler wrapper.
Which compiler is actually used depends on the <code>PrgEnv-</code>
module loaded.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Make sure to <code>use</code> the module, then use
<code>print *</code> statements to write the values of the three symbols
to the screen. Sample solution code is available in <a href="../files/exercises/01-hello-world/exercise1.f90">exercise1.f90</a>.</p>
<p>Running with the default Cray compiler gives the output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> output_unit is:  101
 error_unit is:   102
 input_unit is:   100</code></pre>
</div>
<p>while using <code>gfortran</code> from GCC gives:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> output_unit is:            6
 error_unit is:             0
 input_unit is:             5</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>A Fortran program begins with a <code>program</code> statement and
ends with an <code>end program</code> statement.</li>
<li>A <code>print</code> statement is a simple way to write output to
the terminal.</li>
<li>A <code>write</code> statement provides more control including ways
to write to file.</li>
<li>Modules can be loaded with the <code>use</code> statement.</li>
<li>The <code>iso_fortran_env</code> module provides symbols which can
be used to help read from and write to the terminal.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-011-break"><p>Content from <a href="011-break.html">Break</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/011-break.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Comfort break.</p></section><section id="aio-02-variables"><p>Content from <a href="02-variables.html">Variables</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/02-variables.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are some basic types of numeric variables in Fortran?</li>
<li>How are variables declared and defined?</li>
<li>How do I create constants?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to create variables and assign values to them.</li>
<li>Specify the representation in memory of variables independently of
the implementation.</li>
<li>Store constant values.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="numeric-variables-of-intrinsic-type">Numeric variables of intrinsic type<a class="anchor" aria-label="anchor" href="#numeric-variables-of-intrinsic-type"></a>
</h2>
<hr class="half-width">
<p>The following program declares a variable with each of the three
intrinsic numeric types, and provides an initial value in each case.</p>
<pre><code>program example1

   implicit none

   integer :: i = 1            ! A default integer kind
   real    :: a = 2.0          ! A default floating point kind
   complex :: z = (0.0, 1.0)   ! A complex kind with (real-part, imag-part)

end program example1</code></pre>
<p>Initial values are optional. If a declaration does not specify an
initial value, the variable is said to be <em>undefined</em>.</p>
<div class="section level3">
<h3 id="variable-names">Variable names<a class="anchor" aria-label="anchor" href="#variable-names"></a>
</h3>
<p>The valid Fortran character set for names is <code>a-z</code>,
<code>A-Z</code>, <code>0-9</code> and the underscore <code>_</code>.
Valid names must begin with a character. The maximum length of a name is
63 characters (F2003) with no spaces allowed. This includes names for
programs, and names for variables.</p>
<p>Other special characters recognised by Fortran are:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="16%">
<col width="37%">
<col width="16%">
<col width="29%">
</colgroup>
<thead><tr>
<th>Character</th>
<th>Name</th>
<th>Character</th>
<th>Name</th>
</tr></thead>
<tbody>
<tr>
<td></td>
<td>Blank</td>
<td><code>;</code></td>
<td>Semi-colon</td>
</tr>
<tr>
<td><code>=</code></td>
<td>Equals</td>
<td><code>!</code></td>
<td>Exclamation mark</td>
</tr>
<tr>
<td><code>+</code></td>
<td>Plus</td>
<td><code>"</code></td>
<td>Double quote</td>
</tr>
<tr>
<td><code>-</code></td>
<td>Minus</td>
<td><code>%</code></td>
<td>Percent</td>
</tr>
<tr>
<td><code>*</code></td>
<td>Asterick</td>
<td><code>&amp;</code></td>
<td>Ampersand</td>
</tr>
<tr>
<td><code>/</code></td>
<td>Slash</td>
<td><code>~</code></td>
<td>Tilde</td>
</tr>
<tr>
<td><code>\</code></td>
<td>Backslash</td>
<td><code>&lt;</code></td>
<td>Less than</td>
</tr>
<tr>
<td><code>(</code></td>
<td>Left parenthesis</td>
<td><code>&gt;</code></td>
<td>Greater than</td>
</tr>
<tr>
<td><code>)</code></td>
<td>Right parenthesis</td>
<td><code>?</code></td>
<td>Question mark</td>
</tr>
<tr>
<td><code>[</code></td>
<td>Left square bracket</td>
<td><code>'</code></td>
<td>Apostrophe</td>
</tr>
<tr>
<td><code>]</code></td>
<td>Right square bracket</td>
<td><code>`</code></td>
<td>Grave accent</td>
</tr>
<tr>
<td><code>{</code></td>
<td>Left curly brace</td>
<td><code>^</code></td>
<td>Circumflex</td>
</tr>
<tr>
<td><code>}</code></td>
<td>Right curly brace</td>
<td><code>|</code></td>
<td>Pipe</td>
</tr>
<tr>
<td><code>,</code></td>
<td>Comma</td>
<td><code>$</code></td>
<td>Dollar sign</td>
</tr>
<tr>
<td><code>.</code></td>
<td>Decimal point</td>
<td><code>#</code></td>
<td>Hash</td>
</tr>
<tr>
<td><code>:</code></td>
<td>Colon</td>
<td><code>@</code></td>
<td>At</td>
</tr>
</tbody>
</table>
<p>Other characters may appear in comments.</p>
</div>
<div class="section level3">
<h3 id="implicit-statement">
<code>implicit</code> statement<a class="anchor" aria-label="anchor" href="#implicit-statement"></a>
</h3>
<p>The <code>implicit</code> statement defines a type for variable names
not explicitly declared. So, the default situation can be represented
by</p>
<pre><code>  implicit integer (i-n), real (a-h, o-z)</code></pre>
<p>that is, variables with names beginning with letters <code>i-n</code>
are implicitly of type <code>integer</code>, while anything else is of
type <code>real</code> (unless explicitly declared otherwise).</p>
<p>By modern standards this is tantamount to recklessness. The general
solution to prevent errors involving undeclared variables (usually
arising from typos) is to declare that no names have implicit type
via</p>
<pre><code>implicit none</code></pre>
<p>In this case, all variable names must be declared explicitly before
they are referenced.</p>
<p>However, it is still common to see the idiom that variables beginning
with <code>i-n</code> are integers and so on, albeit declared
explicitly.</p>
<div id="using-implicit-none" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="using-implicit-none" class="callout-inner">
<h3 class="callout-title">Using <code>implicit none</code>
</h3>
<div class="callout-content">
<p>To reiterate – all modern Fortran code really should use
<code>implicit none</code>. Failing to do so will almost certainly lead
to bugs and hence time spent debugging!</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="exercise-1-minute">Exercise (1 minute)<a class="anchor" aria-label="anchor" href="#exercise-1-minute"></a>
</h3>
<div id="the-importance-of-being-explicit" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="the-importance-of-being-explicit" class="callout-inner">
<h3 class="callout-title">The importance of being explicit</h3>
<div class="callout-content">
<p>Compile and run the accompanying program <a href="../files/exercises/02-variables/exercise1.f90">exercise1.f90</a>.
What’s the problem and how should we avoid it? Check the compiler can
trap the problem.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The issue is that the variable we declare is initialise is
<code>ll</code>, but the variable we print is <code>l1</code>. Look
closely at these names: the latter mistakenly uses a digit one
<code>1</code> where it should be the letter <code>l</code>. When we
print the hitherto unmentioned <code>l1</code>, the compiler implicitly
creates it as a new <code>integer</code>.</p>
<p>Add <code>implicit none</code> to the top of the code</p>
<pre class="source"><code>program exercise1

  implicit none

  integer :: ll = 1

  print *, "The value of ll is: ", l1

end program exercise1</code></pre>
<p>which then produces an error at compile time, e.g. with the Cray
compiler:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
  print *, "The value of ll is: ", l1
                                   ^
ftn-113 ftn: ERROR EXERCISE1, File = exercise1.f90, Line = 7, Column = 36
  IMPLICIT NONE is specified in the local scope, therefore an explicit type must be specified for data object "L1".

Cray Fortran : Version 15.0.0 (20221026200610_324a8e7de6a18594c06a0ee5d8c0eda2109c6ac6)
Cray Fortran : Compile time:  0.0024 seconds
Cray Fortran : 9 source lines
Cray Fortran : 1 errors, 0 warnings, 0 other messages, 0 ansi
Cray Fortran : "explain ftn-message number" gives more information about each message.</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="kind-of-type">
<code>kind</code> of type<a class="anchor" aria-label="anchor" href="#kind-of-type"></a>
</h3>
<p>The declarations above give us variables of some
(implementation-defined) default type (typically 4-byte integers, 4-byte
reals). A mechanism to control the exact kind, or representation, is
provided. For example (see <code>example2.f90</code>),</p>
<pre><code>  use iso_fortran_env, only : int64, real64
  implicit none

  integer (kind = int64)   :: i = 100
  real    (kind = real64)  :: a = 1.0
  complex (kind = real64)  :: z = (0.0, 1.0)</code></pre>
<p>Here we use <em>kind type parameters</em> <code>int64</code> and
<code>real64</code> to specify that we require 64-bit integers and
64-bit floating point storage, respectively.</p>
<p>A standard conforming Fortran implementation must provide at least
one <code>integer</code> precision with a decimal exponent range of at
least 18 (experience suggests all provide at least two kinds). Note that
Fortran does not have any equivalent of C/C++ unsigned integer
types.</p>
<p>An implementation must provide at least two <code>real</code>
precisions, one default precision, and one extended precision (sometimes
referenced as <code>double precision</code>).</p>
<p>Formally, the numeric types are introduced</p>
<pre><code>  numeric-type-spec [kind-selector] ...</code></pre>
<p>where the <code>numeric-type-spec</code> is one of
<code>integer</code>, <code>real</code>, or <code>complex</code>. The
optional <em>kind selector</em> is</p>
<pre><code>  ([kind = ] scalar-integer-initialisation-expr)</code></pre>
<p>The upshot of this is that the syntax of declarations is quite
elastic, and you may see a number of different styles. A reasonable form
of concise declaration with an explicit kind type parameter is:</p>
<pre><code>  integer (int32)  :: i
  real    (real32) :: a
  complex (real32) :: z</code></pre>
</div>
<div class="section level3">
<h3 id="example-2-minutes">Example (2 minutes)<a class="anchor" aria-label="anchor" href="#example-2-minutes"></a>
</h3>
<p>Take a moment to compare the output of the programs <a href="../files/exercises/02-variables/example1.f90">example1.f90</a> and <a href="../files/exercises/02-variables/example2.f90">example2.f90</a>, which
declare and initialise a variable of each type and print out their
values to the screen.</p>
</div>
<div class="section level3">
<h3 id="numeric-literal-constants">Numeric literal constants<a class="anchor" aria-label="anchor" href="#numeric-literal-constants"></a>
</h3>
<p>One may (optionally) specify the kind of an integer literal by
appending the kind type parameter with an underscore <code>_</code>,
e.g.:</p>
<pre><code>123
+123
-123
12345678910_int64</code></pre>
<p>Floating point literal constants can take a number of forms. Examples
are:</p>
<pre><code>-3.14
.314
1.0e0             ! default precision
1.0d0             ! extended (double) precision
3.14_real128      ! may be available
3.14e-1           ! Scientific notation
3.14d+1           ! Scientific notation extended precision</code></pre>
<p>Complex literals are constructed with real and imaginary parts, with
each part real.</p>
<pre><code>(0.0, 1.0)        ! square root of -1</code></pre>
</div>
<div class="section level3">
<h3 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h3>
<p>Suppose we did not want to hardwire our kind type parameters
throughout the code. Consider:</p>
<pre><code>program example3

  implicit none

  integer, parameter :: my_e_k = kind(1.e0)
  integer, parameter :: my_d_k = kind(1.d0)

  real (my_e_k) :: a
  real (my_d_k) :: b

  ! ...

end program example3</code></pre>
<p>Here we have introduced an <code>integer</code> with the
<code>parameter</code> <em>attribute</em>. This is an instruction to the
compiler that the associated name should be a constant (similar to a
<code>const</code> declaration in C). Any subsequent attempt to assign a
value to a parameter will result in a compile time error.</p>
<p>The value specified in the parameter declaration must be a constant
expression (which the compiler may be able to evaluate at compile time).
Here we have made use of the <em>intrinsic function</em>
<code>kind()</code>. The <code>kind()</code> function returns an integer
which is the kind type parameter of the argument. In this context a
constant expression is one in which all parts are intrinsic.</p>
<p>Note we have not included anything or <code>use</code>’d anything to
make this <code>kind()</code> function available. It is an intrinsic
function and part of the language itself.</p>
<p>Using a parameter provides a degree of abstraction for the real data
type. Other examples might include:</p>
<pre><code>  integer, parameter :: nmax = 32              ! A constant
  real,    parameter :: pi = 4.0*atan(1.e0)    ! A well-known constant
  complex, parameter :: zi = (0.0, 1.0)        ! square root of -1</code></pre>
<p>The intrinsic function <code>atan()</code> returns the inverse
tangent (as a value in radians) of the argument.</p>
</div>
<div class="section level3">
<h3 id="exercise-2-minutes">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes"></a>
</h3>
<p>Consider further the accompanying <a href="../files/exercises/02-variables/example3.f90">example3.f90</a>, where
we have introduced another intrinsic function
<code>storage_size()</code> (roughly equivalent to C’s
<code>sizeof()</code> although it returns a size in bits rather than
bytes). Run the program and check the actual values of the kind type
parameters and associated storage sizes. Speculate on the portability of
a program declaring, e.g.:</p>
<pre><code>  integer (4) :: i32
  integer (8) :: i64</code></pre>
</div>
<div class="section level3">
<h3 id="exercise-2-minutes-1">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes-1"></a>
</h3>
<div id="parameters-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="parameters-1" class="callout-inner">
<h3 class="callout-title">Parameters</h3>
<div class="callout-content">
<p>Consider the accompanying <a href="../files/exercises/02-variables/exercise2.f90">exercise2.f90</a>.
Check the compiler error emitted and remove the offending line.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>The problem is that <code>nmax</code> is created with the
<code>parameter</code> attribute and given a value of 32, but that later
on an attempt is made to assign a new value of 33.</p>
<pre class="source"><code><span><span class="va">nmax</span> <span class="op">=</span> <span class="fl">33</span></span></code></pre>
<p>to resolve the issue.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="arithmetic-operations-on-numeric-types">Arithmetic operations on numeric types<a class="anchor" aria-label="anchor" href="#arithmetic-operations-on-numeric-types"></a>
</h3>
<p>For all intrinsic numeric types, standard arithmetic operations,
addition (<code>+</code>), subtraction (<code>-</code>), multplication
(<code>*</code>) and division (<code>/</code>) are defined, along with
exponents (<code>**</code>) and negation (<code>-</code>).</p>
<p>In order of increasing precedence these are <code>-</code>,
<code>+</code>, <code>/</code>, <code>*</code>, and <code>**</code>
(otherwise left-to-right). In particular</p>
<pre><code>   a = b*c**2    ! is evaluated as b*(c**2)
   a = b*c*d     ! evaluated left-to-right (b*c)*d</code></pre>
<p>Use parentheses to avoid ambiguity if necessary.</p>
<p>A large number of intrinsic functions exist for basic mathematical
operations and are relevant for all numeric types. A simple example is
<code>sqrt()</code>. Some are specific to particular types, e.g.,
<code>conjg()</code> for complex conjugate.</p>
<p>Broadly, assignments featuring different data types will cause
promotion to a “wider” type or cause truncation to a “narrower” type. If
one wants to be explicit, the equivalent of the cast mechanism in C is
via intrinsic functions, e.g.,</p>
<pre><code>   integer          :: i = 1
   complex (real64) :: z = (1.0, 1.0)
   real    (real64) :: a, b

   a = real(i, real64)          ! a should be 1.d0
   a = real(z, real64)          ! imaginary part is ignored

   b = real(i)                  ! return default real kind

   z = cmplx(a, b)              ! (sic) Form complex number from two reals</code></pre>
<p>The second argument of the <code>real()</code> function is optional,
and specifies the kind type parameter of the desired result. If the
optional argument is not present, then a real value of the default kind
is returned.</p>
<p>Note here the <em>token</em> <code>real</code> has been used in two
different contexts: as a statement in the declaration of variables
<code>a</code> and <code>b</code>, and as a function. There is not quite
the same concept of “reserved words” (cf C/C++); lines are split into
tokens based on spaces, and tokens are parsed in context.</p>
</div>
<div class="section level3">
<h3 id="complex-real-and-imaginary-parts">Complex real and imaginary parts<a class="anchor" aria-label="anchor" href="#complex-real-and-imaginary-parts"></a>
</h3>
<p>The real and imaginary parts of a complex variable may be
accessed</p>
<pre><code>  complex :: z

  z%re = 0.0     ! real part
  z%im = 1.0     ! imaginary part</code></pre>
<p>where the <code>%</code> symbol is referred to as the component
selector. The real and imaginary parts are also available via the
<code>real()</code> and <code>aimag()</code> intrinsic functions,
respectively.</p>
</div>
<div class="section level3">
<h3 id="exercise-2-minutes-2">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes-2"></a>
</h3>
<div id="using-sqrt" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="using-sqrt" class="callout-inner">
<h3 class="callout-title">Using <code>sqrt()</code>
</h3>
<div class="callout-content">
<p>By using variables of complex type, check that you can use the
intrinsic function <code>srqt()</code> to confirm that the square root
of -1 is <code>i</code>. What happens if you try to try to take the
square root of a negative value stored as a real variable?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>If you call <code>sqrt()</code> on a complex variable
<code>z%re = -1.0</code> and <code>z%im = 0.0</code> then a result will
be returned with a real part of <code>0</code> and an imaginary part of
<code>1</code>.</p>
<p>If you call <code>sqrt()</code> on a real number <code>-1</code> then
the compiler will exit with an error and a message explaining why this
is not valid.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="exercise-5-minutes">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes"></a>
</h3>
<div id="calculating-pi" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="calculating-pi" class="callout-inner">
<h3 class="callout-title">Calculating pi</h3>
<div class="callout-content">
<p>The accompanying template <a href="../files/exercises/02-variables/exercise3.f90">exercise3.f90</a>
provides instructions for an exercise which involves the approximation
to the constant pi computed via a Gauss-Legendre algorithm. Some
background can be found at <a href="https://en.wikipedia.org/wiki/Gauss-Legendre_algorithm" class="external-link uri">https://en.wikipedia.org/wiki/Gauss-Legendre_algorithm</a>.</p>
<p>Use the instructions in the template to calculate an estimate of pi
by creating an appropriate parameter to store a <code>kind</code>,
declaring the appropriate variables, then performing the calculation and
printing the values of pi.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>A solution to this problem appears as the template for the <a href="../files/exercises/04-do-statements/exercise1.f90">first exercise</a>
in the <a href="04-do-statements.html">episode on loops</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="exercise-5-minutes-1">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes-1"></a>
</h3>
<div id="calculating-the-conductance-in-a-narrow-channel" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="calculating-the-conductance-in-a-narrow-channel" class="callout-inner">
<h3 class="callout-title">Calculating the conductance in a narrow
channel</h3>
<div class="callout-content">
<p>A second exercise in a similar vein looks at an approximation to the
conductance of a rectangular channel subject to a constant flow.
Instructions are in <a href="../files/exercises/02-variables/exercise4.f90">exercise4.f90</a>.</p>
<p>As with the previous exercise, create a <code>kind</code>, the
variables, then perform the necessary arithmetic to calculate
<code>C_1</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<p>A solution to this problem appears as the template for the <a href="../files/exercises/04-do-statements/exercise2.f90">second
exercise</a> in the <a href="04-do-statements.html">episode on
loops</a>.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Fortran provides the intrinsic numeric types of
<code>integer</code>, <code>real</code> and <code>complex</code>.</li>
<li>Without a <code>kind</code>, these types are implementation-defined.
Use <code>kind</code> to specify the representation of variables.</li>
<li>The <code>iso_fortran_env</code> intrinsic module provides standard
kinds such as <code>real32</code> and <code>real64</code>.</li>
<li>Always use <code>implicit none</code> to prevent the accidental
implicit declaration of new variables.</li>
<li>Use the <code>parameter</code> attribute to make the value
associated with the name constant.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-03-if-statements"><p>Content from <a href="03-if-statements.html">Logical and conditionals, character variables</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/03-if-statements.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What other types of variable does Fortran provide?</li>
<li>How can I direct a program’s flow down different paths?</li>
<li>Is it possible to store characters in a variable?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to use <code>logical</code> variables.</li>
<li>Be able to control the flow of a program with <code>if</code>
statements.</li>
<li>Write conditional expressions using logical and relational
operators.</li>
<li>Be able to use a <code>case</code> construct.</li>
<li>Learn how to declare <code>character</code> variables.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="logical-variables">Logical variables<a class="anchor" aria-label="anchor" href="#logical-variables"></a>
</h2>
<hr class="half-width">
<p>Fortran has a <code>logical</code> type (cf. Boolean type in C);
there are two relevant literal values, illustrated here:</p>
<pre><code><span>  <span class="fu">logical</span> <span class="fu">::</span> <span class="va">switch0</span> <span class="op">=</span> <span class="va">.false.</span></span>
<span>  <span class="fu">logical</span> <span class="fu">::</span> <span class="va">switch1</span> <span class="op">=</span> <span class="va">.true.</span></span></code></pre>
<p>It is possible to specify a kind type parameter for logical kinds,
but you don’t see it very often. The default <code>logical</code> kind
has kind type parameter <code>kind(.false.)</code>.</p>
<div class="section level3">
<h3 id="logical-operators-and-expressions">Logical operators and expressions<a class="anchor" aria-label="anchor" href="#logical-operators-and-expressions"></a>
</h3>
<p>Standard logical operators <code>.or.</code>, <code>.and.</code> and
<code>.not.</code> are available. The precedence is illustrated by,
e.g.,</p>
<pre><code>  q = i .or. j .and. .not. k    ! evaluated as i .or. (j .and. (.not. k))</code></pre>
<p>Again, use parentheses to avoid ambiguity, or to add clarity.</p>
<p>Remember that <code>.or.</code> evaluates to <code>.true.</code> if
either or both its operands are <code>.true.</code>, while
<code>.and.</code> requires both to be <code>.true.</code> in order to
evaluate to <code>.true.</code>. The <code>.not.</code> operator inverts
the value of its operand.</p>
</div>
<div class="section level3">
<h3 id="relational-operators">Relational operators<a class="anchor" aria-label="anchor" href="#relational-operators"></a>
</h3>
<p>To form logical expressions from numeric or other expressions, we
require relational operators. The are two forms in Fortran:</p>
<table class="table">
<colgroup>
<col width="53%">
<col width="17%">
<col width="22%">
<col width="6%">
</colgroup>
<thead><tr>
<th>Relation</th>
<th>Operator</th>
<th>Older form</th>
<th>For</th>
</tr></thead>
<tbody>
<tr>
<td>Less than</td>
<td><code>&lt;</code></td>
<td><code>.lt.</code></td>
<td>
<code>integer</code> <code>real</code>
</td>
</tr>
<tr>
<td>Less than or equal to</td>
<td><code>&lt;=</code></td>
<td><code>.le.</code></td>
<td>
<code>integer</code> <code>real</code>
</td>
</tr>
<tr>
<td>Greater than</td>
<td><code>&gt;</code></td>
<td><code>.gt.</code></td>
<td>
<code>integer</code> <code>real</code>
</td>
</tr>
<tr>
<td>Greater than or equal to</td>
<td><code>&gt;=</code></td>
<td><code>.ge.</code></td>
<td>
<code>integer</code> <code>real</code>
</td>
</tr>
<tr>
<td>Equal to</td>
<td><code>==</code></td>
<td><code>.eq.</code></td>
<td>
<code>integer</code> <code>real</code> <code>complex</code>
</td>
</tr>
<tr>
<td>Not equal to</td>
<td><code>/=</code></td>
<td><code>.neq.</code></td>
<td>
<code>integer</code> <code>real</code> <code>complex</code>
</td>
</tr>
</tbody>
</table>
<p>If you are coming from C/C++ don’t be tempted by <code>!=</code> for
inequality.</p>
</div>
<div class="section level3">
<h3 id="logical-equivalence">Logical equivalence<a class="anchor" aria-label="anchor" href="#logical-equivalence"></a>
</h3>
<p>Equivalence between two logical expressions or variables is
established via the logical operators <code>.eqv.</code> and
<code>.neqv.</code>; do not be tempted to use <code>==</code> for
logical equality, although some compilers may let you get away with
it.</p>
</div>
</section><section><h2 class="section-heading" id="logic-and-flow-of-control">Logic and flow of control<a class="anchor" aria-label="anchor" href="#logic-and-flow-of-control"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="if-construct">
<code>if</code> construct<a class="anchor" aria-label="anchor" href="#if-construct"></a>
</h3>
<p>Conditional statements are provided by the <code>if</code> construct,
formally:</p>
<pre><code>[if-name:]  if (logical-expression) then
              block
            [ else if (logical-expression) then
              block ] ...
            [ else
              block ]
            end if [if-name]</code></pre>
<p>There may be zero or more <code>else if</code> blocks, but at most
one <code>else</code> block. At most one block is executed. For
example:</p>
<pre><code>  if (i &lt; j) then
    print *, "The smaller is: i ", i
  else if (i &gt; j) then
    print *, "The larger is:  i ", i
  else
    print *, "i,j are the same: ", i
  end if</code></pre>
<p>A single clause <code>if</code> statement is also available, for
example:</p>
<pre><code><span>  <span class="kw">if</span> <span class="op">(</span><span class="va">a</span> <span class="op">&gt;=</span> <span class="fl">0.0</span><span class="op">)</span> <span class="va">b</span> <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="example-1-3-minutes">Example 1 (3 minutes)<a class="anchor" aria-label="anchor" href="#example-1-3-minutes"></a>
</h3>
<div id="using-relational-operators" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="using-relational-operators" class="callout-inner">
<h3 class="callout-title">Using relational operators</h3>
<div class="callout-content">
<p>The file <a href="../files/exercises/03-if-statements/example1.f90">example1.f90</a>
contains a version of the code above. Check it works as expected. Can
you replace the relational operators to use the older form given in the
table above?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>You should be able to compile the code and run it to obtain the
output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> The smaller is: i  1</code></pre>
</div>
<p>To use the older forms of the operators <code>&gt;</code> and
<code>&lt;</code>, change them respectively to <code>.gt.</code> and
<code>.lt.</code>:</p>
<pre class="source"><code>  condition1 = (i .lt. j)
  condition2 = (i .gt. j)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="construct-names">Construct names<a class="anchor" aria-label="anchor" href="#construct-names"></a>
</h3>
<p>A number of control constructs in Fortran include the option to
specify names. This can be useful when highly nested structures are
present and one needs to refer unambiguously to one or other. A
construct name follows the same rules as for variable names.</p>
<p>A <code>if</code> construct with a name must have the matching name
with the <code>end if</code>.</p>
<p>For example</p>
<pre><code>highly_nested_if_construct: if (a &lt; b) then
                              ! ... structured block ...
                            end if highly_nested_if_construct</code></pre>
<p>As a matter of style, a leading name can be obtrusive, so one can put
it on a separate line using the continuation character
<code>&amp;</code>, e.g.,</p>
<pre><code>outer_if: &amp;
  if (a &lt; b) then
     ! ... structured block ...
  endif outer_if</code></pre>
<p>The standard maximum line length in Fortran is 132 characters. Longer
lines can be broken with the continuation character <code>&amp;</code>
to a maximum of 255 continuation lines (F2003).</p>
<p>Finally, note the use of <code>endif</code> without a space is not a
typo; both forms with and without a space are acceptable (this is true
of a number of Fortran statements). It’s probably preferable to stick to
“end if” (at least be consistent).</p>
</div>
<div class="section level3">
<h3 id="case-construct">
<code>case</code> construct<a class="anchor" aria-label="anchor" href="#case-construct"></a>
</h3>
<p>This is an analogue of the C switch facility, and can be useful for
actions conditional on a range or set of distinct values. Formally,</p>
<pre><code>[case-name:]  select case (case-expression)
                [ case (case-value-range-list)
		    block ] ...
		[ case default
		    block ]
              end select [case-name]
</code></pre>
<p>The <em>case-expression</em> must be a scalar integer, logical, or
character expression. The <em>case-value-range-list</em> is a
comma-separated list of either individual values, or ranges.</p>
<p>For example:</p>
<pre><code>   integer :: mycard = 1         ! Playing cards 1--13

   select case (mycard)
     case (1)
       ! Action for ace ...
     case (2:10)
       ! Action for other card ...
     case (11, 12, 13)
       ! Court card ...
     case default
       ! error...?
   end select</code></pre>
<p>A range may be open-ended (e.g., <code>2:</code> or
<code>:10</code>). Note there is no break-like statement as in the C
switch; only the relevant case block is executed.</p>
</div>
</section><section><h2 class="section-heading" id="character-variables">Character variables<a class="anchor" aria-label="anchor" href="#character-variables"></a>
</h2>
<hr class="half-width">
<p>Character variables hold zero or more characters. Some examples
are:</p>
<pre><code>program example2

  implicit none
  character (len = *), parameter :: string1 = "don't"   ! 5 characters
  character (len = 5)            :: string2 = "Don""t"  ! 5 characters
  character (len = 6)            :: string3 = 'don''t'  ! 5 characters + blank

end program example2</code></pre>
<p>The implementation must provide at least one type of character
storage, with the default kind being <code>kind('A')</code>. In
practice, kind type parameters are not often specified. However, there
should be a <code>len</code> specifier.</p>
<p>There is, again, a certain elasticity in the form of the declaration,
so you may see slightly different things.</p>
<p>Strings may be concatenated with the string concatenation operator
<code>//</code>; a single character, or a subset of characters, can be
extracted via use of an array-index like notation e.g.,
<code>string(1:2)</code>.</p>
<p>We will return to character variables in more detail when we consider
strings in a later section.</p>
</section><section><h2 class="section-heading" id="exercise-1-minute">Exercise (1 minute)<a class="anchor" aria-label="anchor" href="#exercise-1-minute"></a>
</h2>
<hr class="half-width">
<div id="character-len" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="character-len" class="callout-inner">
<h3 class="callout-title">Character <code>len</code>
</h3>
<div class="callout-content">
<p>Compile and check the output of <a href="../files/exercises/03-if-statements/example2.f90">example2.f90</a> to
see the result of the examples above. What happens if you change one of
the <code>len</code> specifications to be too short?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Without modifications, the code should produce the following
output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> string1: don't
 string2: Don"t
 string3: don't
 Catenated:       don't Don"tdon't
 Substring:       Do
 kind('A'):        1</code></pre>
</div>
<p>If we make <code>string3</code> too short, e.g.:</p>
<pre class="source"><code>  character (len = 2)            :: string3 = 'don''t'</code></pre>
<p>then the variable will truncate at that length:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> string1: don't
 string2: Don"t
 string3: do
 Catenated:       doDon"tdon't
 Substring:       Do
 kind('A'):        1</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="exercise-5-minutes">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes"></a>
</h2>
<hr class="half-width">
<div id="solving-a-quadratic-equation" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="solving-a-quadratic-equation" class="callout-inner">
<h3 class="callout-title">Solving a quadratic equation</h3>
<div class="callout-content">
<p>Write a program which uses real data types to compute the two
solutions to the quadratic equation:</p>
<pre><code><span>   <span class="va">a</span><span class="op">*</span><span class="va">x</span><span class="op">**</span><span class="fl">2</span> <span class="op">+</span> <span class="va">b</span><span class="op">*</span><span class="va">x</span> <span class="op">+</span> <span class="va">c</span> <span class="op">=</span> <span class="fl">0</span></span></code></pre>
<p>for given values of <code>a</code>, <code>b</code>, and
<code>c</code>. See <a href="https://en.wikipedia.org/wiki/Quadratic_formula" class="external-link">Wikipedia’s
page</a> for some background. A template <a href="../files/exercises/03-if-statements/exercise1.f90">exercise1.f90</a>
provides some instructions.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>A solution to this exercise appears as a template for the <a href="../files/exercises/06-array-expressions/exercise1.f90">first
exercise</a> in the <a href="06-array-expressions.html">episode on array
expressions</a></p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Fortran provides two non-numeric intrinsic data types:
<code>logical</code> and <code>character</code>.</li>
<li>A program’s flow can be directed using the results of logical
operations used in conjunction with <code>if</code> and
<code>case</code> constructs.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-031-lunch"><p>Content from <a href="031-lunch.html">Lunch</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/031-lunch.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Break for lunch.</p></section><section id="aio-04-do-statements"><p>Content from <a href="04-do-statements.html">Loops and loop control</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/04-do-statements.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I make the program do work repeatedly?</li>
<li>How can I have the program only do as much work as is required?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to use a <code>do</code> construct to execute a single
block of code many times.</li>
<li>See how to have a <code>do</code> construct skip a loop with
<code>cycle</code> or end early with <code>exit</code>.</li>
<li>Learn how to use loop control variables with <code>do</code>
constructs.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="uncontrolled-do-construct">Uncontrolled <code>do</code> construct<a class="anchor" aria-label="anchor" href="#uncontrolled-do-construct"></a>
</h2>
<hr class="half-width">
<p>A simple iteration is provided by the <code>do</code> statement. For
example, …</p>
<pre><code>  do
    ! ... go around for ever ...
  end do</code></pre>
<p>A slightly more useful version requires some control (see <a href="../files/exercises/04-do-statements/example1.f90">example1.f90</a>):</p>
<pre><code>   integer :: i = 0
   do
     i = i + 1
     if (mod(i, 2) == 0) cycle    ! go to the next iteration
     if (i &gt;= 10) exit            ! exit loop completely
     ! ... some computation ...
   end do

   ! ... control continues here after exit ...</code></pre>
<p>Loop constructs may be nested, and may also be named (see <a href="../files/exercises/04-do-statements/example2.f90">example2.f90</a>):</p>
<pre><code>  some_outer_loop: &amp;
  do
    some_inner_loop: &amp;
    do
      if (i &gt;= 10) exit some_outer_loop  ! exit belongs to outer loop
      ! ... continues ...
    end do some_inner_loop
  end do some_outer_loop</code></pre>
<p>If the control statements <code>cycle</code> or <code>exit</code> do
not have a label, they belong to the innermost construct in which they
appear.</p>
</section><section><h2 class="section-heading" id="loop-control">Loop control<a class="anchor" aria-label="anchor" href="#loop-control"></a>
</h2>
<hr class="half-width">
<p>More typically, one encounters controlled iterations with an
<code>integer</code> loop control variable. E.g.,</p>
<pre><code>  integer :: i
  do i = 1, 10, 2
    ! ... perform some computation ...
  end do</code></pre>
<p>Formally, we have</p>
<pre><code>[do-name:] do [loop-control]
             do-block
	   end do [do-name]</code></pre>
<p>with <em>loop-control</em> of the form:</p>
<pre><code>  do-variable = int-expr-lower, int-expr-upper [, int-expr-stride]</code></pre>
<p>and where the number of iterations will be</p>
<pre><code><span>  <span class="fu">max</span><span class="op">(</span><span class="fl">0</span>, <span class="op">(</span><span class="va">int</span><span class="op">-</span><span class="va">expr</span><span class="op">-</span><span class="va">upper</span> <span class="op">-</span> <span class="va">int</span><span class="op">-</span><span class="va">expr</span><span class="op">-</span><span class="va">lower</span> <span class="op">+</span> <span class="va">int</span><span class="op">-</span><span class="va">expr</span><span class="op">-</span><span class="va">stride</span><span class="op">)</span><span class="op">/</span><span class="va">int</span><span class="op">-</span><span class="va">expr</span><span class="op">-</span><span class="va">stride</span><span class="op">)</span></span></code></pre>
<p>in the absence of any subsequent control. The number of iterations
may be zero. Any of the expressions may be negative. If the stride is
not present, it will be 1 (unity); if the stride is present, it may not
be zero.</p>
<div class="section level3">
<h3 id="exercise-2-minutes">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes"></a>
</h3>
<div id="how-many-iterations-make-a-do-loop" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="how-many-iterations-make-a-do-loop" class="callout-inner">
<h3 class="callout-title">How many iterations make a do loop?</h3>
<div class="callout-content">
<p>What is the number of iterations in the following cases?</p>
<pre><code>   do i = 1, 10
     print *, "i is  ", i
   end do

   do i = 1, 10, -2
     print *, "i is ", i
   end do

   do i = 10, 1, -2
     print *, "i is ", i
   end do</code></pre>
<p>You can confirm your answers by running <a href="../files/exercises/04-do-statements/example3.f90">example3.f90</a>.
Note there is no way (cf. C <code>for</code>) to limit the scope of the
loop variable to the loop construct itself; the variable will then have
a final value after exit from the loop.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The following output is produced:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> First loop: 1, 10
 i is  1
 i is  2
 i is  3
 i is  4
 i is  5
 i is  6
 i is  7
 i is  8
 i is  9
 i is  10
 Second loop: 1, 10, -2
 Third loop: 10, 1, -2
 i is  10
 i is  8
 i is  6
 i is  4
 i is  2</code></pre>
</div>
<p>The first loop has ten iterations with <code>i</code> running from 0
to 10 in steps of 1.</p>
<p>The second loop runs zero times as, with a stride of -2, there is no
way to iterate from 1 to 10.</p>
<p>The third loop has five iterations, from 10 to 2 in steps of -2. The
stated end value of 1 can’t be reached, and 0 would go too far, so it
finishes at 2.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="exercise-5-minutes">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes"></a>
</h3>
<div id="calculating-pi-with-loops" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="calculating-pi-with-loops" class="callout-inner">
<h3 class="callout-title">Calculating pi with loops</h3>
<div class="callout-content">
<p>We return the exercises discussed in the earlier <a href="02-variables.html">episode on variables</a>. You can use your own
solutions, or the new template here.</p>
<p>For <a href="../files/exercises/04-do-statements/exercise1.f90">exercise1.f90</a>
which computes an approximation to the constant pi using the
Gauss-Legendre algorithm, introduce an iteration to compute a fixed
number of successive improvements. How many iterations are required to
converge when using <code>kind(1.d0)</code>? Would you be able to adjust
the program to halt the iteration if the approximation is within a given
tolerance of the true answer?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Sample code implementing loops with this problem is used as a
template to the <a href="../files/exercises/05-arrays/exercise1.f90">exercise</a> in the <a href="05-arrays.html">episode on arrays</a>.</p>
<p>You should be able to observe that with <code>kind(1.d0)</code> the
value of pi converges after only three iterations. You also can have the
code exit the loop and halt iteration by storing the previous estimate
of pi <code>if</code> the difference between the old and new values is
less than the desired tolerance.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="exercise-5-minutes-1">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes-1"></a>
</h3>
<div id="conductance-of-a-channel-with-loops" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="conductance-of-a-channel-with-loops" class="callout-inner">
<h3 class="callout-title">Conductance of a channel with loops</h3>
<div class="callout-content">
<p><a href="../files/exercises/04-do-statements/exercise2.f90">exercise2.f90</a>
returns to the calculation of the conductance in the narrow channel and
will need similar work. Use a loop to compute a fixed number of terms in
the sum over index k (use real type <code>real64</code> for the sum).
Here you should find convergence is much slower (you may need about 1000
terms); check by printing out the current value every so many terms (say
20).</p>
<p>Expert question: What happens if you accumulate the sum in the
reverse order in this case? Can you think why this happens?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Answer to the expert question: floating point numbers of a given
format (such as <code>real64</code>) all have the same <em>relative
error</em>, no matter how big or small they are. The <em>absolute
error</em> on the other hand is the produce of the number’s value and
the relative error; thus, a small <code>real</code> has a small absolute
error, and a large <code>real</code> has a large absolute error. If the
large numbers are summed first, the sum’s absolute error quickly becomes
large, and the smaller numbers are subsumed into it. If the small
numbers are summed first, the sum’s absolute error remains small enough
that the small numbers are able to contribute. Consider further how in
floating point maths it is true that
<code>(x + y) + z /= x + (y + z)</code>, if you are interested look up
<a href="https://en.wikipedia.org/wiki/Kahan_summation_algorithm" class="external-link">Kahan’s
algorithm</a>.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Iteration in Fortran is based around the <code>do</code> construct
(somewhat analogous to C <code>for</code> construct). There is no
equivalent of the C++ iterator class.</li>
<li>Without any control, a <code>do</code> loop will execute
forever.</li>
<li>A loop iteration can be skipped with a <code>cycle</code>
statement.</li>
<li>A loop can be ended if an <code>exit</code> statement is
encountered.</li>
<li>It is very common to control the execution of a loop with an
<code>integer</code> variable.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-05-arrays"><p>Content from <a href="05-arrays.html">Array declarations</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/05-arrays.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I create arrays of different sizes and numbers of
dimensions?</li>
<li>Can I create the arrays at runtime if I don’t yet know how big they
need to be?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to create arrays of one, two and more
dimensions.</li>
<li>Recognise and use array terminology.</li>
<li>Be able to create and use allocatable arrays.</li>
<li>Get help from the compiler if things go wrong.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="a-one-dimensional-array">A one-dimensional array<a class="anchor" aria-label="anchor" href="#a-one-dimensional-array"></a>
</h2>
<hr class="half-width">
<p>Arrays may be declared with addition of the <code>dimension</code>
attribute, e.g.,</p>
<pre><code>program example1

  implicit none

  real, dimension(3) :: a    ! declare a with elements a(1), a(2), a(3)

end program example1</code></pre>
<p>The <em>size</em> of the array is the total number of elements (here
3). The default <em>lower bound</em> is 1 and the <em>upper bound</em>
is 3.</p>
<p>In a slightly older style you may also see arrays declared by placing
the size of the array directly after the name, e.g. and
equivalently,</p>
<pre><code>  real :: a(3)               ! declare a with elements a(1), a(2), a(3)</code></pre>
<div id="fortran-array-indexing" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="fortran-array-indexing" class="callout-inner">
<h3 class="callout-title">Fortran array indexing</h3>
<div class="callout-content">
<p>Very importantly, Fortran arrays by default begin their indexing at
1. This is in direct contrast to other languages such as C, C++ and
Python which begin at 0. Both styles have advantages and disadvantages;
the Fortran standard has simply settled on a style that more closely
resembles the indexing of mathematical matrices, while starting from 0
makes the offset in the memory more visible.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="lower-and-upper-bounds">Lower and upper bounds<a class="anchor" aria-label="anchor" href="#lower-and-upper-bounds"></a>
</h3>
<p>If necessary or useful, you can however choose yourself the bounding
indices of your arrays:</p>
<pre><code>  real, dimension(-2:1) :: b ! elements b(-2), b(-1), b(0), b(1)</code></pre>
<p>Here we specify, explicitly, the lower and upper bounds. The
<em>size</em> of this array is 4.</p>
</div>
<div class="section level3">
<h3 id="array-constructor">Array constructor<a class="anchor" aria-label="anchor" href="#array-constructor"></a>
</h3>
<p>One may specify array values as a constructor</p>
<pre><code>  integer, dimension(3), parameter :: s = (/ -1, 0, +1 /)   ! F2003 or
  integer, dimension(3), parameter :: t = [  -1, 0, +1 ]    ! F2008</code></pre>
</div>
</section><section><h2 class="section-heading" id="a-two-dimensional-array">A two-dimensional array<a class="anchor" aria-label="anchor" href="#a-two-dimensional-array"></a>
</h2>
<hr class="half-width">
<pre><code>  real, dimension(2,3) :: a   ! elements a(1,1), a(1,2), a(1,3)
                              !          a(2,1), a(2,2), a(2,3)</code></pre>
<p>This two-dimensional array (said to have <em>rank</em> 2) has two
elements in the first dimension (or <em>extent</em> 2), and 3 elements
in the second dimension (<em>extent</em> 3). It is said to have
<em>shape</em> (2,3), which is the sequence of extents in each
dimension. Its size is 6 elements.</p>
<p>There is an array element order which in which we expect the
implementation to store contiguously in memory. In Fortran this has to
be the left-most dimension counting fastest. For array <code>a</code> we
expect the order in memory to be</p>
<pre><code>a(1,1), a(2,1), a(1,2), a(2,2), a(1,3), a(2,3)</code></pre>
<p>that is, the opposite the convention in C.</p>
<div id="looping-through-multi-dimensional-arrays" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="looping-through-multi-dimensional-arrays" class="callout-inner">
<h3 class="callout-title">Looping through multi-dimensional arrays</h3>
<div class="callout-content">
<p>In you write a loop which moves through an array, remember that you
will typically move most quickly through the first index. That means
that generally the innermost loop’s control variable should be used for
the first index, the next outer loop should use the second control
variable, and so on, e.g.,</p>
<pre><code>do j = 1, 10
  do i = 1, 20
    a(i,j) = ...   ! Do work to calculate the (i,j)th element of an array.
  end do
end do</code></pre>
</div>
</div>
</div>
<p>The principles of rank-2 arrays can be extended to higher ranks. The
standard requires support for a minimum of rank-15 arrays, but
individual compilers may allow for even more.</p>
<div class="section level3">
<h3 id="reshape">
<code>reshape</code><a class="anchor" aria-label="anchor" href="#reshape"></a>
</h3>
<p>A constructor for an array of rank 2 or above might be used,
e.g.,</p>
<pre><code>  integer, dimension(2,3) :: m = reshape([1,2,3,4,5,6], shape = [2,3])</code></pre>
<p>where we have used the intrinsic function <code>reshape()</code>.</p>
<p><code>reshape()</code> can be used wherever you might need to alter
an array’s shape.</p>
</div>
<div class="section level3">
<h3 id="exercise-2-minutes">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes"></a>
</h3>
<div id="array-sizes-and-shapes" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="array-sizes-and-shapes" class="callout-inner">
<h3 class="callout-title">Array sizes and shapes</h3>
<div class="callout-content">
<p>Check the accompanying <a href="../files/exercises/05-arrays/example1.f90">example1.f90</a> to see
examples of intrinsic functions available to interrogate array size and
shape at run time.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="allocatable-arrays">Allocatable arrays<a class="anchor" aria-label="anchor" href="#allocatable-arrays"></a>
</h2>
<hr class="half-width">
<p>If we wish to establish storage with shape determined at run time,
the <em>allocatable</em> attribute can be used. The rank must be
specified but the value of the extent in each dimension is deferred
using the <code>:</code> symbol:</p>
<pre><code>  real, dimension(:, :), allocatable :: a

  ! ... establish shape required, say (imax, jmax) ...

  allocate(a(imax, jmax))

  ! ... use and then release storage ...

  deallocate(a)</code></pre>
<p>Again, this array will take on the default lower bound of 1 in each
dimension.</p>
<p>Formally,</p>
<pre><code><span>  <span class="fu">allocate</span><span class="op">(</span><span class="va">allocate</span><span class="op">-</span><span class="va">list</span> <span class="op">[</span>, source <span class="op">=</span> <span class="va">array</span><span class="op">-</span><span class="va">expr</span><span class="op">]</span> <span class="op">[</span> , stat <span class="op">=</span> <span class="va">scalar</span><span class="op">-</span><span class="va">int</span><span class="op">-</span><span class="va">var</span><span class="op">]</span><span class="op">)</span></span></code></pre>
<p>The optional <code>source</code> argument may be used to provide a
template for the newly allocated object (values will be copied). We will
return to this in more detail in the context of dynamic type.</p>
<p>A successful allocation with the optional <code>stat</code> argument
will assign a value of zero to the argument.</p>
<div class="section level3">
<h3 id="allocation-status">Allocation status<a class="anchor" aria-label="anchor" href="#allocation-status"></a>
</h3>
<p>An array declared with the <em>allocatable</em> attribute is
initially in an unallocated state. When allocated, this status will
change; this status can be interrogated via the intrinsic function
<code>allocated()</code>.</p>
<pre><code>  integer, dimension(:), allocatable :: m
  ...
  if (allocated(m)) then
    ! ... we can do something ...
  end if</code></pre>
<p>An attempt to <code>deallocate</code> a variable which is not
allocated is an error.</p>
</div>
<div class="section level3">
<h3 id="exercise-5-minutes">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes"></a>
</h3>
<div id="computing-pi-with-arrays" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="computing-pi-with-arrays" class="callout-inner">
<h3 class="callout-title">Computing pi with arrays</h3>
<div class="callout-content">
<p>Return again to the program to compute the approximation of pi via
the Gauss-Legendre expansion (last seen in the <a href="04-do-statements.html">previous episode on do loops</a>). You may
use your own version or the new template provided in this directory (see
<a href="../files/exercises/05-arrays/exercise1.f90">exercise1.f90</a>).</p>
<p>Introduce array storage for the quantites <code>a</code>,
<code>b</code> and <code>t</code>. Use a fixed number of terms. Assign
appropriate values in a first loop. In a second loop, compute the
approximation of pi at each iteration.</p>
<p>What might you do if you wanted to store only the number of terms
taken to reach a converged answer?</p>
</div>
</div>
</div>
<div class="section level4">
<h4 id="help-is-available">Help is available!<a class="anchor" aria-label="anchor" href="#help-is-available"></a>
</h4>
<p>As arrays are self-describing in Fortran, it is relatively easy for
the compiler to analyse whether array accesses are valid, or within
bounds. This can help debugging. Most compilers will have an option that
instructs the compiler to inject additional code which checks bounds at
run time. For the Cray Fortran compiler, this is <code>-hbounds</code>;
for the GNU compiler, this is <code>-fcheck=bounds</code>.</p>
<p>E.g.,</p>
<pre><code>$ ftn -hbounds exercise1.f90</code></pre>
<p>Some compilers may also be able to check certain bounds at compile
time, and issue a compile-time message. However, in general, errors may
not appear until run time. If your program crashes, or produces
unexpected results, this compiler option can help to track down problems
with invalid array accesses.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Unlike C, which often uses pointers to handle array data, Fortran
has arrays which are an intrinsic feature of the language.</li>
<li>The number of dimensions in an array is its <em>rank</em>.</li>
<li>The number of elements in one of an array’s dimensions is its
<em>extent</em>.</li>
<li>The ordered sequence of extents in an array is its
<em>shape</em>.</li>
<li>The total number of elements in an array, equal to the product of
its shape, is its <em>size</em>.</li>
<li>In Fortran array indices begin at 1 by default, but this can be
changed if required.</li>
<li>New arrays can be created by using the intrinsic
<code>reshape()</code> function with an existing one.</li>
<li>An array with an unknown size can be allocated at runtime.</li>
<li>Compilers are typically able to help you debug issues with arrays if
you ask them to.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="aio-06-array-expressions"><p>Content from <a href="06-array-expressions.html">Array expressions and assignments</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/06-array-expressions.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I assign values to Fortran arrays?</li>
<li>Can I work at once with subsets of an array?</li>
<li>How can I reduce or extract information from an array?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn the syntax used to work with array sections.</li>
<li>Learn about array reductions.</li>
<li>Understand how to use arrays in logical expressions.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="array-sections">Array sections<a class="anchor" aria-label="anchor" href="#array-sections"></a>
</h2>
<hr class="half-width">
<p>A general subset of array elements, an <em>array section</em>, may be
constructed from a triplet with a start and end subscript and a
stride:</p>
<pre><code>  [subscript] : [subscript] [: stride]</code></pre>
<p>Given a rank 1 array <code>a(:)</code>, some valid array sub-objects
are:</p>
<pre><code>  a         ! the whole array
  a(:)      ! the whole array again
  a(1:4)    ! array section [ a(1), a(2), a(3), a(4) ]
  a(:4)     ! all elements up to and including a(4)
  a(2::2)   ! elements a(2), a(4), a(6), ...</code></pre>
<p>If an array subscript is present, it must be valid; if the stride is
present it may not be zero.</p>
</section><section><h2 class="section-heading" id="array-expressions-and-assignments">Array expressions and assignments<a class="anchor" aria-label="anchor" href="#array-expressions-and-assignments"></a>
</h2>
<hr class="half-width">
<p>Intrinsic operations can be used to construct expressions which are
arrays. For example:</p>
<pre><code>  integer, dimension(4, 8) :: a1, a2
  integer, dimension(4)    :: b1

  a1 = 0                      ! initialise all elements to zero
  a2 = a1 + 1                 ! all elements of a2(:,:)
  a1 = 2*a1                   ! multiplied element-wise

  b1 = a1(:, 1)               ! b1 set to first column of a1</code></pre>
<p>Such expressions and assignments must take place between entities
with the same shape (they are said to <em>conform</em>). A scalar
conforms with an array of any shape.</p>
<p>Given the above declarations, the following would not make sense:</p>
<pre><code><span>  <span class="va">b1</span> <span class="op">=</span> <span class="va">a1</span></span></code></pre>
<div class="section level3">
<h3 id="exercise-2-minutes">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes"></a>
</h3>
<div id="array-appearance" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="array-appearance" class="callout-inner">
<h3 class="callout-title">Array appearance</h3>
<div class="callout-content">
<p>A caution. How should we interpret the following assignments?</p>
<pre><code>  d = 1.0
  e(:) = 1.0</code></pre>
<p>Compile the accompanying program <a href="../files/exercises/06-array-expressions/example1.f90">example1.f90</a>,
check the compilation errors and improve the program.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The first assignment given above is ambiguous. Is <code>d</code> a
scalar variable, or an entire array? The second assignment is clearly on
every element of the rank-1 array <code>e</code>.</p>
<p>The compiler errors you get when compiling <a href="../files/exercises/06-array-expressions/example1.f90">example1.f90</a>
may spell out exactly what is going wrong. At line 13,</p>
<pre class="source"><code><span><span class="va">b1</span> <span class="op">=</span> <span class="va">a1</span></span></code></pre>
<p><code>b1</code> is a rank-1 array; the rank-2 array <code>a1</code>
cannot be used to assign values to it. Change it to</p>
<pre class="source"><code>b1(:) = a1(:,1)</code></pre>
<p>Then, the second issue is the assignment</p>
<pre class="source"><code><span><span class="fu">b1</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">=</span> <span class="fu">a2</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></code></pre>
<p>as the section <code>a2(1, 4:4)</code> is an array of the incorrect
size (note that <code>a2(1, 4)</code> would work as it becomes a scalar,
but wouldn’t set <code>b2</code> to the first half of the first row of
<code>a2</code>). To correct the error, fix the start index:</p>
<pre class="source"><code><span><span class="fu">b1</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">=</span> <span class="fu">a2</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="array-style" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="array-style" class="callout-inner">
<h3 class="callout-title">Array style</h3>
<div class="callout-content">
<p>Following this exercise, you hopefullly agree it may be a good idea
to prefer use of <code>a(:)</code> over <code>a</code> when referencing
the whole array. The former has the appearance of an array, while the
latter may incorrectly appear to be a scalar to an unfamiliar reader of
the code (or you yourself if it’s been a while since you last read
it).</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="elemental-intrinsic-functions">Elemental intrinsic functions<a class="anchor" aria-label="anchor" href="#elemental-intrinsic-functions"></a>
</h2>
<hr class="half-width">
<p>Many intrinsic functions are <em>elemental</em>: that is, a call with
a scalar argument will return a scalar, while a call with an array
argument will return an array with the result of the function for each
individual element of the argument. For example,</p>
<pre><code>   real, dimension(4) :: a, b
   ...
   b(1:4) = cos(a(1:4))</code></pre>
<p>will fill each element of <code>b</code> with the cosine of the
corresponding element in <code>a</code>.</p>
</section><section><h2 class="section-heading" id="reductions">Reductions<a class="anchor" aria-label="anchor" href="#reductions"></a>
</h2>
<hr class="half-width">
<p>Other intrinsic functions can be used to perform reduction operations
on arrays, and usually return a scalar. Common reductions are</p>
<pre><code>   a = minval( [1.0, 2.0, 3.0] )  ! the minimum value from the array
   b = maxval( [1.0, 2.0, 3.0] )  ! the maximum value from the array
   c = sum(array(:))              ! the sum of all values in the array</code></pre>
</section><section><h2 class="section-heading" id="logical-expressions-and-masks">Logical expressions and masks<a class="anchor" aria-label="anchor" href="#logical-expressions-and-masks"></a>
</h2>
<hr class="half-width">
<p>There is an array equivalent of the <code>if</code> construct called
<code>where</code>, e.g.,:</p>
<pre><code>  real, dimension(20) :: a
  ...
  where (a(:) &gt;= 0.0)
    a(:) = sqrt(a(:))
  end where</code></pre>
<p>which performs the appropriate operations element-wise. Formally,</p>
<pre><code>  where (array-logical-expr)
    array-assignments
  end where</code></pre>
<p>in which all the <em>array-logical-expr</em> and
<em>array-assignments</em> must have the same shape.</p>
<p>Logical functions <code>any()</code>, <code>all()</code>, and others
may be used to reduce logical arrays or array expressions. These return
a <code>logical</code> value so can be used in an <code>if</code>
statement:</p>
<pre><code>   if (any(a(:) &lt; 0.0)) then
     ! do something if at least one element of a(:) is negative
   end if
   if (all(a(:) &lt; 0.0)) then
     ! do something if every element of a(:) is negative
   end if</code></pre>
<p>Some intrinsic functions have an optional mask argument which can be
used to restrict the operations to certain elements, e.g.,</p>
<pre><code>  b = min(array(:), mask = (array(:) &gt; 0.0))     ! minimum of positive value
  n = count(array(:), mask = (array(:) &gt; 0.0))   ! count the number of positive values</code></pre>
<p>These may be useful in certain situations.</p>
<div class="section level3">
<h3 id="another-caution">Another caution<a class="anchor" aria-label="anchor" href="#another-caution"></a>
</h3>
<p>There may be a temptation to start to construct array expressions of
baroque complexity, perhaps in the search for brevity. This temptation
is probably best avoided:</p>
<ol style="list-style-type: decimal">
<li>Such expressions can become very hard to read and interpret for
correctness;</li>
<li>Performance: compilers may struggle to generate the best code if
expressions are very complex. Array expressions and constructs may not
work in parallel: explicit loops may provide better opportunities.</li>
</ol>
<p>If array expressions are used, simple ones are best.</p>
</div>
<div class="section level3">
<h3 id="exercise-5-minutes">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes"></a>
</h3>
<div id="quadratic-equation" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="quadratic-equation" class="callout-inner">
<h3 class="callout-title">Quadratic equation</h3>
<div class="callout-content">
<p>The template <a href="../files/exercises/06-array-expressions/exercise1.f90">exercise1.f90</a>
re-visits the quadratic equation exercise. Check you can replace the
scalars where appropriate. See the template for further
instructions.</p>
</div>
</div>
</div>
<div id="sieve-of-eratosthenes" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="sieve-of-eratosthenes" class="callout-inner">
<h3 class="callout-title">Sieve of Eratosthenes</h3>
<div class="callout-content">
<p>Here’s an additional exercise: write a program to implement the <a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes" class="external-link">Sieve of
Eratosthenes</a> algorithm which performs a search for prime numbers.
See <a href="../files/exercises/06-array-expressions/exercise2.f90">exercise2.f90</a>
for a template with some further instructions. How much array syntax can
you reasonably introduce?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>A sample solution is provided in <a href="../files/exercises/06-array-expressions/solutions/solution.f90">solution.f90</a>.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Fortran allows flexible operations on arrays or subsets of array
elements and provides numerous intrinsic functions for such
operations.</li>
<li>Some of these, such as <code>all()</code> and <code>any()</code> can
be useful in directing the logical flow of a program.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-061-break"><p>Content from <a href="061-break.html">Break</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/061-break.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Comfort break.</p></section><section id="aio-07-exercise"><p>Content from <a href="07-exercise.html">Mini exercise: a choice of two</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/07-exercise.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are some real problems I can try out?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Work on one of two larger exercises, putting your new skills to
use.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="a-choice">A choice…<a class="anchor" aria-label="anchor" href="#a-choice"></a>
</h2>
<hr class="half-width">
<p>We have two exercises you can choose to work on now. Both will allow
you to make use of the Fortran that you have learnt today. The former
exercise is the solution of a tri-diagonal system of equations, while
the latter will allow you program an implementation of Conway’s Game of
Life.</p>
<p>Whichever you choose (or if you choose both), we have time this
afternoon and tomorrow for you to work on your solutions.</p>
<div id="solve-a-tri-diagonal-system-30-minutes" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="solve-a-tri-diagonal-system-30-minutes" class="callout-inner">
<h3 class="callout-title">Solve a tri-diagonal system (30 minutes)</h3>
<div class="callout-content">
<p>This exercise will solve a tri-diagonal system of equations. A linear
system of equations can be represented by the problem
<code>Ax = b</code> where <code>A</code> is a known matrix,
<code>b</code> is a known vector, and <code>x</code> is an unknown
vector we wish to solve for. <code>A</code> is tri-diagonal, meaning
that it is 0 everywhere except for a stripe of non-zeroes three-elements
wide moving down the diagonal.</p>
<p>This means that we can represent an <code>n</code>-by-<code>n</code>
tri-diagonal matrix using three rank-1 arrays, one of size
<code>n</code> representing the diagonal and two of size
<code>n-1</code> representing the upper and lower diagonals. Through two
operations across the arrays, the first moving forwards and the second
backwards, as described at <a href="https://en.wikipedia.org/wiki/Tridiagonal_matrix_algorithm" class="external-link">Wikipedia</a>,
the solution <code>x</code> can be determined.</p>
<p>The accompanying template <a href="../files/exercises/07-exercise/tri-diagonal.f90">tri-diagonal.f90</a>
has some further instructions, and some suggestions on how to test the
result.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>A solution to the problem appears as a <a href="../files/exercises/10-dummy-array-arguments/exercise.f90">template</a>
to the exercise in the <a href="10-dummy-array-arguments.html">later
episode on dummy arguments</a>.</p>
</div>
</div>
</div>
</div>
<div id="game-of-life-60-minutes" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="game-of-life-60-minutes" class="callout-inner">
<h3 class="callout-title">Game of Life (60 minutes)</h3>
<div class="callout-content">
<p>In this exercise you will create a simple implementation of <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life" class="external-link">Conway’s
Game of Life</a>. The Game of Life is a <em>cellular automata</em> model
where an array of cells is updated based on some simple <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life#Rules" class="external-link">rules</a>
which give rise to complex patterns.</p>
<p>This model uses a ‘board’ of cells, each cell having a value of 0
(“dead”) or 1 (“alive”). The board’s initial state is chosen and then
stepped forwards. In a new step, each cell calculates the sum of the
surrounding eight cells. Depending on the value of that sum, the cell’s
state may change or stay the same. The rules governing the update are
summarised in the following table:</p>
<table class="table">
<thead><tr>
<th>Cell state</th>
<th>Sum of neighbouring 8 cells</th>
<th>New Cell state</th>
</tr></thead>
<tbody>
<tr>
<td>0</td>
<td>0,1,2,4,5,6,7,8</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0,1</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>4,5,6,7,8</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>2,3</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>A template <a href="../files/exercises/07-exercise/life.f90">life.f90</a> is provided
with some hints to get you started.</p>
<div class="section level3">
<h3 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h3>
<p>Your program should produce the following output for the initial
board and the first update:</p>
<pre><code>$ ./a.out
 Initial Board Set-up:
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................
 ........#.#.#........
 ........#...#........
 ........#...#........
 ........#...#........
 ........#.#.#........
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................

 First iteration:
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................
 .........#.#.........
 .......##...##.......
 .......###.###.......
 .......##...##.......
 .........#.#.........
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................
 .....................</code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Two reference answers are given in the <code>solutions</code>
directory. The <a href="../files/exercises/07-exercise/solutions/life-step2.f90">first</a>
only computes the first update, while the <a href="../files/exercises/07-exercise/solutions/life-step3.f90">second</a>
includes the time stepping loop.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>With a fairly small amount of the Fortran language, you can already
solve some real problems.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-08-modules"><p>Content from <a href="08-modules.html">Modules and compilation of modules</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/08-modules.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I collect parameters and sub-programs of my own in a
module?</li>
<li>Can I keep some parts of the module internal to it and hidden?</li>
<li>Am I able to use scoping to introduce temporary variables in a
larger program unit?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to write a non-intrinsic module of your own, and
understand what is and isn’t appropriate to place within them..</li>
<li>Understand how to use <code>public</code> and <code>private</code>
within a module to control what components are visible externally.</li>
<li>Use the <code>block</code> construct to control the scope of names
within larger program structures.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="module-structure">Module structure<a class="anchor" aria-label="anchor" href="#module-structure"></a>
</h2>
<hr class="half-width">
<p>We have already used one <em>intrinsic module</em>
(<code>iso_fortran_env</code>); we can also write our own, e.g.,</p>
<pre><code>module module1

  implicit none
  integer, parameter :: mykind = kind(1.d0)

contains

  function pi_mykind() result(pi)   ! Return the value of a well-known constant

    real (kind = mykind) :: pi
    pi = 4.0*atan(1.0_mykind)

  end function pi_mykind

end module module1</code></pre>
<p>We may now <code>use</code> the new module in other <em>program
units</em> (main program or other modules). For example:</p>
<pre><code>program example1

  use module1
  implicit none

  real (kind = mykind) :: value
  value = pi_mykind()

end program example1</code></pre>
<p>Here both the parameter <code>mykind</code> and the function
<code>pi_mykind()</code> are said to be available by <em>use
association</em>. Note that any <code>use</code> statements must come
before the <code>implicit</code> statement.</p>
<p>Formally, the structure of a module is:</p>
<pre><code>  module module-name
    [specification-statements]
  [ contains
    module-subprograms ]
  end [ module [ module-name ]]</code></pre>
<p>The <code>contains</code> statement separates the specification
statements from module sub-programs. Sub-programs, or
<em>procedures</em>, consist of functions and/or subroutines which will
cover in the <a href="09-functions-subroutines.html">next episode</a>
.</p>
<div class="section level3">
<h3 id="digression-compilation-of-modules-and-programs">Digression: compilation of modules, and programs<a class="anchor" aria-label="anchor" href="#digression-compilation-of-modules-and-programs"></a>
</h3>
<p>One would typically expect modules and a main program to be in
separate files, e.g.,:</p>
<pre><code>$ ls
module1.f90     program1.f90</code></pre>
<p>It is often convenient to use the same name for the both module and
the corresponding file (with extension <code>.f90</code>). You can do
differently, but it can become confusing. Likewise for the main
program.</p>
<p>We can compile the module, e.g.,</p>
<pre><code>$ ftn -c module1.f90</code></pre>
<p>where the <code>-c</code> option to the Fortran compiler
<code>ftn</code> requests compilation only (no link). This should give
us two new files:</p>
<pre><code>$ ls
module1.f90     module1.mod     module1.o       program1.f90</code></pre>
<p>The first is a compiler-specific <em>module file</em> (usually with a
<code>.mod</code> extension). This plays the role roughly analogous to a
header (<code>.h</code>) file in C, in that it contains the relevant
public information about what the module provides. The other file is the
object file (<code>.o</code> extension) which can be linked with the run
time to form an executable.</p>
<p>We can now compile both the main program and the module to give an
executable.</p>
<pre><code>$ ftn module1.o program1.f90</code></pre>
<p>Again, by analogy with C header files, we do not include the
<code>.mod</code> file in the compilation command; there is a search
path which the compiler uses to look for module files (which includes
the current working directory).</p>
<div id="mod-files" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="mod-files" class="callout-inner">
<h3 class="callout-title">
<code>.mod</code> files</h3>
<div class="callout-content">
<p>As stated, the <code>.mod</code> files are compiler specific. That
means that you shouldn’t expect that a file created by one compiler will
be usable by a different compiler. This can be can cause compile time
errors if you try to use a <code>.mod</code> from one compiler with
another; perhaps the most common scenario for this is when testing
builds with different compilers without first cleaning up the
<code>.mod</code> files. Sometimes compilers also use different naming
schemes for the <code>.mod</code> files can also change. This behaviour
can usually be changed with compiler flags.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="exercise-2-minutes">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes"></a>
</h3>
<div id="compiling-modules" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="compiling-modules" class="callout-inner">
<h3 class="callout-title">Compiling modules</h3>
<div class="callout-content">
<p>If you haven’t already done so, compile the accompanying <a href="../files/exercises/08-modules/module1.f90">module1.f90</a> and <a href="../files/exercises/08-modules/program1.f90">program1.f90</a>. Check
the errors which occur if you: (1) try to compile the program without
the module file via, e.g.,</p>
<pre><code>$ ftn program1.f90</code></pre>
<p>and (2), if you try to compile and link the module file alone:</p>
<pre><code>$ ftn module1.f90</code></pre>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Compiling the program alone produces (with the Cray compiler) the
following error:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
  use module1
      ^
ftn-292 ftn: ERROR PROGRAM1, File = program1.f90, Line = 3, Column = 7
  "MODULE1" is specified as the module name on a USE statement, but the compiler cannot find it.

  real (kind = mykind) :: a
               ^
ftn-113 ftn: ERROR PROGRAM1, File = program1.f90, Line = 6, Column = 16
  IMPLICIT NONE is specified in the local scope, therefore an explicit type must be specified for data object "MYKIND".
               ^
ftn-868 ftn: ERROR PROGRAM1, File = program1.f90, Line = 6, Column = 16
  "MYKIND" is used in a constant expression, therefore it must be a constant.

Cray Fortran : Version 15.0.0 (20221026200610_324a8e7de6a18594c06a0ee5d8c0eda2109c6ac6)
Cray Fortran : Compile time:  0.0472 seconds
Cray Fortran : 13 source lines
Cray Fortran : 3 errors, 0 warnings, 0 other messages, 0 ansi
Cray Fortran : "explain ftn-message number" gives more information about each message.</code></pre>
</div>
<p>This tells us precisely that the compiler doesn’t know what module
we’re talking about when we <code>use module1</code>, and then that
<code>mykind</code> (which we have been expecting to get from the
module) doesn’t exist either.</p>
<p>Compiling <code>module1</code> alone gives the following output from
the Cray compiler:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/opt/cray/pe/cce/15.0.0/binutils/x86_64/x86_64-pc-linux-gnu/bin/ld: /usr/lib64//crt1.o: in function `_start':
/home/abuild/rpmbuild/BUILD/glibc-2.31/csu/../sysdeps/x86_64/start.S:104: undefined reference to `main'</code></pre>
</div>
<p>This is less immediately meaningful. The second line tells us that
there’s no function called <code>main</code> available. This is because
what we’ve compiled has no <code>program ... end program</code>. There’s
no program in there to start, were we able to invoke it on the command
line. In other words, a module alone doesn’t make a program we can
run.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<hr class="half-width">
<p>Entities declared in a module are, by default, available by use
association, that is, they are visible in program units which
<code>use</code> the module. One can make this scope explicit via the
<code>public</code> and <code>private</code> statements.</p>
<pre><code>module module1

  implicit none
  public

  integer, parameter :: mykind = kind(1.d0)

contains

  function pi_mykind() result(pi)

    real (kind = mykind) :: pi
    ...
  end function pi_mykind()

end module module1</code></pre>
<p>Note that the parameter <code>mykind</code> is available throughout
the module via <em>host association</em> (always).</p>
<p>An alternative would be to switch the default to
<code>private</code>, and explicitly add <code>public</code>
attributes:</p>
<pre><code>module module1

  implicit none
  private

  integer, parameter, public :: mykind = kind(1.d0)    ! visible via `use`
  integer, parameter         :: mypriv = 2             ! not visible via `use`

  public :: pi_mykind

contains
  function pi_mykind() result(pi)                      ! public
    ! ... may call my_private() ...
  end function pi_mykind

  subroutine my_private()                              ! private
    ...
  end subroutine
end module module1</code></pre>
<p>Note that scope of the <code>implicit</code> statement also covers
the whole module, including sub-programs.</p>
<div class="section level3">
<h3 id="exercise-1-minute">Exercise (1 minute)<a class="anchor" aria-label="anchor" href="#exercise-1-minute"></a>
</h3>
<div id="private-modules" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="private-modules" class="callout-inner">
<h3 class="callout-title">Private modules</h3>
<div class="callout-content">
<p>Edit the accompanying <a href="">module1.f90</a> to add a
<code>private</code> statement and check the error if you try to compile
<code>program1.f90</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Making the module <code>private</code> hides the <code>mykind</code>
parameter it provide from the program. On compilation,
<code>mykind</code> can’t be found in the scope of the program, and the
compiler will complain that no such name exists.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="module-data-and-other-horrors">Module data and other horrors<a class="anchor" aria-label="anchor" href="#module-data-and-other-horrors"></a>
</h2>
<hr class="half-width">
<p>It is possible to establish non-parameter data in the specification
section of a module. E.g.,</p>
<pre><code>module module2

  implicit none
  integer, dimension(:), allocatable :: iarray
...</code></pre>
<p>This course will argue that you should <em>not</em> do so. There are
a number of reasons.</p>
<ol style="list-style-type: decimal">
<li>Any such data takes on the character of a global mutable object.
Global objects are generally frowned upon in modern software
development.</li>
<li>Operations in module procedures on such data run the risk of being
neither thread safe nor re-entrant.</li>
</ol>
<p>Even worse, variables declared with an initialisation in a module
sub-program, e.g.,</p>
<pre><code><span>  <span class="fu">integer</span> <span class="fu">::</span> <span class="va">i</span> <span class="op">=</span> <span class="fl">1</span></span></code></pre>
<p>implicitly take on the Fortran <code>save</code> attribute. This
means the variable is placed in heap memory and retains its value
between calls. (This is analogous to a <code>static</code> declaration
in C.) This is certainly neither thread-safe nor re-entrant.
Uninitialised variables appear on the stack (and disappear) as
expected.</p>
<p>For this reason it is the rule, rather than the exception, that
variables are not initialised at the point of declaration in
Fortran.</p>
<p>We will look at alternative ways of establishing and moving data as
we go along.</p>
</section><section><h2 class="section-heading" id="scope-again-block">Scope again: <code>block</code>
<a class="anchor" aria-label="anchor" href="#scope-again-block"></a>
</h2>
<hr class="half-width">
<p>It is not possible in Fortran to intermingle declarations and
executable statements. Specification statements must appear at the start
of scope before any executable statements. This can lead to rather
lengthy list of declarations at the start of large routines.</p>
<p>It is possible to introduce a local scope which follows executable
statements using the <code>block</code> construct. Schematically:</p>
<pre><code>   ... some computation ...
   block
     integer :: itmp                  ! in scope within the block only
     ... some more computation ...
   end block
   ... some more computation ...</code></pre>
<p>This can be useful for introducing temporary variables which are only
required for the duration of a short part of a longer procedure. In this
way, it acts like <code>{ .. }</code> in C.</p>
<div class="section level3">
<h3 id="exercise-5-minutes">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes"></a>
</h3>
<div id="return-to-gauss-legendre" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="return-to-gauss-legendre" class="callout-inner">
<h3 class="callout-title">Return to Gauss-Legendre</h3>
<div class="callout-content">
<p>Return to your code for the approximation to pi via the
Gauss-Legendre iteration (or use the template <a href="../files/exercises/05-arrays/exercise1.f90">exercise1.f90</a> from
the earlier episode on arrays). Using the examples above as a template,
write a module to contain a function which returns the value so
computed. Check you can use the new function from a main program.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>An example solution is provided in <a href="../files/exercises/08-modules/solutions/solution_program.f90">solution_program.f90</a>
and <a href="../files/exercises/08-modules/solutions/solution_module.f90">solution_module.f90</a>.</p>
</div>
</div>
</div>
</div>
<div id="module-dependencies" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="module-dependencies" class="callout-inner">
<h3 class="callout-title">Module dependencies</h3>
<div class="callout-content">
<p>Food for thought: can we have the following situation?</p>
<pre><code>module a

  use b
  implicit none
  ! content a ...
end module a</code></pre>
<p>and</p>
<pre><code>module b

  use a
  implicit none
  ! content b ...
end module b</code></pre>
<p>If not, why not?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>This is a circular dependency: <code>a</code> depends on
<code>b</code> depends on <code>a</code>. There is no solvable
dependency tree, and this is not allowed.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Modules in Fortran provide <em>the</em> way to structure collections
of related definitions and operations, and make them available
elsewhere.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-09-functions-subroutines"><p>Content from <a href="09-functions-subroutines.html">Functions and subroutines</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/09-functions-subroutines.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I factor code out into different program procedures?</li>
<li>How do I control the flow of information into and out of
procedures?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>See how to create and call both functions and subroutines.</li>
<li>Use the <code>intent</code> attribute with dummy arguments to change
their read and write permissions within the procedure.</li>
<li>Understand the meanings of <code>pure</code> and
<code>recursive</code> procedures.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="whats-the-difference">What’s the difference?<a class="anchor" aria-label="anchor" href="#whats-the-difference"></a>
</h2>
<hr class="half-width">
<p>The difference between functions and subroutines is to a degree one
of context. A function returns a result and is generally used where it
is best invoked as part of an expression or assignment,
schematically:</p>
<pre><code><span>  <span class="va">value</span> <span class="op">=</span> <span class="fu">my_function</span><span class="op">(</span><span class="va">arg1</span>, <span class="va">arg2</span>, <span class="va">...</span><span class="op">)</span></span></code></pre>
<p>Unlike C, it is not possible simply to discard a function result. A
subroutine, by contrast, does not return a result (it may be thought of
as a <code>void</code> function in C terms), but it is also invoked
differently:</p>
<pre><code>  call my_subroutine(arg1, arg2, ...)</code></pre>
<p>Subroutines are generally used to express more lengthy
algorithms.</p>
<p>Note that in the calling context, the arguments <code>arg1</code>,
<code>arg2</code>, etc are referred to as the <em>actual
arguments</em>.</p>
</section><section><h2 class="section-heading" id="dummy-arguments-and-intent-attribute">Dummy arguments and <code>intent</code> attribute<a class="anchor" aria-label="anchor" href="#dummy-arguments-and-intent-attribute"></a>
</h2>
<hr class="half-width">
<p>Procedures may have zero or more arguments (referred to as the
<em>dummy arguments</em> at the point at which the procedure is
defined). Three different cases can be identified:</p>
<ol style="list-style-type: decimal">
<li>read-only arguments whose values are not updated by the
procedure;</li>
<li>read-write arguments whose values are expected to be defined on
entry, and may also be updated by the procedure;</li>
<li>write-only arguments whose values are only defined on exit.</li>
</ol>
<p>These three cases may be encoded in the declarations of the dummy
arguments of a procedure via the <code>intent</code> attribute . For
example:</p>
<pre><code>  subroutine print_x(x)

    real, intent(in) :: x

    print *, "The value of x is: ", x

  end subroutine print_x</code></pre>
<p>Here, dummy argument <code>x</code> has <code>intent(in)</code> which
tells the compiler that any attempt to modify the value is erroneous (a
compiler error will result). This is different from C, where a change to
an argument passed by value is merely not reflected in the caller.</p>
<div id="passing-by-reference" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="passing-by-reference" class="callout-inner">
<h3 class="callout-title">Passing by reference</h3>
<div class="callout-content">
<p>If you are used to C/C++, you should remain aware here that the
Fortran standard requires actual arguments to be passed to functions and
subroutines in such a way that they ‘appear’ to have been passed by
reference. How to do so is left to the compiler (which may use copies or
actually pass by reference) but any changes made to a dummy argument
inside a procedure <em>will</em> be reflected in the actual arguments
passed to it, unless prevented by having <code>intent(in)</code>.</p>
</div>
</div>
</div>
<p>If one wants to alter the existing value of the argument,
<code>intent(inout)</code> is appropriate:</p>
<pre><code>  subroutine increment_x(x)

    real, intent(inout) :: x

    x = x + 1.0

  end subroutine increment_x</code></pre>
<p>If the dummy argument is undefined on entry, or has a value which is
simply to be overwritten, use <code>intent(out)</code>, e.g.:</p>
<pre><code>  subroutine assign_x(x)

    real, intent(out) :: x

    x = 1.0

  end subroutine assign_x</code></pre>
<p>The <code>intent</code> attribute, as well as allowing the compiler
to detect inadvertent errors, provides some useful documentation for the
reader.</p>
<p>Local variables do not have intent and are declared as usual.</p>
<div class="section level3">
<h3 id="exercise-2-minutes">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes"></a>
</h3>
<div id="exercise-name" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercise-name" class="callout-inner">
<h3 class="callout-title">Exercise name</h3>
<div class="callout-content">
<p>Attempt to compile the accompanying <a href="../files/exercises/09-functions-subroutines/module1.f90">module1.f90</a>
and associated main program <a href="../files/exercises/09-functions-subroutines/program1.f90">program1.f90</a>.
Check the error message emitted, and sort out the intent of the dummy
arguments in <a href="../files/exercises/09-functions-subroutines/module1.f90">module1.f90</a>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p><code>assign_x()</code> should use <code>intent(out)</code> for
<code>x</code> as it doesn’t matter what it was previously; we want to
set it to 1 and return it.</p>
<p><code>print_x()</code> is correct to use <code>intent(in)</code> for
<code>x</code> as it needs to know its value in order to print it, and
it shouldn’t change it.</p>
<p><code>increment_x()</code> should have <code>intent(inout)</code> for
<code>x</code>: the subroutine needs to know its previous value in order
to add to it (hence <code>in</code>) and it needs to be able to pass the
new value back out (hence <code>out</code>).</p>
</div>
</div>
</div>
</div>
<p>Attempt to compile the accompanying <a href="../files/exercises/09-functions-subroutines/module1.f90">module1.f90</a>
and associated main program <a href="../files/exercises/09-functions-subroutines/program1.f90">program1.f90</a>.
Check the error message emitted, and sort out the intent of the dummy
arguments in <a href="../files/exercises/09-functions-subroutines/module1.f90">module1.f90</a>.</p>
</div>
</section><section><h2 class="section-heading" id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<hr class="half-width">
<p>A function may be defined as:</p>
<pre><code>function my_mapping(value) result(a)

  real, intent(in) :: value
  real             :: a

  a = ...

end function my_mapping</code></pre>
<p>Formally,</p>
<pre><code>[prefix] function function-name (dummy-arg-list) [suffix]
  [ specification-part ]
  [ executable-part ]
end [ function [function-name] ]</code></pre>
<p>As ever, there is some elasticity in the exact form of the
declarations you may see. In particular, older versions did not have the
<code>result()</code> suffix, and the <em>function-name</em> was used as
the variable to which the return value was assigned. E.g.,</p>
<pre><code>real function length(area)
  real area
  length = sqrt(area)
end function length</code></pre>
<p>The modern form should be preferred; the <code>result()</code> part
allows the two names to be decoupled.</p>
<div class="section level3">
<h3 id="pure-procedures">
<code>pure</code> procedures<a class="anchor" aria-label="anchor" href="#pure-procedures"></a>
</h3>
<p>Procedures which have no side effects may be declared with the
<code>pure</code> prefix; this may provide useful information to the
compiler in some circumstances. E.g.,</p>
<pre><code>pure function special_function(x) result(y)
  real, intent(in) :: x
  ! ...
end function special_function</code></pre>
<p>There are a number of conditions which must be met to qualify for
<code>pure</code> status:</p>
<ol style="list-style-type: decimal">
<li>For a function, any dummy arguments must be intent(in);</li>
<li>No variables accessed by host association can be updated (and no
variables with <code>save</code> attribute);</li>
<li>there must be no operations on external files;</li>
<li>there must be no <code>stop</code> statement.</li>
</ol>
</div>
<div class="section level3">
<h3 id="recursive-procedures">
<code>recursive</code> procedures<a class="anchor" aria-label="anchor" href="#recursive-procedures"></a>
</h3>
<p>If recursion is required, a procedure must be declared with the
<code>recursive</code> prefix. E.g.,</p>
<pre><code>recursive function fibonacci(n) result(nf)
  ! ... implementation...
  nf = fibonacci(n-1) + fibonacci(n-2)
end function fibonacci</code></pre>
<p>Such a declaration must be included for both types of recursion:
direct (a procedure calling itself) and indirect (a procedure calling
another which in turn calls the first).</p>
</div>
</section><section><h2 class="section-heading" id="subroutines">Subroutines<a class="anchor" aria-label="anchor" href="#subroutines"></a>
</h2>
<hr class="half-width">
<p>Subroutines follow the same rules as functions, except that there is
no <code>result()</code> suffix specification:</p>
<pre><code>[prefix] subroutine subroutine-name (dummy-arg-list)
  [ specification-part ]
  [ executable-part ]
end [ subroutine [subroutine-name] ]</code></pre>
<div class="section level3">
<h3 id="return-statement">
<code>return</code> statement<a class="anchor" aria-label="anchor" href="#return-statement"></a>
</h3>
<p>One may have a <code>return</code> statement to indicate that control
should be returned to the caller, but it is not necessary (the
<code>end</code> statement does the same job). We will use
<code>return</code> when we consider error handling later.</p>
</div>
</section><section><h2 class="section-heading" id="placing-procedures-in-modules">Placing procedures in modules<a class="anchor" aria-label="anchor" href="#placing-procedures-in-modules"></a>
</h2>
<hr class="half-width">
<p>It is very often a good idea to include your procedures within
modules beneath the <code>contains</code> statement. Aside from leading
to good organisation of code, this has an extra advantage in that the
compiler will then automatically generate the contract block (forward
declaration or prototype) for the procedure as part of the module. This
can make it easier when using certain types of procedures (such as those
with <code>allocatable</code> dummy arguments) or in certain contexts
(such as passing the procedure as an argument).</p>
</section><section><h2 class="section-heading" id="exercise-5-minutes">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes"></a>
</h2>
<hr class="half-width">
<div id="gauss-and-legendre-met-fibonacci" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="gauss-and-legendre-met-fibonacci" class="callout-inner">
<h3 class="callout-title">Gauss and Legendre met Fibonacci</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Can your function for the evaluation of pi from the previous
episodes safely be declared <code>pure</code>? You can also use the
accompanying template <a href="../files/exercises/09-functions-subroutines/exercise_module1.f90">exercise_module1.f90</a>
and <a href="../files/exercises/09-functions-subroutines/exercise_program1.f90">exercise_program1.f90</a>
to check.</li>
<li>Add a new version of this calculation: a subroutine which takes the
number of terms as an argument, and also returns the computed value in
the argument list.</li>
<li>Add to the module a recursive function to compute the nth Fibonacci
number, and test it in the main code. See, for example the page at <a href="https://en.wikipedia.org/wiki/Fibonacci_number" class="external-link">Wikipedia</a>.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Solutions are available in <a href="../files/exercises/09-functions-subroutines/solutions/solution_program1.f90">solution_program1.f90</a>
and <a href="../files/exercises/09-functions-subroutines/solutions/solution_module1.f90">solution_module1.f90</a>.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Functions and subroutines are referred to collectively as
<code>_procedures_</code>.</li>
<li>Using <code>intent</code> for dummy variables allows control over
whether updates to their values are permitted.</li>
<li>Procedures can be modified with prefixes such as <code>pure</code>
and <code>recursive</code> which ensure respectively that the procedure
has no side-effects and that it is able to directly or indirectly call
itself.</li>
<li>Procedures may be defined as module sub-programs for which the
compiler will automatically generate the contract block as part of the
module file.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-10-dummy-array-arguments"><p>Content from <a href="10-dummy-array-arguments.html">More on array dummy arguments</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/10-dummy-array-arguments.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What do I need to take into consideration when passing an array as
an argument?</li>
<li>Can I pass arrays which haven’t yet been allocated?</li>
<li>How do I implement optional dummy arguments?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the meaning of an assumed shape array and where care
needs to be taken with its bounds.</li>
<li>Be able to use the intrinsic <code>lbound()</code> and
<code>ubound()</code> functions.</li>
<li>Understand the conditions around the usage of allocatable arrays as
dummy arguments.</li>
<li>Make some arguments optional and be able to provide them using
keyword arguments.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="array-dummy-arguments">Array dummy arguments<a class="anchor" aria-label="anchor" href="#array-dummy-arguments"></a>
</h2>
<hr class="half-width">
<p>When a dummy argument is an array, we need to think about how we want
the procedure to know about its shape.</p>
<div class="section level3">
<h3 id="explicit-shape">Explicit shape<a class="anchor" aria-label="anchor" href="#explicit-shape"></a>
</h3>
<p>One is entitled to make explicit the shape of an array in a procedure
definition, e.g.,</p>
<pre><code>  subroutine array_action1(nmax, a)
    integer, intent(in)                    :: nmax
    real, dimension(1:nmax), intent(inout) :: a
    ...
  end subroutine array_action1</code></pre>
<p>and similarly for arrays of higher rank. As before, if the lower
bound of the array is unspecified, it takes on the default value of
<code>1</code>.</p>
</div>
<div class="section level3">
<h3 id="assumed-shape">Assumed shape<a class="anchor" aria-label="anchor" href="#assumed-shape"></a>
</h3>
<p>However, it may be more desirable to leave the exact shape implicit
in the array itself, e.g.,</p>
<pre><code>  subroutine array_action2(a, b)
    real, dimension(:,:), intent(in   ) :: a
    real, dimension(:,:), intent(inout) :: b
    ...
  end subroutine array_action2</code></pre>
<p>Note that the rank is always explicit.</p>
<p>There are pros and cons to this: it is slightly more concise and
general, but some care may need to be exercised with the distinction
between <em>extents</em> and bounds. It is the <em>shape</em> that is
passed along with the actual arguments, and not the bounds.</p>
<div id="bounds-extents-and-shapes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="bounds-extents-and-shapes" class="callout-inner">
<h3 class="callout-title">Bounds, extents and shapes</h3>
<div class="callout-content">
<p>Remember from the earlier lesson on arrays that the number of
elements an array has in a given dimension is that dimension’s
<em>extent</em>. The ordered set of extents is the array’s
<em>shape</em>. The bounds are the minimum and maximum indices used in
each dimension.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="lbound-and-ubound-again">
<code>lbound()</code> and <code>ubound()</code> again<a class="anchor" aria-label="anchor" href="#lbound-and-ubound-again"></a>
</h3>
<p>You will have seen the <code>lbound()</code> and
<code>ubound()</code> functions being used during the <a href="../files/exercises/05-arrays/example1.f90">example</a> in the earlier
<a href="05-arrays.html">episode on arrays</a>. These functions return a
rank one array which is the relevant bound in each dimension. The
optional argument <code>dim</code> can be used to obtain the bound in
the corresponding rank or dimension e.g.,</p>
<pre><code>  real, dimension(:,:), intent(in) :: a
  integer :: lb1, lb2

  lb1 = lbound(a, dim = 1)  ! lower bound in first dimension
  lb2 = ubound(a, dim = 2)  ! upper bound in second dimension</code></pre>
</div>
<div class="section level3">
<h3 id="exercise-4-minutes">Exercise (4 minutes)<a class="anchor" aria-label="anchor" href="#exercise-4-minutes"></a>
</h3>
<div id="checking-array-bounds" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="checking-array-bounds" class="callout-inner">
<h3 class="callout-title">Checking array bounds</h3>
<div class="callout-content">
<p>Consider the accompanying example in <a href="../files/exercises/10-dummy-array-arguments/program1.f90">program1.f90</a>
and <a href="../files/exercises/10-dummy-array-arguments/module1.f90">module1.f90</a>.
Is the code correct? Add calls to <code>lbound()</code> and
<code>ubound()</code> in the subroutine to check.</p>
<p>What do you think was the intention of the programmer? What remedies
are available?</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="automatic-arrays">Automatic arrays<a class="anchor" aria-label="anchor" href="#automatic-arrays"></a>
</h3>
<p>One is allowed to bring into existence `automatic’ arrays on the
stack. These are usually related to temporary workspace, e.g.,</p>
<pre><code>subroutine array_swap1(a, b)
  integer, dimension(:), intent(inout) :: a, b
  integer, dimension(size(a))          :: tmp

  tmp(:) = a(:)
  a(:)   = b(:)
  b(:)   = tmp(:)
end subroutine array_swap1</code></pre>
<p>In this example, the same effect could have been achieved using a
loop and a temporary scalar.</p>
</div>
<div class="section level3">
<h3 id="allocatable-dummy-arguments">Allocatable dummy arguments<a class="anchor" aria-label="anchor" href="#allocatable-dummy-arguments"></a>
</h3>
<p>It may occasionally be appropriate to have a dummy argument with both
an intent and <code>allocatable</code> attribute.</p>
<pre><code>  subroutine my_storage(lb, ub, a)

    integer, intent(in) :: lb, ub
    integer, dimension(:), allocatable, intent(out) :: a

    allocate(a(lb:ub))

  end subroutine my_storage</code></pre>
<p>There are a number of conditions to such usage.</p>
<ol style="list-style-type: decimal">
<li>The corresponding actual argument must also be allocatable (and have
the same type and rank);</li>
<li>If the intent is <code>intent(in)</code> the allocation status
cannot be changed;</li>
<li>If the intent is <code>intent(out)</code> and the array is allocated
on entry, the array is automatically deallocated.</li>
</ol>
<p>The intent applies to both the allocation status and to the array
itself. Some care may be required.</p>
<p>A <code>function</code> may have an allocatable result which is an
array; this might be thought of as returning a temporary array which is
automatically deallocated when the relevant calling expression has been
evaluated.</p>
</div>
</section><section><h2 class="section-heading" id="optional-arguments">Optional arguments<a class="anchor" aria-label="anchor" href="#optional-arguments"></a>
</h2>
<hr class="half-width">
<p>We have encountered a number of intrinsic procedures with optional
dummy arguments. Such procedures may be constructed with the
<code>optional</code> attribute for a dummy argument, e.g.:</p>
<pre><code>  subroutine do_something(a, flag, ierr)
    integer, intent(in)            :: a
    logical, intent(in),  optional :: flag
    integer, intent(out), optional :: ierr

  end subroutine do_something</code></pre>
<p>Any operations on such optional arguments should guard against the
possibility that the corresponding actual argument was not present using
the intrinsic function <code>present()</code>. E.g.,</p>
<pre><code><span>  <span class="va">local_flag</span> <span class="op">=</span> <span class="va">some_default_value</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">present</span><span class="op">(</span><span class="va">flag</span><span class="op">)</span><span class="op">)</span> <span class="va">local_flag</span> <span class="op">=</span> <span class="va">flag</span></span></code></pre>
<p>Any attempt to reference a missing optional argument will generate an
error.</p>
<p>The one exception is that an optional argument may be passed directly
as an actual argument to another procedure where the corresponding dummy
argument is also optional.</p>
<div class="section level3">
<h3 id="positional-and-keyword-arguments">Positional and keyword arguments<a class="anchor" aria-label="anchor" href="#positional-and-keyword-arguments"></a>
</h3>
<p>Procedures will often have a combination of a number of mandatory
(non-optional) dummy arguments, and optional arguments. These may be
mixed via the use of keywords, which are the dummy argument name. E.g.,
using the subroutine defined above:,</p>
<pre><code>  call do_something(a, ierr = my_error_var)</code></pre>
<p>Here, <code>a</code> is appearing as a conventional positional
argument, while a keyword argument is used to select the appropriate
optional argument <code>ierr</code>. The rules are:</p>
<ol style="list-style-type: decimal">
<li>no further positional arguments can appear after the first keyword
argument;</li>
<li>positional arguments must appear exactly once, keyword arguments at
most once.</li>
</ol>
</div>
</section><section><h2 class="section-heading" id="exercise-10-minutes">Exercise (10 minutes)<a class="anchor" aria-label="anchor" href="#exercise-10-minutes"></a>
</h2>
<hr class="half-width">
<div id="tri-diagonal-modules" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="tri-diagonal-modules" class="callout-inner">
<h3 class="callout-title">Tri-diagonal modules</h3>
<div class="callout-content">
<p>Consider again the problem of the tri-diagonal matrix.</p>
<p>Refactor your existing stand-alone program (or use the template <a href="../files/exercises/10-dummy-array-arguments/exercise.f90">exercise.f90</a>)
to provide a module subroutine such as</p>
<pre><code>  subroutine tridiagonal_solve(b, a, c, rhs, x)</code></pre>
<p>where <code>b</code>, <code>a</code>, and <code>c</code> are arrays
of the relevant extent to represent the diagonal elements, the lower
diagonal elements and the upper diagonal elements respectively. Use the
<code>size()</code> intrinsic to determine the current size of the
matrix in the subroutine. The extent of the off-diagonal arrays should
be one less element. The <code>rhs</code> is the vector of right-hand
side elements, and <code>x</code> should hold the solution on exit.
Assume, in the first instance, that all the arrays are of the correct
extent on entry.</p>
<p>Check your result by calling the subroutine from a main program with
some test values. (You may wish to take two copies of the template
<code>exercise.f90</code> and use one as the basis of a module, and the
other as the basis of the main program.)</p>
<p>What do you need to do if the diagonal <code>b</code> and the
right-hand side <code>d</code> arrays should be declared
<code>intent(in)</code>?</p>
<p>What checks would be required in a robust implementation of such a
routine?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>In the original implementation, the diagonal and right-hand side are
destroyed during the calculation. To use <code>intent(in)</code> with
the dummy arguments, we have to leave them untouched. That means making
copies in local automatic arrays and using those instead.</p>
<p>A robust implementation would need to include checks on the bounds of
the dummy arrays to make sure that they correctly conform to one
another.</p>
<p>Sample solutions are available in the later <a href="16-data-structures.html">episode on derived types</a> in <a href="../files/exercises/16-data-structures/exercise_program.f90">exercise_program.f90</a>
and <a href="../files/exercises/16-data-structures/exercise_module.f90">exercise_module.f90</a>.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>There are some additional considerations to think about when dummy
arguments are arrays.</li>
<li>You may wish to pass the shape of the array explicitly, at the cost
of providing more dummy arguments.</li>
<li>Arrays may have an assumed shape, but remember that they only
receive the shape and not the original bounds of its dimensions.</li>
<li>Allocatable arrays can also be used as dummy arguments.</li>
<li>Dummy arguments can have the <code>optional</code> attribute. The
corresponding actual arguments can be positional or provided as a
keyword argument.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-101-break"><p>Content from <a href="101-break.html">Break</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/101-break.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Comfort break.</p></section><section id="aio-11-characters-strings"><p>Content from <a href="11-characters-strings.html">More on characters and strings</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/11-characters-strings.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How are character variables compared in Fortran?</li>
<li>How can I create and use flexible strings?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand relational operators and some of the intrinsic functions
that can be used with character variables.</li>
<li>Be able to create and use deferred length character variables.</li>
<li>Work with arrays of character variables.</li>
<li>Be able to use characters as procedure dummy arguments and
results.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="useful-character-operations">Useful <code>character</code> operations<a class="anchor" aria-label="anchor" href="#useful-character-operations"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="relational-operators">Relational operators<a class="anchor" aria-label="anchor" href="#relational-operators"></a>
</h3>
<p>The meaning of relational operators <code>==</code> and so on in the
context of characters is largely what one would expect from the standard
ASCII sequence. E.g.,</p>
<pre><code>   "A" &lt;  "b"      ! true
   "A" == "a"      ! false
   "A" /= "]"      ! true</code></pre>
<p>Note the ordinal position of a single character in the ASCII sequence
can be found via an intrinsic function, e.g.:</p>
<pre><code>   integer             :: i
   character (len = 1) :: c
   i = iachar("A")           ! i = 65
   c = achar(i)              ! c = "A"; requires 1 &lt;= i &lt;= 127</code></pre>
<p>Remember that in ASCII the upper case characters <code>A</code> to
<code>Z</code> have integer values 65 to 90, while the lower case
characters <code>a</code> to <code>z</code> have integer values 97 to
122.</p>
<p>If <code>character</code> variables are compared, then each letter is
compared left-to-right until a difference is found (or not). If the
variables have different lengths, then the shorter is padded with
blanks.</p>
</div>
<div class="section level3">
<h3 id="some-other-intrinsic-functions">Some other intrinsic functions<a class="anchor" aria-label="anchor" href="#some-other-intrinsic-functions"></a>
</h3>
<p>The length of a character variable is provided by the
<code>len()</code> intrinsic function.</p>
<p>The length with trailing blanks removed is <code>len_trim()</code>.
To actually remove the trailing blanks, use <code>trim()</code>. This is
often seen when concatenating fixed-length character strings using the
<code>//</code> operator:</p>
<pre><code>  print *, "File name: ", trim(file_stub)//"."//trim(extension)</code></pre>
<p>It’s also useful if you want to perform an operation on each
individual character, e.g.,</p>
<pre><code>  do n = 1, len_trim(string)
    if (string(n:n) == 'a') counta = counta + 1
  end do</code></pre>
<p>Note that the colon is mandatory in a sub-string reference, so a
single character must be referenced, e.g.,</p>
<pre><code>   print *, "Character at position i: ", string(i:i)</code></pre>
<p>Various other intrinsic functions exist for lexical comparisons,
justification, sub-string searches, and so on.</p>
</div>
</section><section><h2 class="section-heading" id="deferred-length-strings">Deferred length strings<a class="anchor" aria-label="anchor" href="#deferred-length-strings"></a>
</h2>
<hr class="half-width">
<p>The easiest way to provide a string which can be manipulated on a
flexible basis is the deferred length <code>character</code>:</p>
<pre><code>  character (len = :), allocatable :: string

  string = "ABCD"         ! Allocate and assign string
  string = "ABCDEFG"      ! Reallocate and assign again

  string(:) = ''          ! Keep same allocation, but set all blanks</code></pre>
<p>This may be initialised and updated in a general way, and the run
time will keep track of book-keeping. This also (usually) reduces
occurrences of trailing blanks.</p>
<p>If an allocation is required for which only the length is known
(e.g., there is no literal string involved), the following form of
allocation is required:</p>
<pre><code>  integer :: mylen
  character (len = :), allocatable :: string

  ! ... establish value of mylen ...

  allocate(character(len = mylen) :: string)</code></pre>
<p>Allocatable strings will automatically be deallocated when they go
out of scope and are no longer required. One can also be explicit:</p>
<pre><code><span>  <span class="fu">deallocate</span><span class="op">(</span><span class="va">string</span><span class="op">)</span></span></code></pre>
<p>if wanted.</p>
</section><section><h2 class="section-heading" id="arrays-of-strings">Arrays of strings<a class="anchor" aria-label="anchor" href="#arrays-of-strings"></a>
</h2>
<hr class="half-width">
<p>We have seen that we can define a fixed length parameter, e.g.,:</p>
<pre><code>  character (len = *), parameter :: day = "Sunday"</code></pre>
<p>Suppose we wanted an array of strings for “Sunday”, “Monday”,
“Tuesday”, and so on. One might be tempted to try something of the
form:</p>
<pre><code>  character (len = *), dimension(7), parameter :: days = [ ... ]</code></pre>
<div class="section level3">
<h3 id="exercise-2-minutes">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes"></a>
</h3>
<p>Check the result of the compilation of <a href="../files/exercises/11-characters-strings/example3.f90">example3.f90</a>.</p>
<p>The are a number of solutions to this issue. One could try to pad the
lengths of each array element to be the same length. A better way is to
use a constructor with a type specification:</p>
<pre><code>[character (len = 9) :: "Sunday", "Monday", "Tuesday", "Wednesday", ...]</code></pre>
<p>Here the type specification is used to avoid ambiguity in how the
list is to be interpreted.</p>
<p>Check you can make this adjustment to <a href="../files/exercises/11-characters-strings/example3.f90">example3.f90</a>.</p>
</div>
</section><section><h2 class="section-heading" id="strings-as-dummy-arguments-or-results">Strings as dummy arguments, or results<a class="anchor" aria-label="anchor" href="#strings-as-dummy-arguments-or-results"></a>
</h2>
<hr class="half-width">
<p>If a character variable has intent <code>in</code> in the context of
a procedure, it typically may be declared:</p>
<pre><code>  subroutine some_character_operation(carg1, ...)

     character (len = *), intent(in) :: arg1
     ...</code></pre>
<p>This is also appropriate for character variables of intent
<code>inout</code> where the length does not change.</p>
<p>For all other cases, use of deferred length allocatable characters is
recommended. E.g.,</p>
<pre><code>  function build_filename(stub, extension) result(filename)

    character (len = *), intent(in)  :: stub
    character (len = *), intent(in)  :: extension
    character (len = :), allocatable :: filenane
    ...</code></pre>
<p>A matching declaration in the caller is required.</p>
</section><section><h2 class="section-heading" id="exercise-10-minutes">Exercise (10 minutes)<a class="anchor" aria-label="anchor" href="#exercise-10-minutes"></a>
</h2>
<hr class="half-width">
<div id="exercise-name" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercise-name" class="callout-inner">
<h3 class="callout-title">Exercise name</h3>
<div class="callout-content">
<p>Write a subroutine which takes an existing string, and adjusts it to
make sure it is all lower case. That is, any character between “A” and
“Z” is replaced by the corresponding character between “a” and “z”.</p>
<p>Write an additional function to return a new string which is all
lower case, leaving the original unchanged.</p>
<p>You can use the accompanying templates <a href="../files/exercises/11-characters-strings/exercise_module1.f90">exercise_module1.f90</a>
and <a href="../files/exercises/11-characters-strings/exercise_program1.f90">exercise_program1.f90</a>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>A solution to the exercise can be found in <a href="../files/exercises/11-characters-strings/solutions/solution_program1.f90">solution_program1.f90</a>
and <a href="../files/exercises/11-characters-strings/solutions/solution_module1.f90">solution_module1.f90</a>.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>String-handling can be problematic if there is no mechanism to keep
track of the length of the string.</li>
<li>Remember that Fortran provides intrinsic functions such as
<code>trim()</code> and operators such as concatenation <code>//</code>
which can help with string manipulation.</li>
<li>Pay attention when using strings as dummy arguments or procedure
results.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-12-read-write"><p>Content from <a href="12-read-write.html">Formats and edit descriptors</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/12-read-write.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I read input from the keyboard to my program?</li>
<li>How can I control the format of input and output of various
types?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use the <code>read</code> statement analogously to
<code>write</code> to obtain input from the keyboard.</li>
<li>Learn how to combine edit descriptors to create a format
specifier.</li>
<li>Use format specifiers to control the appearance of output of the
various types we have encountered.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="input-and-output">Input and output<a class="anchor" aria-label="anchor" href="#input-and-output"></a>
</h2>
<hr class="half-width">
<p>So far we have seen only output (via either <code>print</code> or
<code>write</code>). Input is via the <code>read</code> statement.</p>
<pre><code>  use :: iso_fortran_env
  ...
  read (unit = input_unit, fmt = *) var-io-list</code></pre>
<p>In very many respects, <code>read</code> looks much like
<code>write</code>, in that it takes the same arguments, including unit
number and format specifier. However, whereas <code>write</code> may
have an I/O list involving expressions, <code>read</code> must have only
the variables which will store the incoming values.</p>
<p>The standard input unit (<code>input_unit</code> from
<code>iso_fortran_env</code> in the above) is typically the keyboard (or
“screen”) for interactive use.</p>
</section><section><h2 class="section-heading" id="format-specifier">Format specifier<a class="anchor" aria-label="anchor" href="#format-specifier"></a>
</h2>
<hr class="half-width">
<p>In addition to the <em>list-directed</em> or free-format
<code>*</code> specifier, a format may be a string literal, a fixed
character parameter, or a string constructed at run time. Some examples
are:</p>
<pre><code>   read (*, *) var             ! read using list-directed, or free format
   print '(a)', "A string"     ! character literal '(a)'
   write (*, myformat) var     ! character variable (or parameter)
   write(unit = myunit) var    ! unformatted (no format)</code></pre>
<p>Output with a format specifier, either string or <code>*</code>, is
referred to as <em>formatted</em> I/O. This is to distinguish it from
<em>unformatted</em> I/O; this is essentially a direct dump of the
binary internal representation. For unformatted I/O the format specifier
is simply omitted.</p>
<p>Binary output can have its uses, but more portable and flexible
methods of “fast” output are probably to be preferred (e.g., via a
library such as HDF5). We will not consider unformatted output any
further in this course.</p>
</section><section><h2 class="section-heading" id="edit-descriptors">Edit descriptors<a class="anchor" aria-label="anchor" href="#edit-descriptors"></a>
</h2>
<hr class="half-width">
<p>A format specifier consists of a comma-separated list of <em>edit
descriptors</em> enclosed in parentheses. The edit descriptors determine
how the internal representation of data is translated or converted to
characters which can be displayed.</p>
<p>The formal and exhaustive statement of exactly what is allowed in an
edit descriptor is rather, well, exhausting. It is easier to consider
some common examples of the three different types of descriptor.</p>
<div class="section level3">
<h3 id="data-edit-descriptors">Data edit descriptors<a class="anchor" aria-label="anchor" href="#data-edit-descriptors"></a>
</h3>
<p>Data edit descriptors feature a single character describing the type
data format wanted, and a literal integer part indicating the total
field width, and number of decimals. These include</p>
<pre><code>  iw        ! integer width w characters
  fw.d      ! floating point number total width w and d decimal characters
  ew.d      ! scientific notation with total width w and d decimal characters
  aw        ! character string total width w</code></pre>
<p>The width is the total width of the field, and must be wide enough to
accommodate any leading signs, decimal points, or exponents. Where there
is a <em>w.d</em> the <em>d</em> indicates the number of digits to
appear after the decimal point.</p>
<p>Data edit descriptors should correspond to the relevant item in the
<em>io-list</em>, based on position. Some simple examples are:</p>
<pre><code>  integer :: ivar = 40
  real    :: avar = 40.0
  print "(  i10)", ivar           ! produces "40" with 8 leading spaces
  print "(f10.3)", avar           ! produces "40.000" with 4 leading spaces
  print "(e10.3)", avar           ! produces "0.400e+02" with 1 leading space</code></pre>
<p>For scientific notation, the exponent will appear either with two
digits (“E+<em>dd</em>” or “E-<em>dd</em>”), or three digits for
exponents greater than 99 (“+<em>ddd</em>” or “-<em>ddd</em>”).</p>
<p>If a first significant digit is required before the decimal point in
scientific notation (instead of a zero) the <code>es</code> edit
descriptor can be used instead of <code>e</code>; otherwise it’s the
same.</p>
<p>An engineering edit descriptor <code>en</code> is available. It also
acts like a standard <code>e</code> descriptor, but exponents are
limited to a subset …,-3,0,+3,+6,…, corresponding to standard SI
prefixes milli-, kilo-, mega-, and so on. There will be an appropriate
movement in the decimal point.</p>
<p>If an exponent greater than 999 is required, an optional
<code>e</code> descriptor for the exponent itself is available:</p>
<pre><code>  print "(e14.3e4)", avar         ! Use at least 4 digits in exponent</code></pre>
<p>Note that an integer descriptor is allowed to be of the form
<em>iw.d</em>, in which case leading zeros are added to pad to the width
<em>w</em>, if required.</p>
</div>
<div class="section level3">
<h3 id="character-string-edit-descriptors">Character string edit descriptors<a class="anchor" aria-label="anchor" href="#character-string-edit-descriptors"></a>
</h3>
<p>One can use a string literal as part of the edit descriptor itself,
e.g.,</p>
<pre><code>  real :: avar = 4.0
  print "('This is the result: ', e14.7)", avar</code></pre>
</div>
<div class="section level3">
<h3 id="control-edit-descriptors">Control edit descriptors<a class="anchor" aria-label="anchor" href="#control-edit-descriptors"></a>
</h3>
<p>There are a number of these. They do not correspond to an item in the
<em>io-list</em>, but alter the appearance of the output. The most
common is <code>x</code> which introduces a space (or blank). E.g.,</p>
<pre><code>   print "(i12,x,e12.6)", ivar, avar</code></pre>
<p>This will ensure at least one space between the two items in the
list.</p>
<p>If a leading plus sign is wanted, use the <code>sp</code> control,
e.g.:</p>
<pre><code>  print "(sp,e12.6)", abs(avar)</code></pre>
</div>
<div class="section level3">
<h3 id="exercise-2-minutes">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes"></a>
</h3>
<div id="exercise-name" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercise-name" class="callout-inner">
<h3 class="callout-title">Exercise name</h3>
<div class="callout-content">
<p>Compile and run the accompanying <a href="../files/exercises/12-read-write/example1.f90">example1.f90</a>
program, which provides some specimen formats. Some of the format
specifiers have not been allowed a large enough width. What’s the
result? What’s the solution?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Using gfortran produces the following output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Format i10:            40
Format i10.10: 0000000040
Format l10:             F
Format f10.3:      40.000
Format e10.3:   0.400E+02
Format en10.3: 40.000E+00
Format a10:    Hello
Format i1:     *
Format f10.3:  **********
Format e10.3:   0.180+309
Others:
Format sp,e12.3:   +0.180+309
Format e12.3e4:   0.180E+0309</code></pre>
</div>
<p>Where the format specifiers are too narrow, the output is reduced to
asterisks <code>*</code> in the space that has been provided. To fix
this, the specifiers need to be widened. For example, the integer
specifier on line 25 is <code>i1</code>, clearly not enough to print
<code>-40.</code> Making it <code>i3</code> allows it to output.</p>
<p>The next failed output uses <code>f10.3</code>. It’s trying to print
a <code>huge()</code> number, where it was used to store the largest
possible number of the same type as the original <code>avar</code>. As a
<code>real64</code>, that’s approximately <code>1.80E+308</code>. The
format specifier provides a width of 10 characters to print a number
with 309 digits (although we only have precision in the first 15 or so).
The <code>f</code> format specifier is very definitely unsuitable; one
of the <code>e</code> types such as <code>es24.17</code> is much more
appropriate.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="repeat-counts">Repeat counts<a class="anchor" aria-label="anchor" href="#repeat-counts"></a>
</h2>
<hr class="half-width">
<p>For a larger number of items of the same type, it can be useful to
specify a <em>repeat count</em>. Simply place the items to be repeated
within parentheses and prefix a literal integer count to the format,
e.g.:</p>
<pre><code>   real, dimension(4) :: a = [ 1.0, 2.0, 3.0, 4.0]

   print "(4(2x,e14.7))", a(1:4)</code></pre>
<p>Multiple subformats are comma-separated, much like the individual
items, and subformats can also be nested. In this way, more complex
formats can be constructed.</p>
<div class="section level3">
<h3 id="complex-variables">Complex variables<a class="anchor" aria-label="anchor" href="#complex-variables"></a>
</h3>
<p>Variables of <code>complex</code> type are treated as two
<code>real</code> values for the purposes of a format specifier. The
real and imaginary part do not have to have the same edit
descriptor.</p>
</div>
<div class="section level3">
<h3 id="logical-variables">Logical variables<a class="anchor" aria-label="anchor" href="#logical-variables"></a>
</h3>
<p>A “safe” (portable) minimum width for an <code>l</code> (logical)
edit descriptor is 7 characters to accommodate “<code>.false.</code>”,
although some implementations may only produce an <code>F</code>.</p>
</div>
</section><section><h2 class="section-heading" id="new-lines">New lines<a class="anchor" aria-label="anchor" href="#new-lines"></a>
</h2>
<hr class="half-width">
<p>If no new line at all is wanted, one can use the
<code>advance = no</code> argument to <code>write()</code>, e.g.:</p>
<pre><code>  write (*, "('Input an integer: ')", advance = 'no')
  read (*, *) ivar</code></pre>
<p>Non-advancing output must not use list-directed I/O.</p>
</section><section><h2 class="section-heading" id="statement-labels">Statement labels<a class="anchor" aria-label="anchor" href="#statement-labels"></a>
</h2>
<hr class="half-width">
<p>Formally, a format specifier may also be a <em>statement label</em>.
For example,</p>
<pre><code>   write (unit = myunit, fmt = 100) ia, ib, c

100 format(i3, i3, f14.7)</code></pre>
<p>Here, the statement at the line with label <code>100</code> is the
<code>format</code> keyword, which may be used to define a format
specifier. This is very common in older forms of Fortran. However, as
the reference and the statement can become widely separated, this can be
troublesome. However, statement labels are useful in other contexts, as
we will see when we come to error handling.</p>
</section><section><h2 class="section-heading" id="exercise-5-minutes">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes"></a>
</h2>
<hr class="half-width">
<div id="experimenting-with-formats" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="experimenting-with-formats" class="callout-inner">
<h3 class="callout-title">Experimenting with formats</h3>
<div class="callout-content">
<p>Using the <a href="../files/exercises/12-read-write/example1.f90">example1.f90</a>
program, check what happens if there is a mismatch between the format
specifier and the data type in the I/O list. Choose an example, and run
the program.</p>
<p>What happens if the number of items in the io-list is larger than the
number of edit descriptors?</p>
<p>Additional exercise. The <code>b</code> edit descriptor can be used
to convert integer values to their binary representation. For a 32-bit
integer type, the recommended descriptor would be <code>b32.32</code> to
ensure the leading zeros are visible. You may wish to try this out.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Using the wrong type variable with a format specifier should still
allow the code to compile, but you will receive a runtime error when it
is encountered.</p>
<p>Any extra items in the io-list above what the format provides will
not be printed.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Control over the appearance of output is via the format specifier,
which is a string.</li>
<li>This similar in spirit to the format string provided to
<code>printf()</code> in C.</li>
<li>The use of a format allows predictable tabulation of output for
human readers.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-121-lunch"><p>Content from <a href="121-lunch.html">Lunch</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/121-lunch.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Break for lunch.</p></section><section id="aio-13-IO"><p>Content from <a href="13-IO.html">Operations on external files</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/13-IO.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I open and close files for input and output?</li>
<li>How do I handle any errors that might occur during I/O?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to open and close files for input and output using a unit
number.</li>
<li>Be able to read and write to an open file and handle errors that
might arise.</li>
<li>Move around an open file using <code>read</code> to move forwards
and <code>backspace()</code> and <code>rewind()</code> to move
back.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="operations-on-external-files">Operations on external files<a class="anchor" aria-label="anchor" href="#operations-on-external-files"></a>
</h2>
<hr class="half-width">
<p>Writing data to, or reading data from, an external file is an
essential part of a useful application.</p>
</section><section><h2 class="section-heading" id="writing-a-file">Writing a file<a class="anchor" aria-label="anchor" href="#writing-a-file"></a>
</h2>
<hr class="half-width">
<p>File handles, or <em>unit numbers</em> are obtained using
<code>open()</code>, and are used to direct the output of
<code>write()</code> to the relevant file.</p>
<pre><code>  integer :: myunit

  open(newunit = myunit, file = 'filename.dat', form = 'formatted', &amp;
       action = 'write', status = 'new')

  write(unit = myunit, *) data1    ! write data first record
  write(unit = myunit, *) data2    ! second record ... and so on

  close(unit = myunit, status = 'keep')</code></pre>
<p>To read back the same data, we might use:</p>
<pre><code>   open(newunit = myunit, file = 'filename.dat', form = 'formatted', &amp;
        action = "read", status = "old")

   read(unit = myunit, *) data1
   read(unit = myunit, *) data2

   close (unit = myunit, status = 'keep')</code></pre>
<div class="section level3">
<h3 id="unit-numbers">Unit numbers<a class="anchor" aria-label="anchor" href="#unit-numbers"></a>
</h3>
<p>A valid unit number can be assigned by using the <code>newunit</code>
option to <code>open()</code> – this has been available since Fortran
2008. There is no need to choose your own (and it can be error-prone to
do so).</p>
<p>Note that a given file can only be <em>connected</em> to one unit
number at any given time.</p>
</div>
<div class="section level3">
<h3 id="open">
<code>open()</code><a class="anchor" aria-label="anchor" href="#open"></a>
</h3>
<p>The arguments seen above include:</p>
<ul>
<li>
<code>file</code>: literal string or character variable or
expression with the name of the file in the file system;</li>
<li>
<code>form</code>: <code>formatted</code> or
<code>unformatted</code>;</li>
<li>
<code>action</code>: <code>read</code>, <code>write</code> or
<code>readwrite</code>. An error may occur if inappropriate actions are
performed;</li>
<li>
<code>status</code>: one of <code>old</code>, <code>new</code>,
<code>replace</code>, <code>scratch</code>, or
<code>unknown</code>.</li>
</ul>
<p>A file with status <code>old</code> is expected to exist, while an
attempt to create a <code>new</code> file when one already exists with
the same name will result in an error. If <code>replace</code> is
specified, any existing file will be overwritten by a new file. If
<code>scratch</code> is specified, a temporary file is created which
will be deleted when <code>close()</code> is executed (or at the end of
the program). The system will automatically choose a name for a scratch
file if no <code>file</code> argument is present. The default status is
<code>unknown</code>, which means the status is system dependent.</p>
<p>Formally, only the unit number is mandatory (and must appear first),
but there is no reason not to provide as much information as
possible.</p>
</div>
<div class="section level3">
<h3 id="close">
<code>close()</code><a class="anchor" aria-label="anchor" href="#close"></a>
</h3>
<p>The unit number is again mandatory. The <code>status</code> is either
<code>keep</code> or <code>delete</code>. If the status is omitted, the
default is <code>keep</code>, except for scratch files.</p>
</div>
</section><section><h2 class="section-heading" id="inquire">
<code>inquire()</code><a class="anchor" aria-label="anchor" href="#inquire"></a>
</h2>
<hr class="half-width">
<p>The <code>inquire</code> statement offers a way to obtain information
on the current state of either unit numbers or files. There are a large
number of optional arguments. One common usage is to check whether a
file exists:</p>
<pre><code><span>  <span class="fu">logical</span> <span class="fu">::</span> <span class="va">exists</span></span>
<span>  <span class="fu">inquire</span><span class="op">(</span> file <span class="op">=</span> <span class="st">'filename.dat'</span>, exist <span class="op">=</span> <span class="va">exists</span><span class="op">)</span></span></code></pre>
</section><section><h2 class="section-heading" id="internal-files">Internal files<a class="anchor" aria-label="anchor" href="#internal-files"></a>
</h2>
<hr class="half-width">
<p>In some situations, it may be convenient to use a formatted read to
generate a new string in memory (in the same way as <code>sprintf</code>
in C). Fortran uses a so-called <em>internal file</em>, which is usually
a character string. E.g.,</p>
<pre><code>   character (len = 10) :: buffer
   integer              :: ival
   ...
   read(buffer, fmt = "i10") ival</code></pre>
<p>Here <code>buffer</code> takes the place of the input unit. This can
be used, e.g., to create format strings at run time.</p>
</section><section><h2 class="section-heading" id="recovery-from-errors">Recovery from errors<a class="anchor" aria-label="anchor" href="#recovery-from-errors"></a>
</h2>
<hr class="half-width">
<p>Operations on external files can be error-prone. While there is no
formal exception mechanism in Fortran, some ability to recover is
available.</p>
<p>Consider the following schematic example:</p>
<pre><code>subroutine read_my_file_format(myunit, ..., ierr)

  integer, intent(in)   :: myunit
  integer, intent(out)  :: ierr          ! error code

  character (len = 256) :: msg

  read (myunit, ..., err = 999, iomsg = msg) ...

  ! Everything was ok
  ierr = 0
  return

999 continue
  ierr = -1
  print *, "Error reading file: ", trim(msg)

  return
end subroutine real_my_file_format</code></pre>
<p>We assume the relevant file has been opened successfully, and is
connected to unit number <code>myunit</code>. If an error occurs at the
point of the read statement, the <code>err</code> argument directs
control to be transferred to the statement will label <code>999</code>.
In this case the system should provide a meaningful message describing
the error.</p>
<p>If the read is successful, the routine completes at the first return
statement with intent out <code>ierr = 0</code>.</p>
<div class="section level3">
<h3 id="error-handling-for-open-and-close">Error handling for <code>open()</code> and <code>close()</code>
<a class="anchor" aria-label="anchor" href="#error-handling-for-open-and-close"></a>
</h3>
<p>Both <code>open</code> and <code>close</code> statements provide
optional arguments for error handling, illustrated schematically here
with <code>open()</code>:</p>
<pre><code>  integer :: ierr
  character (len = 128) :: msg

  open( newunit = myunit, ..., err = 900, iostat = ierr, iomsg = msg)</code></pre>
<ul>
<li>
<code>err</code>: is a label in the same scope to which control is
transferred on error;</li>
<li>
<code>iostat</code>: an integer variable which is zero on success
but positive if an error has occurred;</li>
<li>
<code>iomsg</code>: if an error occurs, a system-dependent message
will be assigned to <code>msg</code>.</li>
</ul>
<p>If neither <code>err</code> nor <code>iostat</code> arguments are
present, then an error may result in immediate termination of the
program.</p>
<p>The variable <code>msg</code> should be a scalar character variable;
the message will be truncated or padded appropriately.</p>
</div>
<div class="section level3">
<h3 id="error-handling-for-read-and-write">Error handling for <code>read()</code> and <code>write()</code>
<a class="anchor" aria-label="anchor" href="#error-handling-for-read-and-write"></a>
</h3>
<p>Error handling facilities for <code>read()</code> and
<code>write()</code> are similar, and are illustrated here:</p>
<pre><code>  write (myunit, myformat, end = 999, err = 998, iostat = ierr, iomsg = msg) ..</code></pre>
<ul>
<li>
<code>end</code>: label in same scope to which control is
transferred on end-of-file;</li>
<li>
<code>err</code>: label in same scope to which control is
transferred on any other error; the label may be the same as
<code>end</code>;</li>
<li>
<code>iostat</code>: the integer error code is negative if
end-of-record or end-of-file, or positive if another error (e.g., bad
format conversion) or zero on success;</li>
<li>
<code>iomsg</code>: should return a useful message on error.</li>
</ul>
<p>The two negative <code>iostat</code> cases can be distinguished via
calls to the intrinsic functions</p>
<pre><code><span>  <span class="fu">is_iostat_end</span><span class="op">(</span><span class="va">ierr</span><span class="op">)</span></span>
<span>  <span class="fu">is_iostat_eor</span><span class="op">(</span><span class="va">ierr</span><span class="op">)</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="stop-statement">
<code>stop</code> statement<a class="anchor" aria-label="anchor" href="#stop-statement"></a>
</h2>
<hr class="half-width">
<p>If one really can’t continue, then execution can be terminated
immediately via the <code>stop</code> statement. This has an optional
message string argument.</p>
<pre><code>  stop "Cannot continue"</code></pre>
<p>In general one should try to recover by returning control to the
caller, so <code>stop</code> is a last resort.</p>
</section><section><h2 class="section-heading" id="moving-around-an-open-file">Moving around an open file<a class="anchor" aria-label="anchor" href="#moving-around-an-open-file"></a>
</h2>
<hr class="half-width">
<p>It is sometimes useful to be able to reposition oneself in an open
file so that a given record can be read (or written) more than once.
This can be done using <code>backspace()</code> with the relevant unit
number. Formally</p>
<pre><code>  backspace([unit = ] unit-number [, iostat = iostat] [, err = label])</code></pre>
<p>This steps back one record.</p>
<p>It is also possible to reposition to the beginning of the file, again
with the relevant connected unit number using <code>rewind()</code>.</p>
<pre><code>  rewind([unit = ] unit-number [, iostat = iostat] [, err = label])</code></pre>
</section><section><h2 class="section-heading" id="exercise-20-minutes">Exercise (20 minutes)<a class="anchor" aria-label="anchor" href="#exercise-20-minutes"></a>
</h2>
<hr class="half-width">
<div id="writing-a-simple-image" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="writing-a-simple-image" class="callout-inner">
<h3 class="callout-title">Writing a simple image</h3>
<div class="callout-content">
<p>Portable bit map (PBM, PGM, PPM) is a very simple image format which
can be expressed as an ASCII file. See the description at <a href="https://en.wikipedia.org/wiki/Netpbm" class="external-link">Wikipedia</a>.</p>
<p>In the template <a href="../files/exercises/13-IO/program1.f90">program1.f90</a>, we establish
a two-dimensional logical array of a fixed size, and we want to write
out a file that can be viewed in “P1” format (file extension
<code>.pbm</code> ) by an image viewer.</p>
<p>The data is initialised with a suitable pattern to check that the
image is correct (it is the right way up and is not a mirror). A little
care is required in the rows and columns (look closely at the
example).</p>
<p>Provide a module with the subroutine <code>write_pbm()</code> with
three arguments as in the template program. Note the template program
expects a module <code>solution_module</code>.</p>
<p>Additional exercises: repeat for integer data (to “P2” format
<code>.pgm</code>) and floating point data (to “P3” format
<code>.ppm</code>).</p>
<p>You can check any image you produce by either downloading it to your
machine with <code>scp</code> or <code>rsync</code>, or you can view it
directly on ARCHER2 by logging in with X11 forwarding enabled, running
<code>module load imagemagick</code> and then
<code>display test49.pbm</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>A <a href="../files/exercises/18-further-functions/pbm_image.f90">solution</a>
to this problem appears in the later <a href="18-further-functions.html">episode on interfaces</a>.</p>
<p>You should be able to produce an output PBM that looks like the
example shown below.</p>
<figure><img src="../fig/test49-pbm.png" alt="Sample PBM output." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Writing data to, or reading data from, an external file is an
essential part of a useful application.</li>
<li>Unit numbers are integers which are used as handles to open
files.</li>
<li>Errors from I/O can be handled with labels and by examining the
returned message.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-14-namelists"><p>Content from <a href="14-namelists.html">Using namelists</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/14-namelists.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a namelist?</li>
<li>How can I use a namelist to read and write grouped data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand what a namelist is and how to create declare one.</li>
<li>Be able to read and write namelists from file.</li>
<li>Understand how namelists store structured data such as arrays and
derived types.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="fortran-namelists">Fortran namelists<a class="anchor" aria-label="anchor" href="#fortran-namelists"></a>
</h2>
<hr class="half-width">
<p>Fortran supports a special form of file I/O called namelists which
enable the grouping of variables for reading and writing.</p>
</section><section><h2 class="section-heading" id="the-namelist-specification">The namelist specification<a class="anchor" aria-label="anchor" href="#the-namelist-specification"></a>
</h2>
<hr class="half-width">
<p>The namelist associates a name with a list of variables. The namelist
is declared using a <code>namelist</code> construct which takes the
form</p>
<pre><code><span>  <span class="va">namelist</span> <span class="op">/</span><span class="va">namelist</span><span class="op">-</span><span class="va">group</span><span class="op">-</span><span class="va">name</span><span class="op">/</span> <span class="va">variable</span><span class="op">-</span><span class="va">name</span><span class="op">-</span><span class="va">list</span></span></code></pre>
<p>where the <code>namelist-group-name</code> is surrounded by forward
slashes <code>/</code> and the <code>variable-name-list</code> is a
comma separated list of variables, e.g.:</p>
<pre><code>  integer :: a, b, c
  namelist /ints/ a, b, c</code></pre>
</section><section><h2 class="section-heading" id="namelists-in-a-file">Namelists in a file<a class="anchor" aria-label="anchor" href="#namelists-in-a-file"></a>
</h2>
<hr class="half-width">
<p>A namelist file is plain text and may contain one or more namelists.
Each of these is begun by <code>&amp;namelist-group-name</code> and
terminated by <code>/</code>. Variable-value assignments occur in the
body of the <code>namelist</code>, e.g. the file may contain</p>
<pre><code>&amp;ints
a = 1
b = 2
c = 3
/</code></pre>
<p>The ordering of variables in the namelist does not matter, so the
previous example could also have been written as</p>
<pre><code>&amp;ints
c = 3
a = 1
b = 2
/</code></pre>
</section><section><h2 class="section-heading" id="reading-a-namelist">Reading a namelist<a class="anchor" aria-label="anchor" href="#reading-a-namelist"></a>
</h2>
<hr class="half-width">
<p>A common usecase for namelists is to specify parameters for a program
at runtime. For example a simulation code might read its configuration
from a namelist called <code>run</code> as follows:</p>
<pre><code>&amp;run
name = "TGV" ! Case name
nsteps = 100 ! Number of timesteps
dt = 0.1     ! Timestep
/</code></pre>
<p>As you can see, an extra nice feature of namelists is their support
for comments using the same <code>!</code> character as in Fortran
code.</p>
<p>To read the namelist from a file, the
<code>namelist-group-name</code> is passed as the argument to
<code>read()</code>, so in order to read this <code>run</code> namelist
we might do the following:</p>
<pre><code>  integer :: myunit
  character(len=:) :: name
  integer :: nsteps
  real :: dt

  namelist /run/ name, nsteps, dt

  open(newunit = myunit, file = 'config', action = 'read', status = 'old')
  read(myunit, run)
  close(myunit)</code></pre>
<p>Note that any variables not set in the <code>namelist</code> file
will retain their initial values.</p>
<div class="section level3">
<h3 id="exercise-5-minutes">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes"></a>
</h3>
<div id="reading-a-namelist-from-file" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="reading-a-namelist-from-file" class="callout-inner">
<h3 class="callout-title">Reading a namelist from file</h3>
<div class="callout-content">
<p>Using <a href="../files/exercises/14-namelists/namelist-read.f90">namelist-read.f90</a>,
confirm that the runtime values can be specified by changing the
contents of the namelist in <a href="../files/exercises/14-namelists/config.nml">config.nml</a>. Modify
the program to specify a default value for <code>dt</code> and confirm
that <code>dt</code> retains its value unless otherwise set in the
<code>namelist</code>.</p>
<p>What happens if the value set is not of the same type as the variable
specification in the program?</p>
<p>What happens if you add an unexpected value to the namelist?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>If the value in the namelist is not of the same type as the program’s
variable, you will receive an error stating that it is mismatched.</p>
<p>Any unexpected values will also trigger an error stating that the
namelist object cannot be matched to a variable.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="reading-multiple-namelists">Reading multiple namelists<a class="anchor" aria-label="anchor" href="#reading-multiple-namelists"></a>
</h3>
<p>As stated earlier, we can have multiple namelists within a single
file. Continuing with our simulation example we might additionally want
to specify some numerical schemes for the simulation, e.g. adding the
<code>schemes</code> namelist:</p>
<pre><code>&amp;run
name = "TGV" ! Case name
nsteps = 100 ! Number of timesteps
dt = 0.1     ! Timestep
/

&amp;schemes
advection = "upwind"  ! Advection scheme
diffusion = "central" ! Diffusion scheme
transient = "RK3"     ! Timestepping scheme
/</code></pre>
<p>We can read the values for each of these namelists as outlined
previously, but note, however that the order of the namelists themselves
is important. After reading a namelist the file reader will be
positioned at its end, and trying to read a namelist that occurred
previously in the file will fail. Either the reading subroutine must
match the order of the namelists which occur in the file or file motion
calls such as <code>rewind()</code> should be used to ensure that
reading is independent of order.</p>
</div>
<div class="section level3">
<h3 id="exercise-5-mins">Exercise (5 mins)<a class="anchor" aria-label="anchor" href="#exercise-5-mins"></a>
</h3>
<div id="reading-multiple-namelists-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="reading-multiple-namelists-1" class="callout-inner">
<h3 class="callout-title">Reading multiple namelists</h3>
<div class="callout-content">
<p>Extend the example program <a href="../files/exercises/14-namelists/namelist-read.f90">namelist-read.f90</a>
to read the numerical <code>schemes</code> namelist from <a href="../files/exercises/14-namelists/config-full.nml">config-full.nml</a>.</p>
<p>(Optional) Ensure that your program can read the <code>run</code>
configuration and the numerical <code>schemes</code> regardless of the
order in which they appear.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Add some <code>character</code> variables to store the items from the
<code>schemes</code> namelist, declare the namelist itself with those
variables, then, after reading the <code>run</code> namelist, read
<code>schemes</code>. To make sure it can read the two schemes in any
order, do a <code>rewind(nmlunit)</code> in between them. This way, you
read through to the first namelist, reset position to the start, then
read through to the second.</p>
<p>If they are in the wrong order and you don’t do this, you will
encounter an end of file error.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="writing-a-namelist">Writing a namelist<a class="anchor" aria-label="anchor" href="#writing-a-namelist"></a>
</h2>
<hr class="half-width">
<p>Writing a namelist works similarly to reading one. With an open file,
or other output device, passing the namelist as the argument to
<code>write()</code> will write the namelist to the file.</p>
<pre><code>  integer :: myunit
  integer :: a, b, c
  namelist /ints/ a, b, c

  a = 1
  b = 2
  c = 3

  open(newunit = myunit, file = 'output.nml', action = 'write', status = 'new')
  write(myunit, ints)
  close(myunit)</code></pre>
<p>will output the following to the new file
<code>output.nml</code>:</p>
<pre><code>&amp;INTS
 A=1          ,
 B=2          ,
 C=3          ,
 /</code></pre>
<div class="section level3">
<h3 id="exercise-10-minutes">Exercise (10 minutes)<a class="anchor" aria-label="anchor" href="#exercise-10-minutes"></a>
</h3>
<div id="writing-namelists-to-file" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="writing-namelists-to-file" class="callout-inner">
<h3 class="callout-title">Writing namelists to file</h3>
<div class="callout-content">
<p>Write a program to write the simulation parameters as a namelist so
that it can be read by the previous example program.</p>
<p>(Optional) If you completed the extension to read the namelists in
any order, confirm that this works with your new program when writing in
any order.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>A solution writing the <code>run</code> namelist can be found in <a href="../files/exercises/14-namelists/solutions/namelist-write.f90">namelist-write.f90</a>.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="handling-complex-data">Handling complex data<a class="anchor" aria-label="anchor" href="#handling-complex-data"></a>
</h2>
<hr class="half-width">
<p>So far we have only considered simple scalars and strings, but
namelists also support I/O of more complex data structures such as
arrays or user-defined types. These are handled similarly to the code we
have seen so far.</p>
<div class="section level3">
<h3 id="exercise-10-minutes-1">Exercise (10 minutes)<a class="anchor" aria-label="anchor" href="#exercise-10-minutes-1"></a>
</h3>
<div id="writing-complex-data-to-namelists" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="writing-complex-data-to-namelists" class="callout-inner">
<h3 class="callout-title">Writing complex data to namelists</h3>
<div class="callout-content">
<p>An example program <a href="../files/exercises/14-namelists/namelist-complex.f90">namelist-complex.f90</a>
is provided to write more complex data structures to a namelist. Try
running this program and inspecting the output to see how these data
structures are represented.</p>
<p>Modify the program to read the namelist back into data and confirm
that the data is correct, for example by testing array elements match
their expected values.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Namelists are declared using the
<code>namelist /namelist-group-name/ variable-name-list</code>
construct.</li>
<li>Read and write namelists by passing them directly to the
<code>read</code> and <code>write</code> statements.</li>
<li>Remember that namelists cannot be read out of order from a file
without first moving backwards through the file.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-141-break"><p>Content from <a href="141-break.html">Break</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/141-break.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Comfort break.</p></section><section id="aio-15-exercise"><p>Content from <a href="15-exercise.html">Exercises</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/15-exercise.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are some problems I can work on?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Continue to work on exercises from taught material and the larger
two problems from yesterday.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We will use the rest of today to work on any of the taught exercises
you would like to spend more time on, as well as the tri-diagonal and
Game of Life exercises from <a href="07-exercise.html">yesterday
afternoon’s session</a> .</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Gain more experience putting your new knowledge to use.</li>
</ul>
</div>
</div>
</div></section><section id="aio-16-data-structures"><p>Content from <a href="16-data-structures.html">Structures: derived types</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/16-data-structures.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I group together variables to make more complex
structures?</li>
<li>How are these derived types defined and then initialised?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand what a derived type is.</li>
<li>Learn how to define a derived type.</li>
<li>Learn the different ways of initialising a derived type
variable.</li>
<li>Get a glimpse of more advanced object oriented methodology.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="derived-types">Derived types<a class="anchor" aria-label="anchor" href="#derived-types"></a>
</h2>
<hr class="half-width">
<p>We have seen intrinsic types, such as <code>integer</code> and
<code>character</code>. However, in many cases it can be useful to
create structured types combining multiple types together in some way of
our choosing. We call these <em>derived types</em>.</p>
</section><section><h2 class="section-heading" id="type-definitions">Type definitions<a class="anchor" aria-label="anchor" href="#type-definitions"></a>
</h2>
<hr class="half-width">
<p>A derived type with two <em>components</em> would be declared,
e.g.,</p>
<pre><code>  type :: my_type
    integer                         :: nmax
    real, dimension(:), allocatable :: data
  end type my_type</code></pre>
<p>Components may be intrinsic data types (all declared in the usual
way), or derived types.</p>
<p>A variable of this type is declared</p>
<pre><code>  type (my_type) :: var</code></pre>
<p>and individual components are referenced with the component selector
<code>%</code>, e.g.,</p>
<pre><code>  var%nmax = 10
  ...
  print *, "Values are ", var%data(1:3)</code></pre>
<p>The component selector is the same as we have seen earlier for the
complex intrinsic type – recall that the real and imaginary components
of a complex variable <code>z</code> are accessed with <code>z%re</code>
and <code>z%im</code> respectively.</p>
<p>An array of types is defined in the usual way, and the component
selector is applied to individual elements, e.g.,</p>
<pre><code>  type (my_type), dimension(10) :: var
  ...
  var(1)%nmax = 100</code></pre>
<p>Dummy arguments to procedures are declared in the same way as for
intrinsic types with the appropriate attribute list, including
intent.</p>
<div class="section level3">
<h3 id="put-type-definitions-in-a-module">Put type definitions in a module<a class="anchor" aria-label="anchor" href="#put-type-definitions-in-a-module"></a>
</h3>
<p>If a type definition is placed in the specification part of a module,
it can be made available consistently elsewhere via use association.</p>
<p>Some derived type features <em>require</em> that the definition be in
a module.</p>
</div>
<div class="section level3">
<h3 id="scope-of-components">Scope of components<a class="anchor" aria-label="anchor" href="#scope-of-components"></a>
</h3>
<p>Formally, we have</p>
<pre><code>  type [ [, attribute-list] :: ] type-name
    [private]
    component-part
  [ contains
    procedure-part ]
  end type [ type-name ]</code></pre>
<p>The default situation is for both the type and its components to be
public. This may be made explicit by</p>
<pre><code>  type, public :: my_type
    ...
  end type my_type</code></pre>
<p>If one wants a public type with private components (an opaque type),
use</p>
<pre><code>  type, public :: my_opaque_type
    private
    ...
  end type my_opaque_type</code></pre>
<p>Externally, other program units will be able to reference this opaque
type, but will not be allowed to access the components (a compiler
error).</p>
<p>If a type is only for use within the module in which it is defined,
then it can be declared <code>private</code> in the attribute list.</p>
</div>
<div class="section level3">
<h3 id="type-constructors">Type constructors<a class="anchor" aria-label="anchor" href="#type-constructors"></a>
</h3>
<p>For types with public components, it is possible to use a structure
constructor to provide initialisation, e.g.,:</p>
<pre><code>  type, public :: my_type
     integer :: ia
     real    :: b
     complex :: z
  end type my_type

  ...
  type (my_type) :: a

  a = my_type(3, 2.0, (0.0, 1.0))</code></pre>
<p>Values or expressions can be used, but must appear in the order
specified in the definition of the components. An allocatable or pointer
(next episode) component must appear as <code>null()</code> in a
constructor expression list.</p>
</div>
<div class="section level3">
<h3 id="default-initialisation">Default initialisation<a class="anchor" aria-label="anchor" href="#default-initialisation"></a>
</h3>
<p>A type may be defined with default initial values. One notable
exception is that allocatable components do not have an initialisation.
E.g.:</p>
<pre><code>  type :: my_type
    integer                            :: nmax = 10
    real                               :: a0 = 1.0
    integer, dimension(:), allocatable :: ndata
  end type</code></pre>
<p>A default initialisation can be applied by using an empty
constructor::</p>
<pre><code>  type (my_type) :: a

  a = my_type()</code></pre>
<p>For an allocatable component, the result is a component with a not
allocated status.</p>
<p>Warning: some compilers can’t manage an empty constructor for
allocatable components. The appropriate expression in the constructor is
<code>null()</code>.</p>
</div>
<div class="section level3">
<h3 id="exercise-5-minutes">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes"></a>
</h3>
<div id="a-type-to-store-a-random-number-generator" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="a-type-to-store-a-random-number-generator" class="callout-inner">
<h3 class="callout-title">A type to store a random number generator</h3>
<div class="callout-content">
<p>The accompanying example (<a href="../files/exercises/16-data-structures/module1.f90">module1.f90</a>
and <a href="../files/exercises/16-data-structures/program1.f90">program1.f90</a>)
provides an implementation of a very simple pseudo-random number
generator. This is a so-called <a href="https://en.wikipedia.org/wiki/Linear_congruential_generator" class="external-link">linear
congruential generator</a>.</p>
<p>The module provides a derived type to aggregate the multiplier
<code>a</code>, the seed or state <code>s</code>, the increment
<code>c</code> and the modulus <code>m</code>. These have some default
values. Practical implementations often choose <code>c = 0</code>.</p>
<p>Compile the program, and check the first few numbers returned in the
sequence. The key to obtaining acceptable statistics is to identify some
appropriate values of <code>a</code> and <code>m</code> (e.g., those
given in the default).</p>
<p>Check you can introduce some new values of <code>a</code> and
<code>m</code> using the structure constructor (a spectacularly bad
choice is suggested in the code).</p>
<p>What happens if you make the components of the type
<code>private</code>? What would you then have to provide to allow
initialisation?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Running the code as provided gives the following output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> Step  1,  45991
 Step  2,  2115172081
 Step  3,  17451818
 Step  4,  1615161307
 Step  5,  1424320507
 Step  6,  1230752996</code></pre>
</div>
<p>Changing to use the suggested bad RNG values means doing</p>
<pre class="source"><code>type (my_rng) :: rng = my_rng(1, 1, 0, 2147483647)</code></pre>
<p>and this produces the following output (note Cray Fortran being
helpful with the first line)</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> Step  2*1
 Step  2,  1
 Step  3,  1
 Step  4,  1
 Step  5,  1
 Step  6,  1</code></pre>
</div>
<p>Making the RNG type’s components private means doing:</p>
<pre class="source"><code>  type, public :: my_rng
    private
    integer (int64) :: a = 45991
    integer (int32) :: s = 1
    integer (int64) :: c = 0
    integer (int64) :: m = 2147483647
  end type my_rng</code></pre>
<p>Trying to compile the program while setting the <code>a</code> etc.
values will cause a compiler error; those components are no longer
public, and the compiler knows it shouldn’t touch them. If we wanted to
change those values while <code>my_rng</code> opaque, we’d need to write
another module procedure to do so.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="default-inputoutput-for-derived-types">Default input/output for derived types<a class="anchor" aria-label="anchor" href="#default-inputoutput-for-derived-types"></a>
</h2>
<hr class="half-width">
<p>List-directed output for derived types can be used to provide a
default output in which each component appears in order,
schematically:</p>
<pre><code>  type (my_type) :: a
  ...
  write (*, fmt = *) a
  write (*, fmt = *) a%component1, a%component2, ...</code></pre>
<p>or one can apply a specific format to correspond to the known type
components.</p>
<div class="section level3">
<h3 id="non-default-output">Non-default output<a class="anchor" aria-label="anchor" href="#non-default-output"></a>
</h3>
<p>Fortran does have a facility to allow the programmer to override the
default behaviour of the formatting when a derived type appears in an
io-list.</p>
<p>A special <code>dt</code> editor descriptor exists, of the form:</p>
<pre><code><span>  <span class="va">dt</span><span class="op">[</span><span class="va">iodesc</span><span class="op">-</span><span class="va">string</span><span class="op">]</span><span class="op">[</span><span class="op">(</span><span class="va">v</span><span class="op">-</span><span class="va">list</span><span class="op">)</span><span class="op">]</span></span></code></pre>
<p>For example we may have</p>
<pre><code>  dt" my-type: "(2,14)</code></pre>
<p>The <em>iodesc-string</em> and <em>v-list</em> will re-appear as
arguments to a special function which must be provided by the
programmer. Information on this function is provided as part of the
<em>procedure-part</em> of the type definition:</p>
<pre><code>type, public :: my_type
  integer :: n
  complex :: z
contains
  procedure :: my_type_write_formatted
  generic   :: write(formatted) =&gt; my_type_write_formatted
end type my_type</code></pre>
<p>The following module subroutine should then be provided:</p>
<pre><code>  subroutine my_type_write_formatted(self, unit, iotype, vlist, iostat, iomsg)

    class (my_type),     intent(in)    :: self
    integer,             intent(in)    :: unit
    character (len = *), intent(in)    :: iotype       ! "DT my-type: "
    integer,             intent(in)    :: vlist(:)     ! (2,14)
    integer,             intent(out)   :: iostat
    character (len = *), intent(inout) :: iomsg

    ! ... process arguments to give required output to unit number ...
    ! iotype is "LISTDIRECTED" for list directed io
    ! iotype is "DTdesc-string" for dt edit descriptor
    ! ...
    ! ... write (unit = unit, fmt = ...)  self%n, self%z

    ! iostat and iomsg should be set if there is an error

  end subroutine my_type_write_formatted</code></pre>
</div>
<div class="section level3">
<h3 id="exercise-15-minutes">Exercise (15 minutes)<a class="anchor" aria-label="anchor" href="#exercise-15-minutes"></a>
</h3>
<div id="a-tri-diagonal-structure" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="a-tri-diagonal-structure" class="callout-inner">
<h3 class="callout-title">A tri-diagonal structure</h3>
<div class="callout-content">
<p>In the earlier <a href="10-dummy-array-arguments.html">material on
using arrays as dummy arguments</a> we implemented the tri-diagonal
solver as a module procedure. Implement a derived type to hold the
relevant data for the tri-diagonal matrix, ie., at least the three
diagonals.</p>
<p>Define a function which returns a fully initialised matrix type based
on arrays holding the three diagonals. Refactor the solver routine to
use the new matrix type.</p>
<p>Additional exercise: A very simple tridiagonal matrix may have all
diagonal elements the same, and all off-diagonal elements the same.
Write an additional function to initialise such a matrix from two scalar
values.</p>
<p>A template for the exercise can be found in <a href="../files/exercises/16-data-structures/exercise_program.f90">exercise_program.f90</a>
and <a href="../files/exercises/16-data-structures/exercise_module.f90">exercise_module.f90</a>;
or you can use your own version that you have been developing to this
point.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Your new tri-diagonal matrix type should look something like
this:</p>
<pre class="source"><code>  type, public :: tri_matrix
    integer :: nmax
    real (mykind), dimension(:), allocatable :: a     ! lower (2:nmax)
    real (mykind), dimension(:), allocatable :: b     ! diag (1:nmax)
    real (mykind), dimension(:), allocatable :: c     ! upper (1:nmax-1)
  end type tri_matrix</code></pre>
<p>Implementations of the solution are available in <a href="../files/exercises/16-data-structures/solutions-1/solution_program.f90">solution_program.f90</a>
and <a href="../files/exercises/16-data-structures/solutions-1/solution_module.f90">solution_module.f90</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="exercise-optional">Exercise (optional)<a class="anchor" aria-label="anchor" href="#exercise-optional"></a>
</h3>
<div id="formats-for-derived-types" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="formats-for-derived-types" class="callout-inner">
<h3 class="callout-title">Formats for derived types</h3>
<div class="callout-content">
<p>Try implementing the generic <code>write(formatted)</code> function
for the following type:</p>
<pre><code>  type, public :: my_date
    integer :: day = 1        ! day 1-31
    integer :: month = 1      ! month 1-12
    integer :: year = 1900    ! year
  end type my_date</code></pre>
<p>The format we would like is <code>dd/mm/yyyy</code> e.g,
<code>01/12/1999</code> for 1st December 1999 for list directed I/O.
Then try the <code>dt</code> edit descriptor to allow some more
flexibility.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>A suggested implementation of the solution is available in <a href="../files/exercises/16-data-structures/solutions-2/date_program.f90">date_program.f90</a>
and <a href="../files/exercises/16-data-structures/solutions-2/date_module.f90">date_module.f90</a>.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>The ability to aggregate related data in a structure is
important.</li>
<li>Fortran offers the <code>_derived type_</code> in addition to
intrinsic types.</li>
<li>In its simplest form, one may think of this as the analogue to a C
<code>struct</code>.</li>
<li>Derived types also form the basis of aggregation of data and related
operations or procedures (viz. object-oriented programming); however,
this introductory course will only touch on this feature.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-17-pointers"><p>Content from <a href="17-pointers.html">Pointers and targets</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/17-pointers.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I use a pointer to reference another variable?</li>
<li>Can I alias variable names?</li>
<li>Can I change the sizes of allocatable arrays?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to create pointers, targets, and how to associate the
two to create references.</li>
<li>Learn how to use an <code>associate</code> block to provide aliases
to variables.</li>
<li>Learn how to efficiently reallocate storage for an allocatable array
if its size needs to be changed.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="pointer-attribute">Pointer attribute<a class="anchor" aria-label="anchor" href="#pointer-attribute"></a>
</h2>
<hr class="half-width">
<p>A pointer may be declared by adding the <code>pointer</code>
attribute to the relevant data type, e.g.,</p>
<pre><code>integer, pointer :: p =&gt; null()</code></pre>
<p>In this case we declare a pointer to integer <code>p</code>, which is
initialised to the special value <code>null()</code>. The pointer is
said to be <em>unassociated</em>. This is a different state to
<em>undefined</em> (i.e., without initialisation).</p>
<p>Note that pointer assignment uses <code>=&gt;</code> and not
<code>=</code>. A common cause of errors is to forget the
<code>&gt;</code> if pointer assignment is intended.</p>
<p>It is important to be able to check that a given pointer is not
<code>null()</code>. This is done with the <code>associated()</code>
intrinsic; schematically,</p>
<pre><code>   integer, pointer :: p =&gt; null()
   ...
   if (associated(p)) ... do something</code></pre>
<p>If a pointer is not initialised as pointing to a target variable, it
should be initialised with <code>null()</code> to avoid undefined
behaviour when testing with <code>associated()</code>. Pointers may
otherwise be used in expressions and assignments in the usual way.</p>
<p>If one wishes to have a pointer to an array, the rank of the pointer
should be the same as the target:</p>
<pre><code>  real, dimension(:),   pointer :: p1
  real, dimension(:,:), pointer :: p2</code></pre>
<p>and so on.</p>
</section><section><h2 class="section-heading" id="targets">Targets<a class="anchor" aria-label="anchor" href="#targets"></a>
</h2>
<hr class="half-width">
<p>A pointer may be associated with another variable of the appropriate
type (which is not itself a pointer) by using the target attribute:</p>
<pre><code>  integer, target  :: datum
  integer, pointer :: p

  p =&gt; datum</code></pre>
<p>The pointer is now said to be associated with the target. We can now
perform operations on <code>datum</code> vicariously through
<code>p</code>. E.g., a standard assignment would be</p>
<pre><code>  integer, target  :: datum = 1
  integer, pointer :: p

  p =&gt; datum     ! pointer assignment
  p = 2          ! normal assignment</code></pre>
<p>leaves us with <code>datum = 2</code>. There is no dereferencing in
the C fashion; the data is moved as the result of the normal
assignment.</p>
<p>The target attribute is there to provide information to the compiler
about which variables may be, and which variables may not be, associated
with a pointer. This somewhat in the same spirit as the C
<code>restrict</code> qualifier.</p>
<p>Note that there is an optional <em>target</em> argument to the
<code>associated()</code> intrinsic, which allows the programmer to
inquire whether a pointer is associated with a specific target,
e.g.,</p>
<pre><code>   associated(p, target = datum)   ! .true. if p =&gt; datum</code></pre>
<div class="section level3">
<h3 id="exercise-2-minutes">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes"></a>
</h3>
<div id="associating-a-pointer" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="associating-a-pointer" class="callout-inner">
<h3 class="callout-title">Associating a pointer</h3>
<div class="callout-content">
<p>Try to compile the accompanying <a href="../files/exercises/17-pointers/example1.f90">example1.f90</a>, which
is an erroneous version of the code above. See what compiler message you
get (if any). Fix the problem.</p>
<p>Check you can use the <code>associated()</code> function to print out
the status of <code>p</code> before and after the pointer
assignment.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The <code>p</code> pointer can’t be associated with
<code>datum</code> as the latter doesn’t have the <code>target</code>
attribute; the compilation should fail with an error. If you add the
attribute, it should compile and run:</p>
<pre class="source"><code>  integer, target  :: datum = 1</code></pre>
<p>Check the <code>associated()</code> status of <code>p</code> along
these lines:</p>
<pre class="source"><code>  print *, "p associated?", associated(p)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="pointers-as-aliases">Pointers as aliases<a class="anchor" aria-label="anchor" href="#pointers-as-aliases"></a>
</h3>
<p>One common use of pointers is to provide a temporary alias to another
variable (where no copying takes place). As a convenience, one can use
the <code>associate</code> construct, e.g.:</p>
<pre><code>  real :: improbably_or_tediously_long_variable_name
  ...
  associate(p =&gt; improbably_or_tediously_long_variable_name)
     ! ... lots of operations involving p ...
  end associate</code></pre>
<p>Note that there is no requirement here to have the
<code>target</code> attribute in the original declaration (and there’s
no explicit declaration of <code>p</code>). Any update to <code>p</code>
in the associate block will be reflected in the target on exit.</p>
<p>Multiple associations can be made in the same block; simply provide a
comma separated list in the parentheses. Also of note is that the
<em>selector</em> on the right hand side of the association can be
either a variable or an expression.</p>
</div>
<div class="section level3">
<h3 id="exercise-2-minutes-1">Exercise (2 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-minutes-1"></a>
</h3>
<div id="using-an-associate-construct" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="using-an-associate-construct" class="callout-inner">
<h3 class="callout-title">Using an <code>associate</code> construct</h3>
<div class="callout-content">
<p>Compile, and check the output of the accompanying code in <a href="../files/exercises/17-pointers/example2.f90">example2.f90</a>.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>You should see that the association is made to a strided section of
the array <code>r1</code>:</p>
<pre class="source"><code>associate(p =&gt; r1(2::2))</code></pre>
<p>Within the <code>associate</code> block <code>p</code> acts to point
to the second, fourth and sixth elements of <code>r1</code>.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="pointers-to-establish-storage">Pointers to establish storage<a class="anchor" aria-label="anchor" href="#pointers-to-establish-storage"></a>
</h2>
<hr class="half-width">
<p>One common use of pointers is for linked data structures. For
example, an entry in a linked list might be represented by the type</p>
<pre><code>  type :: my_node
    integer                 :: datum
    type (my_node), pointer :: next
  end type my_node</code></pre>
<p>This sort of dynamic data structure requires that we establish or
destroy storage as entries are added to the list, or removed from the
list.</p>
<pre><code>  subroutine my_list_add_node(head, datum)

    ! Insert new datum at head of list

    type (my_node), pointer, intent(inout) :: head
    integer,                 intent(in)    :: datum

    type (my_node), pointer :: pnode

    allocate(pnode)       ! assume no error
    pnode%datum = datum
    pnode%next =&gt; head
    head =&gt; pnode

  end subroutine my_list_add_node</code></pre>
<p>In the subroutine, we can see the pointer <code>pnode</code> is
allocated. This dynamically creates a <code>my_node</code> variable to
contain the new datum. At the end of the procedure, the
<code>pnode</code> pointer is itself used as a target for the
<code>head</code> pointer.</p>
<div class="section level3">
<h3 id="pointer-or-allocatable-array">Pointer or allocatable array?<a class="anchor" aria-label="anchor" href="#pointer-or-allocatable-array"></a>
</h3>
<p>The question may now arise: should you use pointers or allocatable
arrays? If you just want to establish storage for arrays, the answer is
almost certainly that you should use <code>allocatable</code>. An
allocatable array will almost certainly be held contiguously in memory,
whereas pointers are a more general data structure which may have to
accommodate a stride.</p>
<p>If an allocatable array is not appropriate, then a pointer may be
required.</p>
<p>If you just require a temporary alias, the <code>associate</code>
construct is recommended.</p>
</div>
</section><section><h2 class="section-heading" id="reallocating-array-storage">Reallocating array storage<a class="anchor" aria-label="anchor" href="#reallocating-array-storage"></a>
</h2>
<hr class="half-width">
<p>If one needs to increase (or decrease) the size of an existing
allocatable array, the <code>move_alloc()</code> intrinsic is useful.
E.g., if we have an integer rank one array</p>
<pre><code>  integer, dimension(:), allocatable :: iorig</code></pre>
<p>and establish storage of a given size, and some relevant
initialisations, we may then wish to increase the size of it.</p>
<pre><code>  integer :: nold
  integer, dimension(:), allocatable :: itmp

  nold = size(iorig)
  allocate(itmp(2*nold))           ! double size; assume no error
  itmp(1:nold) = iorig(1:nold)     ! copy existing contents explicitly
  call move_alloc(itmp, iorig)
  ! itmp deallocated, iorig now refers to the memory that had been itmp</code></pre>
<p>This minimises the number of copies involved in re-assigning the
original storage.</p>
<div id="move_alloc-efficiency" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="move_alloc-efficiency" class="callout-inner">
<h3 class="callout-title">
<code>move_alloc()</code> efficiency</h3>
<div class="callout-content">
<p>A thought exercise. How many copies would be required if
<code>move_alloc()</code> was not available when enlarging the size of
an existing allocatable array?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>If <code>move_alloc()</code> were not available, we would need to
make two copies rather than one. Analogously to the above example, we
would have to perform the following to double the storage in
<code>iorig</code>:</p>
<pre class="source"><code>  integer :: nold
  integer, dimension(:), allocatable :: itmp

  nold = size(iorig)
  allocate(itmp(nold))             ! allocate temporary storage for original data
  itmp(:) = iorig(:)               ! first copy from original storage into the temporary
  deallocate(iorig)                ! deallocate the original array
  allocate(iorig(2*ndold))         ! and then reallocate at twice the size
  iorig(1:nold) = itmp(:)          ! second copy from the temporary into the new storage
  deallocate(itmp)                 ! deallocate the temporary</code></pre>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="arrays-of-pointers">Arrays of pointers<a class="anchor" aria-label="anchor" href="#arrays-of-pointers"></a>
</h3>
<p>A small trick is required to arrange an array of pointers. Recall
that</p>
<pre><code>  real, dimension(:), pointer :: a</code></pre>
<p>is a pointer to a rank one array, and <em>not</em> a rank one array
of pointers. If one did want an array of such objects, it can be
achieved by wrapping it in a type:</p>
<pre><code>  type :: pointer_rr1
    real, dimension(:), pointer :: p =&gt; null()
  end type pointer_rr1

  type (pointer_rr1), dimension(10) :: a

  a(1)%p =&gt; null()</code></pre>
<p>So <code>a</code> is a rank one array of the new type, each element
having the component <code>p</code> which is a pointer to a real rank
one type.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Pointers are extremely useful for certain types of operations: they
provide a way to refer indirectly to other variables or names (they act
as an <code>_alias_</code>), or can be used for establishing dynamic
data structures.</li>
<li>Remember to always initialise a pointer, to <code>null()</code> if
necessary.</li>
<li>If a pointer is allocated, memory for its type is allocated and the
pointer becomes associated.</li>
<li>The <code>move_alloc()</code> intrinsic function moves a memory
allocation from one allocatable variable to another.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-18-further-functions"><p>Content from <a href="18-further-functions.html">Procedures again: interfaces</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/18-further-functions.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is an interface and why might I need to write one?</li>
<li>Can I use a function or a subroutine as an argument to another
procedure?</li>
<li>How can I write a procedure that will accept arguments of different
types?</li>
<li>Can I overload arithmetic and relational operators to work with my
derived types?</li>
<li>Can I write a function that will accept both scalar and array
arguments?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the need for interfaces and recognise when they are
necessary.</li>
<li>Be able to write an interface to allow the passing of a procedure as
an actual argument.</li>
<li>Understand and be able to implement overloading and
polymorphism.</li>
<li>Understand what an <code>elemental</code> function is and be able to
write one.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>So far, we have demanded that all procedures be defined as part of a
module. This has the important advantage that it makes the
<em>interface</em> to the function or subroutine <em>explicit</em> to
the compiler, and to other program units via the <code>use</code>
statement. The compiler can then check the order and type of the actual
arguments.</p>
<p>Other situations arise where we may need to give the compiler
additional information about the interface.</p>
<section><h2 class="section-heading" id="an-external-function">An external function<a class="anchor" aria-label="anchor" href="#an-external-function"></a>
</h2>
<hr class="half-width">
<p>Consider a program unit (which may or may not be a separate file)
which contains a function declaration outside a module scope. E.g.,</p>
<pre><code>  function my_mapping(i) result(imap)
    integer, intent(in) :: i
    integer             :: imap
    ...
  end function my_mapping</code></pre>
<p>If we compile a program which includes a reference to this function,
an error may result. We have not given the compiler any information
about how the function is meant to be called.</p>
<p>It is possible to provide the compiler with some limited information
about the return value of the function with the <code>external</code>
attribute (also available as a statement). E.g.,</p>
<pre><code>  program example

    implicit none
    integer, external :: my_mapping
    ...</code></pre>
<p>However, we have still not given the compiler full information about
the interface. The interface is said to remain <em>implicit</em>. To
make it explicit, the <code>interface</code> construct is available:</p>
<pre><code>  program example

    implicit none
    interface
      function my_mapping(i) result(imap)
        integer, intent(in) :: i
        integer             :: imap
      end function my_mapping
    end interface

    ...</code></pre>
<p>This has provided a full, explicit, statement about the interface of
the function <code>my_mappping()</code>. (Note that the dummy argument
names are not significant, but the function name and the argument types
and intents are.)</p>
<p>The compiler should now be able to check the arguments are used
correctly in the calling program (as if we had declared the function in
a module).</p>
<p>Interface blocks are necessary in other contexts.</p>
<div class="section level3">
<h3 id="exercise-5-minutes">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes"></a>
</h3>
<div id="externals-and-interfaces" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="externals-and-interfaces" class="callout-inner">
<h3 class="callout-title">Externals and interfaces</h3>
<div class="callout-content">
<p>To illustrate the points made above, a very simple external function
is defined in the file <a href="../files/exercises/18-further-functions/external.f90">external.f90</a>,
and an accompanying program <a href="../files/exercises/18-further-functions/example1.f90">example1.f90</a>
calls the function therein.</p>
<p>Try to compile the two files, e.g.:</p>
<pre><code>$ ftn external.f90 example1.f90</code></pre>
<p>What happens?</p>
<p>Try adding the appropriate <code>external</code> declaration</p>
<pre><code>  integer, external :: array_size</code></pre>
<p>What happens if you try to compile the program now? (Note at this
point that there are no modules involved, so no <code>.mod</code> files
will appear).</p>
<p>Then try running the program. Is the output what you expect?</p>
<p>Finally, remove the <code>external</code> declaration and try to
introduce the correct <code>interface</code> block. What happens
now?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Without either the <code>external</code> declaration of the function
or an interface, the compilation will simply fail. <code>gfortran</code>
produces the following:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>example1.f90:24:33:

   24 |   print *, "The array size is: ", array_size(a), size(a)
      |                                 1
Error: Function 'array_size' at (1) has no IMPLICIT type</code></pre>
</div>
<p>Adding the <code>external</code> declaration allows compilation to
succeed, but the following output is produced on running the
program:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> The array size is:            0           6</code></pre>
</div>
<p>The function call returns an incorrect value of 0 where the (3,2)
array has an actual size of 6.</p>
<p>Removing the external declaration and adding an interface matching
the function in <code>external.f90</code> as follows will help (and you
may have already spotted the issue):</p>
<pre class="source"><code>  interface
    function array_size(a) result(isize)
      real, dimension(:), intent(in) :: a
      integer                        :: isize
    end function array_size
  end interface</code></pre>
<p>Compiling now produces an error again, as reported here by
<code>gfortran</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>example1.f90:23:45:

   23 |   print *, "The array size is: ", array_size(a), size(a)
      |                                             1
Error: Rank mismatch in argument 'a' at (1) (rank-1 and rank-2)</code></pre>
</div>
<p>In the main program we were attempting call <code>array_size()</code>
on a rank two array, while in <code>external.f90</code> we implemented
it for rank one arrays. Now that we have an interface, the compiler can
see that the way we’re calling the function is incorrect, so it produces
the error and fails compilation.</p>
<p>This is preferable to the <code>external</code> declaration by which
we essentially asked the compiler to trust that it can call
<code>array_size()</code> however we tell it to do so, even though it
was in this case incorrect.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="passing-functions-or-subroutines-as-arguments">Passing functions or subroutines as arguments<a class="anchor" aria-label="anchor" href="#passing-functions-or-subroutines-as-arguments"></a>
</h2>
<hr class="half-width">
<p>Sometimes it is convenient to provide a procedure as an argument to
another function or subroutine. Good examples of this are for numerical
optimisation or numerical integration methods where a user-defined
function needs to be evaluated for a series of different arguments which
cannot be prescribed in advance.</p>
<p>This can be done if an interface block is provided which describes to
the calling procedure the function that is the dummy argument. E.g.,</p>
<pre><code>  subroutine my_integral(a, b, afunc, result)
    real, intent(in) :: a
    real, intent(in) :: b
    interface
      function afunc(x) result(y)
        real, intent(in) :: x
        real             :: y
      end function afunc
    end interface
    ...</code></pre>
<p>The function dummy argument has no intent. One cannot in general use
intrinsic procedures as actual arguments.</p>
</section><section><h2 class="section-heading" id="limited-polymorphism">Limited polymorphism<a class="anchor" aria-label="anchor" href="#limited-polymorphism"></a>
</h2>
<hr class="half-width">
<p>We have seen a number of intrinsic functions which take arguments of
different types, such as <code>mod()</code>. Such a situation where the
arguments can take a different form is sometimes referred to as limited
polymorphism (or overloading).</p>
<p>However, it is not possible in Fortran to define two procedures of
the same name, but different arguments (at least in the same scope). We
need different names; suppose we have two module sub-programs,
schematically:</p>
<pre><code>   subroutine my_specific_int(ia)
     integer, intent(inout) :: ia
     ... integer implementation ...
   end subroutine my_specific_int

   subroutine my_specfic_real(ra)
     real, intent(inout) :: ra
     ... real implementation ...
   end subroutine my_specific_real</code></pre>
<p>A mechanism exists to allow the compiler to identify the correct
routine based on the actual argument when used with a <em>generic
name</em>. This is:</p>
<pre><code>  interface my_generic_name
    module procedure my_specific_int
    module procedure my_specific_real
    ...
  end interface my_generic_name</code></pre>
<p>This should appear in the specification (upper) part of the relevant
module. The two specific implementations must be distinguishable by the
compiler, that is, at least one non-optional dummy argument must be
different.</p>
<div class="section level3">
<h3 id="exercise">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div id="an-interface-for-polymorphic-pbms" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="an-interface-for-polymorphic-pbms" class="callout-inner">
<h3 class="callout-title">An interface for polymorphic PBMs</h3>
<div class="callout-content">
<p>In the earlier <a href="13-IO.html">episode on I/O</a>, we wrote a
module to produce a <code>.pbm</code> image file. The accompanying
module <a href="../files/exercises/18-further-functions/pbm_image.f90">pbm_image.f90</a>
provides two implementations of such a routine: one for a logical array,
and another for an integer array.</p>
<p>Check you can add the appropriate <code>interface</code> block with
the generic name <code>write_pbm</code> to allow the program <a href="../files/exercises/18-further-functions/example3.f90">example3.f90</a>
to be compiled correctly.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>We need to add an interface to the module specification for
<code>write_pbm</code> which allows use of both the
<code>write_logical_pbm</code> and <code>write_integer_pbm</code>
subroutines. You should be able to follow the description above to do
so. The only minor complication is that the module uses
<code>private</code> by default; unless we specify <code>public</code>
for the new generic interface, it will remain hidden from the main
program.</p>
<p>Putting this together, the following should allow you to compile and
run the program with no errors:</p>
<pre class="source"><code>  public :: write_pbm
  interface write_pbm
    module procedure write_logical_pbm
    module procedure write_integer_pbm
  end interface</code></pre>
<p>With this, the internal workings of the module are hidden away and
its use is entirely via <code>write_pbm</code>.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="operator-overloading">Operator overloading<a class="anchor" aria-label="anchor" href="#operator-overloading"></a>
</h2>
<hr class="half-width">
<p>For simple derived types it may be meaningful to define relational
and arithmetic operators. For example, if we had a date type such as</p>
<pre><code>  type :: my_date
    integer :: day
    integer :: month
    integer :: year
  end type my_date</code></pre>
<p>it may be meaningful to ask whether two dates are equal and so on (it
would not really be meaningful to add one date to another).</p>
<p>One can write a function to do this:</p>
<pre><code>  function my_dates_equal(date1, date2) result(equal)
    type (my_date), intent(in) :: date1
    type (my_date), intent(in) :: date2
    logical                       equal
    ! ...
  end function my_dates_equal</code></pre>
<p>As a syntactic convenience, it might be useful to use <code>==</code>
in a logical expression using dates. This can be arranged via</p>
<pre><code>  interface operator(==)
    module procedure my_dates_equal
  end interface</code></pre>
<p>Again this should appear in the relevant specification part of the
relevant module. Such overloading is possible for relational operators
<code>==</code>, <code>/=</code>, <code>&gt;=</code>,
<code>&lt;=</code>, <code>&gt;</code> and <code>&lt;</code>. If
appropriate, overloading is also available for arithmetic operators
<code>+</code>, <code>-</code>, <code>*</code>, and <code>/</code>.</p>
<p>It is also possible to overload assignment <code>=</code>.</p>
</section><section><h2 class="section-heading" id="elemental-functions">Elemental functions<a class="anchor" aria-label="anchor" href="#elemental-functions"></a>
</h2>
<hr class="half-width">
<p>Again, we have seen that some intrinsic functions allow either scalar
or array actual arguments. The same effect can be achieved for a
user-defined function by declaring it to be <em>elemental</em>. The
procedure is declared in terms of a scalar dummy argument, but then may
be applied to an array actual argument element by element.</p>
<p>Such a procedure should be declared:</p>
<pre><code>  elemental function my_function(a) result(b)
    integer, intent(in) :: a
    integer             :: b
    ! ...
  end function my_function</code></pre>
<p>An invocation should be, e.g.:</p>
<pre><code><span>   <span class="fu">iresult</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">=</span> <span class="fu">my_function</span><span class="op">(</span><span class="fu">ival</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>All arguments (and function results) must conform. An elemental
routine usually must also be <code>pure</code>.</p>
<div class="section level3">
<h3 id="exercise-5-minutes-1">Exercise (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-5-minutes-1"></a>
</h3>
<div id="elemental-conversion-from-logical-to-pbm" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="elemental-conversion-from-logical-to-pbm" class="callout-inner">
<h3 class="callout-title">Elemental conversion from logical to PBM</h3>
<div class="callout-content">
<p>In the <a href="../files/exercises/18-further-functions/pbm_image.f90">pbm_image.f90</a>
module there is a utility function <code>logical_to_pbm()</code> which
is used in <code>write_logical_pbm()</code> to translate the logical
array to an integer array. Refactor this part of the code to use an
elemental function.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>The function <code>logical_to_pbm()</code> is currently
<code>pure</code> and takes in a scalar logical <code>lvar</code> to
return the scalar integer <code>ivar</code>. The function is currently
<code>pure</code>. Everything is already in place to convert the
function to <code>elemental</code>:</p>
<pre class="source"><code>  elemental function logical_to_pbm(lvar) result (ivar)

    ! Utility to return 0 or 1 for .false. and .true.

    logical, intent(in) :: lvar
    integer             :: ivar

    ivar = 0
    if (lvar) ivar = 1

  end function logical_to_pb</code></pre>
<p>All that remains is to have <code>write_logical_pbm()</code> call
this new <code>elemental</code> version. Further down in that function
you will see the old nested loop to move through the <code>map</code>
array and from it use <code>logical_to_pbm()</code> to fill the
<code>imap</code> array:</p>
<pre class="source"><code>    do j = 1, size(map, dim = 2)
       do i = 1, size(map, dim = 1)
          imap(i,j) = logical_to_pbm(map(i,j))
       end do
    end do</code></pre>
<p>With the new <code>elemental</code> version of
<code>logical_to_pbm()</code>, we can replace this entire structure with
the single line:</p>
<pre class="source"><code>imap(:,:) = logical_to_pbm(map(:,:))</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="exercise-20-minutes">Exercise (20 minutes)<a class="anchor" aria-label="anchor" href="#exercise-20-minutes"></a>
</h2>
<hr class="half-width">
<div id="exercise-name" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercise-name" class="callout-inner">
<h3 class="callout-title">Exercise name</h3>
<div class="callout-content">
<p>Write a module/program to perform a very simple numerical integration
of a simple one-dimensional function <em>f(x)</em>. We can use a
trapezoidal rule: for lower and upper limits <em>a</em> and <em>b</em>,
the integral can be approximated by</p>
<pre><code><span>  <span class="op">(</span><span class="va">b</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">+</span> <span class="fu">f</span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2.0</span></span></code></pre>
<p>We can go further and split the interval between <code>a</code> and
<code>b</code> into small sections of size <code>h = (b - a)/n</code>.
In a similar manner, approximating the integral of each small section
with a trapezium allows us to estimate the total integral to be</p>
<pre><code><span>  <span class="va">h</span><span class="op">*</span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">+</span> <span class="va">sum</span> <span class="op">+</span> <span class="fu">f</span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2.0</span></span></code></pre>
<p>with the sum</p>
<pre><code>  sum = 0.0
  do k = 1, n-1
    sum = sum + 2.0*f(a+k*h)
  end do</code></pre>
<p>Write a procedure that will take the limits <code>a</code> and
<code>b</code>, the integer number of steps <code>n</code>, and the
function, and returns a result.</p>
<p>To check, you can evaluate the function <code>cos(x) sin(x)</code>
between <code>a = 0</code> and <code>b = pi/2</code> (the answer should
be 1/2). Check your answer gets better for value of
<code>n = 10, 100, 1000</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>A sample solution is provided in <a href="../files/exercises/18-further-functions/solutions/integral_program.f90">integral_program.f90</a>
and <a href="../files/exercises/18-further-functions/solutions/integral_module.f90">integral_module.f90</a>.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>An interface provides important information about a procedure to the
compiler. Without this information, the compiler may not be able to use
it.</li>
<li>When using modules, interfaces are generated automatically and
provided to the compiler.</li>
<li>If not in a module, a function can be made visible to the compiler
by declaring it with the <code>external</code> attribute, but the
compiler can go further by checking the argument types if you write a
full, explicit <code>interface</code> block.</li>
<li>Interfaces can also be used to implement limited polymorphism and
operator overloading for derived types.</li>
<li>An elemental function is one which can be applied to a scalar actual
argument or element-by-element to an array actual argument.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-181-break"><p>Content from <a href="181-break.html">Break</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/181-break.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Comfort break.</p></section><section id="aio-19-intrinsic-functions"><p>Content from <a href="19-intrinsic-functions.html">Miscellaneous</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/19-intrinsic-functions.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I retrieve any command line arguments I want to give my
program?</li>
<li>How can I examine environment variables?</li>
<li>Can I have my Fortran code execute OS commands on the terminal?</li>
<li>Can I get the time and date?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn several useful procedures that allow your programs to interact
with the outside shell and environment.</li>
<li>Learn how to obtain the time and date and be able to time sections
of code.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>There a a number of features which have not been covered so far, but
are useful in certain contexts.</p>
<section><h2 class="section-heading" id="interacting-with-the-environment">Interacting with the environment<a class="anchor" aria-label="anchor" href="#interacting-with-the-environment"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="command-line-arguments">Command line arguments<a class="anchor" aria-label="anchor" href="#command-line-arguments"></a>
</h3>
<p>If you wish to write a program which makes use of command line
arguments, or simply wish to know the executable name at run time, the
command line can be retrieved.</p>
<p>The number of command line arguments is returned by the function</p>
<pre><code><span><span class="fu">command_argument_count</span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>This returns an <code>integer</code>: zero if the information is not
available, or the number of arguments <em>not including</em> the
executable name itself.</p>
<p>The entire command line can be retrieved as a string via</p>
<pre><code>  call get_command(command = cmd, length = len, status = stat)</code></pre>
<p>This returns the command line as a string (truncated or padded with
spaces as appropriate), the integer length of the command line string,
and an integer status which will be non-zero if the information is not
available. All the arguments are optional.</p>
<p>Individual command line arguments based on their position can be
retrieved using the subroutine</p>
<pre><code>  subroutine get_command_argument(position, value, length, status)
    integer,                       intent(in)  :: position
    character (len = *), optional, intent(out) :: value
    integer,             optional, intent(out) :: length
    integer,             optional, intent(out) :: status</code></pre>
<p>Here, <code>position</code> is zero for the (executable) command
itself and positive for others. The remaining arguments are:
<code>value</code> is the command; length is the length of the command,
and <code>istat</code> returns 0 on success, -ve if the <code>arg</code>
string is too short, or +ve if the information is not available.</p>
</div>
<div class="section level3">
<h3 id="environment-variables">Environment variables<a class="anchor" aria-label="anchor" href="#environment-variables"></a>
</h3>
<p>A similar routine exists for inquiry about environment variables:</p>
<pre><code>subroutine get_environment_variable(name, value, length, status, trim_name)
  character (len = *),           intent(in)  :: name
  character (len = *), optional, intent(out) :: value
  integer,             optional, intent(out) :: length
  integer,             optional, intent(out) :: status
  logical,             optional, intent(in)  :: trim_name</code></pre>
<p>This will return the value associated with the given name if it
exists. Various non-zero <code>status</code> error conditions can occur,
including a value of <code>1</code> if the variable does not exist, or
<code>-1</code> if the value is present, but is too long to fit in the
string provided.</p>
</div>
<div class="section level3">
<h3 id="system-commands">System commands<a class="anchor" aria-label="anchor" href="#system-commands"></a>
</h3>
<p>It is sometimes useful to pass control of execution back to the
operating system so that some other command can be used.</p>
<pre><code>subroutine execute_command_line(command, wait, iexit, icmd, cmdmsg)

  character (len = *),           intent(in)    :: command
  logical,             optional, intent(in)    :: wait
  integer,             optional, intent(inout) :: iexit
  integer,             optional, intent(out)   :: icmd
  character (len = *), optional, intent(inout) :: cmdmsg
</code></pre>
<p>The command should be a string. The <code>wait</code> argument tells
the routine to return only when the command has finishing executing. The
<code>iexit</code> argument gives the return value of the command. The
<code>icmd</code> argument returns a positive value if the command fails
to execute (e.g., the command was not found), or negative if execution
is not supported, or zero on successful execution. An informative
message should be returned in <code>cmdmsg</code> if <code>icmd</code>
is positive.</p>
<p>It is recommended to use <code>wait = .true.</code> always. Portable
programs should use system commands with extreme caution, or not at
all.</p>
</div>
<div class="section level3">
<h3 id="time-and-date-from-date_and_time">Time and date from <code>date_and_time()</code>
<a class="anchor" aria-label="anchor" href="#time-and-date-from-date_and_time"></a>
</h3>
<p>Use, e.g.,</p>
<pre><code>  character (len = 8)   :: date        ! "yyyymmdd"
  character (len = 10)  :: time        ! "hhmmss.sss"
  character (len = 5)   :: zone        ! "shhmm"
  integer, dimension(8) :: ivalues     ! see below

  call date_and_time(date = date, time = time, zone = zone, values = ivalues)</code></pre>
<p>All the arguments are optional. On return the <code>date</code> holds
the year, month, and day in a string of the form “yyyymmdd”;
<code>time</code> holds the time in hours, minutes, seconds, and
milliseconds; the time zone is encoded with a sign (<code>+</code> or
<code>-</code>) and the time difference from Coordinated Universal Time
(UTC) in hours and minutes.</p>
<p><code>ivalues</code> returns the same information as the other three
arguments in the form of an array of integers. These are, in order:
year, month (1-12), day (1-31), time difference in minutes between local
and UTC, hour (0-23), minute (0-59), seconds (0-59), and milliseconds
(0-999).</p>
</div>
</section><section><h2 class="section-heading" id="timing-pieces-of-code">Timing pieces of code<a class="anchor" aria-label="anchor" href="#timing-pieces-of-code"></a>
</h2>
<hr class="half-width">
<p>If you want to record the time taken to execute a particular section
of code, the <code>cpu_time()</code> function can be used. This returns
a <code>real</code> positive value which is some system-dependent time
in seconds. Subtracting two consecutive values will give an elapsed
time:</p>
<pre><code>   real :: t0, t1

   call cpu_time(t0)
   ! ... code to be timed here ...
   call cpu_time(t1)

   print *, "That piece of code took ", t1-t0, " seconds"</code></pre>
<p>In the unlikely event that there is no clock available, a negative
value may be returned from <code>cpu_time()</code>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Fortran provides other utility procedures that can help with your
program’s functionality.</li>
<li>These allow you to retrieve information from the calling command
line and environment.</li>
<li>You can pass commands back to the operating system, but you should
be very careful that your code remains portable.</li>
<li>Timing your code with <code>cpu_time()</code> can help you profile
your code.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-191-lunch"><p>Content from <a href="191-lunch.html">Lunch</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/191-lunch.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Break for lunch.</p></section><section id="aio-20-conclusions"><p>Content from <a href="20-conclusions.html">Other things you may see</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/20-conclusions.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>
</li></ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>
</li></ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="not-covered-in-this-course">Not covered in this course<a class="anchor" aria-label="anchor" href="#not-covered-in-this-course"></a>
</h2>
<hr class="half-width">
<p>The Fortran standard covers a large and increasing number of
features. Some of these we have only touched on, and others not
mentioned at all.</p>
<ul>
<li>Object-oriented features: type extension, abstract
classes/interfaces, …</li>
<li>Interoperability with C</li>
<li>Support for IEEE floating point arithmetic</li>
<li>Coarrays</li>
</ul></section><section><h2 class="section-heading" id="things-you-may-see">Things you may see<a class="anchor" aria-label="anchor" href="#things-you-may-see"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="old-stuff">Old stuff<a class="anchor" aria-label="anchor" href="#old-stuff"></a>
</h3>
<p>Don’t panic! Consult a reference to see what is happening.</p>
<p>May include:</p>
<ul>
<li>old-style declarations <code>real*4</code>, <code>real*8</code>,
<code>character*10</code> etc.</li>
<li>
<code>GO TO</code> statements</li>
<li>
<code>DATA</code> blocks</li>
</ul>
<p>Some features are formally <em>obsolescent</em>, in which case the
compiler should give a warning. There should be a more modern (“better”)
way doing the same thing. Obsolescent features will be <em>deleted</em>
at some point in the future.</p>
</div>
<div class="section level3">
<h3 id="preprocessor">Preprocessor<a class="anchor" aria-label="anchor" href="#preprocessor"></a>
</h3>
<p>The processing of Fortran is not standardised in the same way as the
C-preprocessor is part of the C standard.</p>
<p>However, it is very common to see preprocessor directives for
conditional compilation, and other preprocessor features. E.g.,</p>
<pre><code><span><span class="co">#ifdef HAVE_SOME_FEATURE</span></span>
<span>  <span class="va">...</span></span>
<span><span class="co">#endif</span></span></code></pre>
<p>As the Fortran preprocessor is not standardised, some care may be
required to ensure portability. For example, stringification of macro
arguments can be problematic.</p>
<p>An additional compiler flag may be required to switch on the
preprocessor explicitly. Alternatively, it is common that compilers will
automatically run the preprocessor if the file extension has a capital
letter e.g., <code>.F90</code>, <code>.F03</code>, and so on.</p>
</div>
</section><section><h2 class="section-heading" id="parallelism">Parallelism<a class="anchor" aria-label="anchor" href="#parallelism"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="where-forall">
<code>where</code>, <code>forall</code>
<a class="anchor" aria-label="anchor" href="#where-forall"></a>
</h3>
<p>Fortran has introduced a number of constructs which are intended to
allow the expression of parallelism.</p>
<p>While the standard allows these, and all compilers should inplement
them correctly, few compilers actually introduce any parallelism.</p>
<p>Loops are a perfectly good solution.</p>
</div>
<div class="section level3">
<h3 id="message-passing-interface">Message passing interface<a class="anchor" aria-label="anchor" href="#message-passing-interface"></a>
</h3>
<p>The message passing interface provides a standard interface for
distributed memory computing.</p>
<p>MPI makes use of a number of data types, macro definitions, and
library subroutines. A modern program might introduce the information
required via</p>
<pre><code>  use mpi_f08</code></pre>
<p>which uses derived types for data types (which are often opaque).</p>
<p>Earlier versions might use</p>
<pre><code>  use mpi</code></pre>
<p>where the opaque types are integer handles.</p>
<p>Older codes may even use</p>
<pre><code><span><span class="co">#include 'mpif.h'</span></span></code></pre>
<p>to make the necessary handles and macros available.</p>
</div>
<div class="section level3">
<h3 id="mpi-library-calls">MPI library calls<a class="anchor" aria-label="anchor" href="#mpi-library-calls"></a>
</h3>
<p>MPI is at base a C interface which accommodates Fortran. The C
routines often have prototypes of the form:</p>
<pre><code>  int MPI_Send(const void * buf, int ount, MPI_Datatype dt, int dest, int tag,
               MPI_Comm comm);</code></pre>
<p>The data to be sent is identified here using <code>void * buf</code>.
A return code provides an error status.</p>
<p>The lack of <code>void *</code> in Fortran means that the Fortran
API, formally, has been on a rather shaky foundation for a long time.
This is being addressed in the most recent standards.</p>
<p>In particular, the use of array sections as the <code>buf</code>
argument might prove problematic and should probably be avoided. It is
also preferable for the application to marshal data into a contiguous
buffer for performance reasons.</p>
<p>In modern versions, the error return code in Fortran are optional
integer arguments.</p>
</div>
<div class="section level3">
<h3 id="openmp">OpenMP<a class="anchor" aria-label="anchor" href="#openmp"></a>
</h3>
<p>OpenMP is a standard way to introduce thread-level parallelism
(typically at the level of loops). A program should</p>
<pre><code>  use omp_lib</code></pre>
<p>to provide OpenMP functions and kind type parameters.</p>
<p>OpenMP is largely based around compiler directives, which are
switched on via a compiler option, usually <code>-fopenmp</code>.</p>
<p>In Fortran, the directives are introduced by the
<em>sentinels</em>:</p>
<pre><code>  !$omp ...
  ...
  !$omp end ...</code></pre>
<p>which is ignored as a comment if no OpenMP is required
(cf. <code>#pragma omp ... { }</code> in C).</p>
<p>The OpenMP standard documents provide a useful <code>stub</code>
implementation which can be used in place of the real implementation
when compiling without OpenMP. This prevents a profileration of
conditional compilation directives.</p>
</div>
<div class="section level3">
<h3 id="gpu-programming">GPU programming<a class="anchor" aria-label="anchor" href="#gpu-programming"></a>
</h3>
<p>The GPU programming model of choice for Fortran has probably been
OpenACC to the present time.</p>
<p>NVIDIA support a Fortran extension CUDA Fortran, which is not
portable.</p>
<p>The OpenMP standard also has support for GPU offload, but the status
of compiler implementations is in flux.</p>
</div>
</section><section><h2 class="section-heading" id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a>
</h2>
<hr class="half-width">
<p>Testing is an important consideration in modern software engineering.
There are a number of unit test frameworks such as <a href="https://github.com/Goddard-Fortran-Ecosystem/pFUnit" class="external-link">pFUnit</a>.</p>
<p>Some others are mentioned at the <a href="https://fortranwiki.org/fortran/show/Unit+testing+frameworks" class="external-link">Fortran
wiki</a>.</p>
</section><section><h2 class="section-heading" id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<hr class="half-width">
<p>The standard reference is “Modern Fortran Explained” by Metcalf,
Reid, Cohen and Bader (Oxford University Press). The latest version is
“Modern Fortran Explained: Incorporating Fortran 2023” (2023).</p>
<p>The <a href="https://fortranwiki.org/fortran/show/HomePage" class="external-link">Fortran
wiki</a> also has a lot of useful material.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul><li>
</li></ul>
</div>
</div>
</div>
</section></section><section id="aio-21-conjugate-gradient"><p>Content from <a href="21-conjugate-gradient.html">Exercises: conjugate gradient and matrices</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/21-conjugate-gradient.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I really push what I’ve learnt so far?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Write a conjugate gradient solver.</li>
<li>Read a Matrix Market Exchange file and plot a downloaded
matrix.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<hr class="half-width">
<p>To finish things off, here are two fairly substantial exercises you
can tackle which should put everything you’ve learnt to the test.</p>
<div id="conjugate-gradient-solver" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="conjugate-gradient-solver" class="callout-inner">
<h3 class="callout-title">Conjugate gradient solver</h3>
<div class="callout-content">
<p>Contrasting with the very specific tri-diagonal solver we’ve been
working on, the conjugate gradient method provides a slightly more
general method for the solution of linear systems <em>Ax = b</em> – at
least for symmetric positive definite matrices. The algorithm is
explained in detail on <a href="https://en.wikipedia.org/wiki/Conjugate_gradient_method" class="external-link">Wikipedia</a>,
and if you are very interested you might like to read <a href="https://www.cs.cmu.edu/~quake-papers/painless-conjugate-gradient.pdf" class="external-link">An
Introduction to the Conjugate Gradient Method Without the Agonizing
Pain</a>.</p>
<p>However, it is not necessary to understand the details, as here we
are just interested in implementing the algorithm.</p>
<p>There are two main steps involved. The first is to perform a
matrix-vector multiplication. This can be done using the Fortran
intrinsic function <code>matmul()</code>. (Or you can have a go at
implementing your own version - it’s not too difficult.)</p>
<p>The second step is to compute a scalar residual from a vector
residual. If we have an array (vector) <code>r(1:n)</code> this can be
done with:</p>
<pre><code>  residual = sum(r(:)*r(:))</code></pre>
<p>All the operations in the algorithm can be composed of these, as well
as vector additions and multiplications by a scalar.</p>
<p>A template program <a href="../files/exercises/21-conjugate-gradient/cg_test.f90">cg_test.f90</a>
is provided with a small matrix to use as a test. You need to implement
a module <code>cgradient</code> which supplies a function
<code>cg_test()</code> taking the arguments set out in the template.</p>
<p>Remember that you can always check your answer by multiplying out
<em>Ax</em> to recover the original right-hand side <em>b</em>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>You can check a suggested solution with <a href="../files/exercises/21-conjugate-gradient/solutions-1/cg_test.f90">cg_test.f90</a>
and <a href="../files/exercises/21-conjugate-gradient/solutions-1/cgradient.f90">cgradient_solution.f90</a>.</p>
</div>
</div>
</div>
</div>
<div id="storage-of-large-sparse-matrices" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="storage-of-large-sparse-matrices" class="callout-inner">
<h3 class="callout-title">Storage of large sparse matrices</h3>
<div class="callout-content">
<p>The <a href="https://math.nist.gov/MatrixMarket/" class="external-link">Matrix Market</a>
provides a number of archived matrices of different types. It also
defines a simple ASCII format for the storage of sparse matrices.</p>
<p>The Matrix Market Exchange format <code>.mtx</code> files are
structured as follows.</p>
<pre><code>%% Exactly one header line starting %%
% Zero or more comment lines starting %
nrows ncols nnonzero
i1 j1 a(i1,j1)
i2 j2 a(i2,j2)
...</code></pre>
<p>where <code>nrows</code> and <code>ncols</code> are the number of
rows and columns in the matrix, respectively. <code>nnonzero</code> is
the number of non-zero entries in the matrix. For each non-zero entry
there then follows a single line which contains the row index, the
column index, and the value of the matrix element itself.</p>
<p>Download an example, e.g.,</p>
<pre><code>$ wget https://math.nist.gov/pub/MatrixMarket2/Harwell-Boeing/laplace/gr_30_30.mtx.gz
$ gunzip gr_30_30.mtx</code></pre>
<p>If you look at the first few line of this example, you should see</p>
<pre><code>%%MatrixMarket matrix coordinate real symmetric
900 900 4322
1 1  8.0000000000000e+00
2 1 -1.0000000000000e+00
31 1 -1.0000000000000e+00
32 1 -1.0000000000000e+00
2 2  8.0000000000000e+00</code></pre>
<ul>
<li><p>Define a type that can hold the sparse representation and provide
a procedure which initialises such a type from a file.</p></li>
<li><p>Provide a procedure which brings into existence a dense matrix
(just a two-dimensional array) initialised with the correct non-zero
elements.</p></li>
<li><p>Use the <code>.pbm</code> file generator to produce an image of
the non-zero elements to provide a check the file has been read
correctly.</p></li>
<li><p>Try some other matrices from the Matrix Market.</p></li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>A suggested solution in provided in <a href="../files/exercises/21-conjugate-gradient/solutions-2/mm_test.f90">mmtest.f90</a>
and <a href="../files/exercises/21-conjugate-gradient/solutions-2/mmarket.f90">mmarket.f90</a>.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Fortran performance and array handling make it ideal for the
solution of intense problems.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-211-break"><p>Content from <a href="211-break.html">Break</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/211-break.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Comfort break.</p></section><section id="aio-22-exercises"><p>Content from <a href="22-exercises.html">Exercises</a></p>
<hr>
<p>Last updated on 2026-02-06 |

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/episodes/22-exercises.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>
</li></ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>
</li></ul>
</div>
</div>
</div>
</div>
</div>
<p>We will use the rest of today to work on any exercises from the
lessons and the tri-diagonal and Game of Life exercises from Lesson
XX.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul><li>
</li></ul>
</div>
</div>
</div></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/" class="external-link">Source</a></p>
        <p>
        <a href="https://github.com/welucas2/2026-02-18-MO-Fortran-intro/blob/main/" class="external-link">Cite</a>
        | <a href="mailto:support@archer2.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
		</div>
		<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/" class="external-link">sandpaper (0.18.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/" class="external-link">varnish (1.0.9)</a></p>
		</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://welucas2.github.io/2026-02-18-MO-Fortran-intro/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://welucas2.github.io/2026-02-18-MO-Fortran-intro/instructor/aio.html",
  "identifier": "https://welucas2.github.io/2026-02-18-MO-Fortran-intro/instructor/aio.html",
  "dateCreated": "2025-05-05",
  "dateModified": "2026-02-06",
  "datePublished": "2026-02-06"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

